---
title: 数学建模-微分方程模型
date: 2021-05-14 20:01:01
mathjax: true
tag: [数学建模]
---



# 微分方程模型

## 基本概念

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430163821793.png)

建立微分方程：专业知识 + 套用现有模型

## 解析解

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430164233449.png)

```matlab
dsolve('y-Dy=2*x', 'x') % 需指定自变量，默认为 t, 否则 x 会被看为常数
syms y(x)
eqn = (y - diff(y,x) == 2*x);
dsolve(eqn)

% 可以含其他参数
syms y(x) a
eqn = (y - diff(y,x) == a*x);  
dsolve(eqn)

%% 例2
syms y(x)
eqn = (y - diff(y,x) == 2*x);  
cond = (y(0) == 3);
dsolve(eqn, cond)

%% 例3
dsolve('D2y+4*Dy+29*y=0','y(0)=0,Dy(0)=15','x') 
syms y(x)
eqn = (diff(y,x,2) + 4*diff(y,x) + 29*y  == 0);
Dy = diff(y,x);
cond = [(y(0) == 0), (Dy(0) == 15)];
dsolve(eqn, cond)

%% 例4
syms x(t) y(t) z(t)
eqn1 = (diff(x,t)  == 2*x-3*y+3*z+t); % 标准型
eqn2 = (diff(y,t)  == 4*x-5*y+3*z+t); 
eqn3 = (diff(z,t)  == 4*x-4*y+2*z+t); 
eqns = [eqn1 eqn2 eqn3];
[x,y,z] = dsolve(eqns)

% 帮助 y 显示 mupad simplify(y) latex(y)
```

## 数值解

不是所有的微分方程都可以求解析解。

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430165830666.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430170109426.png)

一般使用 ode45 求解非刚性问题，obe15s 求解刚性问题。非刚性问题：未知函数随自变量的变化而缓慢，刚性问题：未知函数在某些时间段发送剧烈的变化。

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430170428211.png)

```matlab
%% 例1
function dy = df1(x,y)
    % 微分方程：y-y'=2x（函数名称可以任意取）
    % 注意函数的返回值一定是因变量y的一阶导数
    % 函数的输入有两个，分别是自变量x和因变量y
	dy = y - 2*x;
end
%%  设定相对误差和绝对误差，这样可以提高微分方程数值解的精度
options = odeset('reltol',1e-4,'abstol',1e-8);
[x,y] = ode45('df1', [0 2], 3, options);

%% 例2
function dy = df2(x,y) 
	% 初始化用来储存因变量一阶导数的列向量
	dy = zeros(3,1);  
	dy(1) = y(2) * y(3);
	dy(2) = -y(1) * y(3);
    dy(3) = -0.51 * y(1) * y(2);
end
[x, y] = ode45('df2', [0 4*pi], [0 1 1]) % 因变量初始值
plot(x, y(:,1), 'o', x, y(:,2), '*', x, y(:,3), '+')
legend('y1','y2','y3')
axis([0 4*pi -inf +inf])
```

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430171353632.png)

```matlab
%% 例3
% 有解析解了可以不用求数值解，只是做对比
dsolve('(1+x*x)*D2y=2*x*Dy','y(-2)=3, Dy(-2)=4','x')
x = -2:0.01:2;
y = (4*x.*(x.^2 + 3))/15 + 101/15;
plot(x, y, 'b-')
hold on
function dy=df3(x,y) 
    dy=zeros(2,1);
    dy(1)=y(2);
    dy(2)=(2*x)/(1+x*x)*y(2);
end
[x,y] = ode45('df3',[-2 2], [3 4]); % 在自变量 2 2 上求解，在 2 上的初值条件
plot(x,y(:,1), 'r*') % 注意，y变量有两列，第一列是y1(我们要求的y)，第二列是y2(y的一阶导数) 
```

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430172254417.png)

```matlab
function dy=df4(x,y)
    dy = zeros(2,1);
    dy(1) = y(2);
    dy(2) = 1000*(1-y(1)^2)*y(2)-y(1);
end

[x,y] = ode15s('df4',[0 3000], [2 0]);  % 求出这个微分方程的数值解
plot(x,y(:,1),'*')
```

## 例题

### 1. 导弹追击

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430182230353.png)

```matlab
function dy=df5(t,y) % x 和 y 是要观察的因变量，t 是自变量
	v = 200; 
    dy=zeros(2,1);
    dy(1)=3*v*(20+sqrt(2)/2*v*t-y(1))/sqrt((20+sqrt(2)/2*v*t-y(1))^2+(sqrt(2)/2*v*t-y(2))^2);
    dy(2)=3*v*(sqrt(2)/2*v*t-y(2))/sqrt((20+sqrt(2)/2*v*t-y(1))^2+(sqrt(2)/2*v*t-y(2))^2);
end

options = odeset('reltol',1e-4,'abstol',1e-8); 
[t, y] = ode45('df5' ,[0 0.1], [0 0], options); % 导弹速度为 200 自变量时间区间跟这个相关
x = y(:,1);  
y = y(:,2);
plot(x, y, '*', 'MarkerSize', 1)
hold on
plot([20 30], [0 10]) % 船的轨迹
hold on

% 找到导弹与B船相撞的点
n = length(t);
for i = 1:n
	d = t(i) * v * 3;
	dd = sqrt((x(i)-(20+sqrt(2)/2*v*t(i)))^2+(y(i)-sqrt(2)/2*v*t(i))^2);
    if dd < 0.01 % 成功相撞
    	if d <= 50
    		disp(['导弹飞行' num2str(d) '单位后击中B船'])
    		disp(['导弹飞行的时间为' num2str(t(i)*60) '分钟'])
    		disp('击中点的坐标：');  
    		disp([x(i) y(i)])
    		plot(x(i), y(i), 'r*');
    		text(x(i)+0.5, y(i)+0.1, '击中点')
    	end
    	break
    end
end

if d >50 || dd >= 0.01
    disp('导弹没有击中B船')
end
```

### 2. 人口预测模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506135804719.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506140146056.png)

```matlab
%% Malthus模型（马尔萨斯模型）
x = dsolve('Dx=r*x', 'x(0)=x0', 't') 
% 把上面这个式子中的 x0 和 r 替换成确定的值
x0 = 100; 
r = 0.1;
subs(x)

% 初始人口为1000，画出50年且增长率分别为0.5%，1%，1.5% 一直到5%的人口变化曲线
x0 = 1000;
for i = 1:10
    r = 0.005 * i;
    xx = subs(x);
    fplot(xx,[0,50])   % fplot函数可以绘制表达式的图形
    hold on
end

%% 阻滞增长模型（logistic模型）
x = dsolve('Dx=r*(1-x/xm)*x','x(t0)=x0','t')   % 化简后和书上的结果一样
% mupad
t0 = 0;
x0 = 1000;
xm = 10000;
r = 0.05;
xx = subs(x);    %  10000/(exp(log(9) - t/20) + 1)
fplot(xx,[0,200])

%% 例题拟合解答
cftool
% 拟合方式选择：Custom Equation (自定义方程)
% 修改下方的方框为：x = f(t) = xm/(1+(xm/3.9-1)*exp(-r*(t-1790)))
[fitresult, gof] = createFit(year, population) 
t = 2001:2030;
xm = 342.4;
r =  0.02735;
predictions = xm./(1+(xm./3.9-1).*exp(-r.*(t-1790)));  % 计算预测值（注意这里要写成点乘和点除）
figure(2)
plot(year,population,'o',t,predictions,'.')  % 绘制预测结果图
disp(predictions)  % 预测的数值
```

### 3. 捕食者猎物模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506141512463.png)

```matlab
function dx=pre_war(t,x)
    dx=zeros(2,1); 
    dx(1)=x(1)*(0.7-0.1*x(2));
    dx(2)=x(2)*(-0.8+0.02*x(1));
end
function dx=post_war(t,x)
    dx=zeros(2,1); 
    dx(1)=x(1)*(0.9-0.1*x(2));
    dx(2)=x(2)*(-0.6+0.02*x(1));
end
[t1,x1]=ode45('pre_war',[0 15],[25 2]);
[t2,x2]=ode45('post_war',[0 15],[25 2]);

pre_prey=x1(:,1); pre_shark=x1(:,2); 
post_prey=x2(:,1); post_shark=x2(:,2);
figure(1)
plot(pre_prey,pre_shark,'--r',post_prey,post_shark,'-b')
legend('战前','战后')
title('鲨鱼和食饵数量变化的相轨线图')
xlabel('食饵数量')   
ylabel('鲨鱼数量')

figure(2)
plot(t1,pre_prey,'--r',t1,pre_shark,'-r',t2,post_prey,'--b',t2,post_shark,'-b')
legend('战前食饵数量','战前鲨鱼数量','战后食饵数量','战后鲨鱼数量')
xlabel('时间')
ylabel('数量')

pre_rate=pre_shark./(pre_prey+pre_shark);  % 战前的鲨鱼比例    
post_rate=post_shark./(post_prey+post_shark);   % 战后的鲨鱼比例
figure(3)
plot(t1,pre_rate,'--r',t2,post_rate,'-b')
legend('战前的鲨鱼比例','战后的鲨鱼比例')
```

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506142901253.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506142919719.png)

### 4. 种族竞争模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogblogimage-20210506144305893.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506144333355.png)

![](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506144505663.png)

```matlab
function dx=fun(t,x) 
    r1=0.5;  r2=0.5; % 甲乙的增长率
    N1=300;   N2=500;   % 甲乙的最大数量
    sigma1=0.5;  sigma2=2;   
    dx = zeros(2,1);
    dx(1) = r1*x(1)*(1-x(1)/N1-sigma1*x(2)/N2);
    dx(2) = r2*x(2)*(1-x(2)/N2-sigma2*x(1)/N1);
end
[t,x]=ode45('fun',[0 30],[80 100]); 
plot(t,x(:,1),'r-',t,x(:,2),'b-')  % x的第一列是甲种群数量，x的第二列是乙种群数量
legend('种群甲','种群乙')
```

## 传染病模型

### SI 模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506183004501.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506183218046.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184008150.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184126070.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184423765.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184742654.png)

```matlab
%% SI 模型
function dx=fun1(t,x)   % 大家可以修改里面的参数，来看结果的变化
    global TOTAL_N   % 定义总人数为全局变量
    beta = 0.1;  % 易感染者与已感染者接触且被传染的强度
    dx = zeros(2,1);  % x(1)表示S  x(2)表示I
    dx(1) = -beta*x(1)*x(2)/TOTAL_N;  
    dx(2) = beta*x(1)*x(2)/TOTAL_N;
end
function dx=fun2(t,x)
    global TOTAL_N
    beta = 0.1;
    if t > 60
        beta = beta/10; % 第60期后禁止大规模聚会，使得传染强度beta缩小为原来的10倍
    end
    dx = zeros(2,1);  
    dx(1) = - beta*x(1)*x(2)/TOTAL_N;  
    dx(2) = beta*x(1)*x(2)/TOTAL_N;
end
function dx=fun3(t,x)
    beta = 0.1; 
    u = 0.002;  % 人口出生率
    v = 0.001;  % 自然死亡率
    dx = zeros(3,1);  % x(3)表示自然死亡人数ND
    dx(1) = - beta*x(1)*x(2)/(x(1)+x(2)) +u*(x(1)+x(2)) - v*x(1);  
    dx(2) = beta*x(1)*x(2)/(x(1)+x(2)) - v*x(2);
    dx(3) = v*x(1) + v*x(2);
end
function dx=fun4(t,x)
    beta = 0.1;
    d = 0.01;
    dx = zeros(3,1); 
    dx(1) = - beta*x(1)*x(2)/(x(1)+x(2)) ;  
    dx(2) = beta*x(1)*x(2)/(x(1)+x(2)) -d*x(2);
    dx(3) = d*x(2);
end
function dx=fun5(t,x)
    beta = 0.1;
    d = 0.01;
    u = 0.002;
    v = 0.001;
    dx = zeros(4,1);  
    dx(1) = - beta*x(1)*x(2)/(x(1)+x(2))+u*(x(1)+x(2)) - v*x(1) ;  
    dx(2) = beta*x(1)*x(2)/(x(1)+x(2)) -d*x(2)- v*x(2);
    dx(3) = d*x(2);
    dx(4) = v*x(1) + v*x(2);
end

global TOTAL_N   % 定义总人数为全局变量（可以在子函数中使用）
TOTAL_N = 1000;  % 总人数
i0 = 1; % 初始时刻患者（已感染者）的人数
[t, x] = ode45('fun1',[1:200],[TOTAL_N-i0 i0]);
x = round(x); % 四舍五入整数
figure(1)
plot(t,x(:,1),'r-',t,x(:,2),'b-','Linewidth',1.5)
legend('易感染者S','患者I')

[t,x1]=ode45('fun1',[1:500],[TOTAL_N-i0 i0]);   % 原来调用fun1，返回x1
[t,x2]=ode45('fun2',[1:500],[TOTAL_N-i0 i0]);   % 禁止大规模聚会后调用fun2，返回x2
figure(4)
plot(t,x1(:,1),'r-',t,x1(:,2),'b-','Linewidth',1.5)  
hold on
plot(t,x2(:,1),'r--',t,x2(:,2),'b--','Linewidth',1.5) 
axis([0 500 0 1000])
legend('原来S','原来I','现在S','现在I')

TOTAL_N = 1000;
i0 = 1;
[t,x]=ode45('fun3',[1:200],[TOTAL_N-i0 i0 0]);  % 别忘了给ND初始值0
x = round(x);
figure(5)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'k-','Linewidth',1.5)   
legend('易感染者S','患者I','自然死亡人数ND')

TOTAL_N = 1000;
i0 = 1;
[t,x]=ode45('fun4',[1:500],[TOTAL_N-i0 i0 0]);
x = round(x);
figure(6)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'k-','Linewidth',1.5)   
legend('易感染者S','患者I','患病死亡人数ID')

TOTAL_N = 1000;
i0 = 1;
[t,x]=ode45('fun5',[1:500],[TOTAL_N-i0 i0 0 0]);
x = round(x);
figure(7)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'k-',t,x(:,4),'g-','Linewidth',1.5)
legend('易感染者S','患者I','患病死亡人数ID','自然死亡人数ND')
```

### SIS 模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190155264.png)

```matlab
function dx=fun1(t,x)
    global TOTAL_N
    beta = 0.1; 
    alpha = 0.06;
    dx = zeros(2,1);
    dx(1) = alpha*x(2) - beta*x(1)*x(2)/TOTAL_N;  
    dx(2) = beta*x(1)*x(2)/TOTAL_N - alpha*x(2);
end

global TOTAL_N 
TOTAL_N = 1000;
i0 = 1;
[t,x]=ode45('fun1',[1:500],[TOTAL_N-i0 i0]); 
x = round(x);
figure(1)
plot(t,x(:,1),'r-',t,x(:,2),'b-','Linewidth',1.5)
legend('易感染者S','患者I')
```

### SIR 模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190559107.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190656006.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190715078.png)

```matlab
function dx=fun1(t,x)
    beta = 0.1;
    gamma = 0.02;
    dx = zeros(3,1);
    C = x(1)+x(2);
    dx(1) = - beta*x(1)*x(2)/C;  
    dx(2) = beta*x(1)*x(2)/C - gamma*x(2);
    dx(3) = gamma*x(2); 
end
function dx=newfun2(t,x,GAMMA)   % 把GAMMA当成参数传入进来
    beta = 0.1;
    dx = zeros(3,1);
    C = x(1)+x(2);
    dx(1) = - beta*x(1)*x(2)/C;  
    dx(2) = beta*x(1)*x(2)/C - GAMMA*x(2);
    dx(3) = GAMMA*x(2);
end
function dx=fun4(t,x)
    beta = 0.1;
    gamma = 0.02;
    d = 0.005;
    dx = zeros(4,1);
    C = x(1)+x(2);
    dx(1) = - beta*x(1)*x(2)/C;  
    dx(2) = beta*x(1)*x(2)/C - gamma*x(2) -d*x(2);
    dx(3) = gamma*x(2);
    dx(4) = d*x(2);
end


N = 1000; 
i0 = 1;
[t,x]=ode45('fun1',[1:500],[N-i0 i0 0]);
x = round(x); 
figure(1)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'g-','Linewidth',1.5)  
legend('易感染者S','患者I','康复者R')

clc;clear
N = 1000;
i0 = 1;
c = jet(5);  
for i = 1:5
    GAMMA = 0.01*i;   % 在循环中来改变康复率GAMMA的值
    [t,x]=ode45(@(t,x) newfun2(t,x,GAMMA),[1:500],[N-i0 i0 0]);  
    x = round(x);
    figure(2)
    plot(t, x(:,2), '-', 'color', c(i,:),'DisplayName',num2str(GAMMA),'Linewidth',1.5) 
    hold on
end
legend show

%% 考虑疾病的死亡率的SIR模型
clc;clear
N = 1000;
i0 = 1;
[t,x]=ode45('fun4',[1:400],[N-i0 i0 0 0]);
x = round(x);
figure(4)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'g-',t,x(:,4),'k-','Linewidth',1.5)   
legend('易感染者S','患者I','康复者R','患病死亡人数ID')
```

### SIRS 模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191229891.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191341235.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191459687.png)

```matlab
function dx=fun1(t,x)
    global TOTAL_N 
    beta = 0.1; 
    gamma = 0.03;
    alpha = 0.01; 
    dx = zeros(3,1);
    dx(1) = - beta*x(1)*x(2)/TOTAL_N + alpha*x(3) ;  
    dx(2) = beta*x(1)*x(2)/TOTAL_N - gamma*x(2);
    dx(3) = gamma*x(2) - alpha*x(3) ;  
end
function dx=fun2(t,x) 
    beta = 0.1; 
    gamma = 0.03;
    alpha = 0.01; 
    d = 0.005; 
    C = x(1)+x(2)+x(3); 
    dx = zeros(4,1);
    dx(1) = - beta*x(1)*x(2)/C + alpha*x(3) ;  
    dx(2) = beta*x(1)*x(2)/C - gamma*x(2)-d*x(2);
    dx(3) = gamma*x(2) - alpha*x(3) ;  
    dx(4) = d*x(2);
end
function dx=fun3(t,x)
    beta = 0.1;
    gamma1 = 0.01;
    gamma2 = 0.01;
    alpha = 0.01;
    d = 0.005;
    C = x(1)+x(2)+x(4);  % 传染病系统中的有效人群,也就是课件中的N' = S+I+R2
    dx = zeros(5,1);  % x(1)表示S  x(2)表示I x(3)表示R1 x(4)表示R2 x(5)表示ID
    dx(1) = - beta*x(1)*x(2)/C + alpha*x(4) ;  
    dx(2) = beta*x(1)*x(2)/C - gamma1*x(2)-gamma2*x(2)-d*x(2);
    dx(3) = gamma1*x(2) ;  
    dx(4) = gamma2*x(2) - alpha*x(4) ;  
    dx(5) = d*x(2);
end

%% SIRS模型
clc;clear
global TOTAL_N 
TOTAL_N = 1000; 
i0 = 1;
[t,x]=ode45('fun1',[1:500],[TOTAL_N-i0 i0 0]); 
x = round(x);
figure(1)
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'g-','Linewidth',1.5)     
legend('易感染者S','患者I','康复者R')

%%  引入疾病的死亡率d后的SIRS模型
clc;clear
N = 1000;
i0 = 1;
figure(2)
[t,x1]=ode45('fun2',[1:500],[N-i0 i0 0 0]);
x1 = round(x1); 
subplot(2,2,1)
plot(t,x1(:,1),'r-',t,x1(:,2),'b-',t,x1(:,3),'g-',t,x1(:,4),'k-','Linewidth',1.5)   
title('500期')
[t,x2]=ode45('fun2',[1:2000],[N-i0 i0 0 0]);  
x2 = round(x2);  
subplot(2,2,2)
plot(t,x2(:,1),'r-',t,x2(:,2),'b-',t,x2(:,3),'g-',t,x2(:,4),'k-','Linewidth',1.5)    
title('2000期')
[t,x3]=ode45('fun2',[1:8000],[N-i0 i0 0 0]);  
x3 = round(x3);  
subplot(2,2,[3,4])
plot(t,x3(:,1),'r-',t,x3(:,2),'b-',t,x3(:,3),'g-',t,x3(:,4),'k-','Linewidth',1.5)    
title('8000期')
legend('易感染者S','患者I','康复者R','患病死亡人数ID')

%%  引入完全康复者和暂时康复者的模型
clc;clear
N = 1000;
i0 = 1;
figure(3)
[t,x]=ode45('fun3',[1:1000],[N-i0 i0 0 0 0]);
x = round(x); 
plot(t,x(:,1),'r-',t,x(:,2),'b-',t,x(:,3),'g-',t,x(:,4),'m-',t,x(:,5),'k-','Linewidth',1.5)     
legend('易感染者S','患者I','完全康复者R1','暂时康复者R2','患病死亡人数ID')
```

### SEIR 模型

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191921766.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506192001574.png)

```matlab
function dx=fun1(t,x)
    beta = 0.1;
    sigma = 0.2;
    gamma = 0.02;
    dx = zeros(4,1);
    C = x(1)+x(2)+x(3);
    dx(1) = - beta*x(1)*x(3)/C;  
    dx(2) = beta*x(1)*x(3)/C - sigma*x(2);
    dx(3) = sigma*x(2) - gamma*x(3);
    dx(4) = gamma*x(3); 
end
function dx=fun2(t,x)
    beta1 = 0.1;
    beta2 = 0.05;
    sigma = 0.2;
    gamma = 0.02;
    dx = zeros(4,1);
    C = x(1)+x(2)+x(3);
    dx(1) = - beta1*x(1)*x(3)/C  -  beta2*x(1)*x(2)/C;  
    dx(2) = beta1*x(1)*x(3)/C + beta2*x(1)*x(2)/C - sigma*x(2);
    dx(3) = sigma*x(2) - gamma*x(3);
    dx(4) = gamma*x(3); 
end

% 把两个图放到一起看看区别
figure(3)
[t,x1]=ode45('fun1',[1:500],[N-i0 0 i0 0]);  
plot(t,x1(:,1),'r-',t,x1(:,2),'m-',t,x1(:,3),'b-',t,x1(:,4),'g-','Linewidth',1.5)    
hold on
[t,x2]=ode45('fun2',[1:500],[N-i0 0 i0 0]);  
plot(t,x2(:,1),'r--',t,x2(:,2),'m--',t,x2(:,3),'b--',t,x2(:,4),'g--','Linewidth',1.5)    
legend('易感染者S','潜伏者E','患者I','康复者R')
```

