---
title: æ•°å­¦å»ºæ¨¡-å›å½’åˆ†æ
date: 2021-05-14 20:01:12
mathjax: true
tag: [æ•°å­¦å»ºæ¨¡]
---



# å›å½’åˆ†æ

å›å½’åˆ†æçš„ä½¿å‘½ï¼š

1. åˆ¤æ–­å“ªäº› X å˜é‡æ˜¯åŒ Y çœŸçš„ç›¸å…³
2. åˆ¤æ–­ç›¸å…³æ€§æ˜¯æ­£çš„è¿˜æ˜¯è´Ÿçš„
3. ä¼°è®¡å›å½’ç³»æ•°æƒé‡ï¼ˆè¿˜è¦æ ‡å‡†åŒ–å»é‡çº²ä¹‹åï¼‰

å›å½’åˆ†æçš„åˆ†ç±»ï¼š

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162048564.png)

å›å½’çš„æ–¹æ³•å’Œè¯„ä»·è·Ÿ **æ‹Ÿåˆ** ç±»ä¼¼ã€‚

ä½¿ç”¨è½¯ä»¶ï¼šStataã€‚

# åˆç†é¢„æµ‹æ¨¡å‹

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429164529866.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429164546728.png)

# å¤šå…ƒçº¿æ€§å›å½’

è·Ÿæ‹Ÿåˆç±»ä¼¼ï¼Œå¯¹æ¨ªæˆªé¢æ•°æ®è¿›è¡Œå›å½’ã€‚

ä¸€å…ƒçº¿æ€§å›å½’ï¼Œä¸€èˆ¬ç§° $y_i=\beta_0+\beta_1x_i+\mu_i$ æ·»åŠ æ®‹å·®ã€‚

è‡ªå˜é‡å’Œå› å˜é‡å¯é€šè¿‡å˜é‡è½¬åŒ–å˜æˆçº¿æ€§æ¨¡å‹ï¼Œ$lny_i=\beta_0+\beta_1\ln{x_i}+\mu_i$, $y_i=\beta_0+\beta_1x_i+\beta_2x_i^2+\mu_i$

ä½¿ç”¨çº¿æ€§å›å½’ä¹‹å‰ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚

## å›å½’ç³»æ•°

$y_i=\beta_0+\beta_1x_i+\mu_i$ï¼Œ ç§° $\beta_0, \beta_1$ ä¸ºå›å½’ç³»æ•°ã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162439941.png)

## è™šæ‹Ÿå˜é‡

è‡ªå˜é‡ä¸­æœ‰å®šæ€§å˜é‡ï¼Œä¾‹å¦‚æ€§åˆ«ã€åœ°åŸŸï¼Œåœ¨å›å½’ä¸­ $y_i = \beta_0 + \beta_1x_{1i} + ... +\delta_0d_0+...+\mu_i$

å˜é‡ $d_i$  å– 0 æˆ– 1

é¿å…å®Œå…¨ **å¤šé‡å…±çº¿æ€§** çš„å½±å“ï¼Œå¼•å…¥è™šæ‹Ÿå˜é‡çš„ä¸ªæ•°ä¸€èˆ¬æ˜¯åˆ†ç±»æ•°å‡1ã€‚

## å‡å®šæ»¡è¶³

å›å½’æ¨¡å‹æ»¡è¶³ 4 ä¸ªå‡å®šï¼š

å‡å®š1ï¼šçº¿æ€§å‡å®šï¼Œå› å˜é‡ä¸è‡ªå˜é‡å­˜åœ¨çº¿æ€§å…³ç³»

å‡å®š2ï¼šä¸¥æ ¼å¤–ç”Ÿæ€§ï¼Œæ‰€æœ‰çš„è‡ªå˜é‡è·Ÿæ‰°åŠ¨é¡¹ä¸ç›¸å…³ï¼Œä¿è¯ä¼°è®¡å‡ºæ¥çš„å›å½’ç³»æ•°æ— åä¸”ä¸€è‡´ã€‚

å‡å®š3ï¼šå®Œå…¨å¤šé‡æ— å…³æ€§ï¼Œä¿è¯èƒ½ä¼°è®¡å‡ºæ¥ï¼Œè‡ªå˜é‡æ»¡è¶³åˆ—æ»¡ç§©ï¼Œ$X'X$ å¯é€†ã€‚

å‡å®š4ï¼šçƒå‹å¹²æ‰°é¡¹ï¼ŒåŒæ–¹å·®ï¼Œæ— è‡ªç›¸å…³ï¼Œ$E(\xi_i\xi_j|x) = 0$ï¼Œ $\xi$  ä¸ºæ‰°åŠ¨é¡¹ã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423164647820.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165346306.png)

### å†…ç”Ÿæ€§

å°±æ˜¯ç”±å°šæœªæ·»åŠ çš„å˜é‡ï¼Œè¯¥å˜é‡æ—¢è·Ÿ y æœ‰å…³ï¼Œä¹Ÿè·Ÿå·²æ·»åŠ çš„è‡ªå˜é‡æœ‰å…³ã€‚

![image-20210422162618842](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162618842.png)

å³ $u_i$ å…¶å®åŒ…å«å…¶ä»–ç›¸å…³å˜é‡å½±å“ï¼Œå¯¼è‡´ä¼°è®¡ä¸å‡†ç¡®ã€‚

å†ä»¥ä¸€ä¸ªä¾‹å­ä¸ºä¾‹ï¼š

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162842676.png)

```matlab
%% è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿï¼šå†…ç”Ÿæ€§ä¼šé€ æˆå›å½’ç³»æ•°çš„å·¨å¤§è¯¯å·®
times = 300; % è’™ç‰¹å¡æ´›çš„æ¬¡æ•°
R = zeros(times, 1);  % ç”¨æ¥å‚¨å­˜æ‰°åŠ¨é¡¹ uå’Œx1 çš„ç›¸å…³ç³»æ•°
K = zeros(times, 1);  % ç”¨æ¥å‚¨å­˜é—æ¼äº†x2ä¹‹åï¼Œåªç”¨yå¯¹x1å›å½’å¾—åˆ°çš„å›å½’ç³»æ•° k
for i = 1: times
    n = 30;  % æ ·æœ¬æ•°æ®é‡ä¸ºn
    x1 = -10 + rand(n, 1) * 20;   % x1åœ¨-10å’Œ10ä¸Šå‡åŒ€åˆ†å¸ƒï¼Œå¤§å°ä¸º30*1
    u1 = normrnd(0, 5, n, 1) - rand(n, 1);  % éšæœºç”Ÿæˆä¸€ç»„ç¬¦åˆæ­£æ€åˆ†å¸ƒçš„éšæœºæ•°
    x2 = 0.3 * x1 + u1;   % x2ä¸x1çš„ç›¸å…³æ€§ä¸ç¡®å®šï¼Œéšæœºç”Ÿæˆx2
    u = normrnd(0, 1, n, 1);  % æ‰°åŠ¨é¡¹uæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ
    y = 0.5 + 2 * x1 + 5 * x2 + u;  % æ„é€ y
    % æœ€å°äºŒä¹˜æ³•ä¼°è®¡å‡ºæ¥çš„k y=kx+b
    k = (n * sum(x1 .* y)-sum(x1) * sum(y))/(n * sum(x1 .* x1)-sum(x1)* sum(x1)); 
    K(i) = k;
    u = 5 * x2 + u;  %% å› ä¸ºæˆ‘ä»¬å›å½’ä¸­å¿½ç•¥äº† 5*x2ï¼Œæ‰€ä»¥æ‰°åŠ¨é¡¹è¦åŠ ä¸Š5*x2 ï¼ˆå®é™…æ‰°åŠ¨å­˜åœ¨å†…ç”Ÿæ€§ï¼‰
    r = corrcoef(x1, u);  % 2*2çš„ç›¸å…³ç³»æ•°çŸ©é˜µ 0è¯´æ˜ä¸ç›¸å…³
    R(i) = r(2, 1);
end
plot(R, K, '*')
xlabel("x_1å’Œu'çš„ç›¸å…³ç³»æ•°")
ylabel("kçš„ä¼°è®¡å€¼")
```

æ— å†…ç”Ÿæ€§è¦æ±‚æ‰€æœ‰ **è§£é‡Šå˜é‡ï¼ˆXï¼‰** è·Ÿ **æ‰°åŠ¨é¡¹** ä¸ç›¸å…³ï¼Œç¡®ä¿å…¶å…¨éƒ¨å¤–ç”Ÿæ¯”è¾ƒå›°éš¾ï¼Œä½†å¯ä»¥å¼±åŒ–æ­¤æ¡ä»¶ã€‚

å°†è§£é‡Šå˜é‡åˆ†ä¸ºæ ¸å¿ƒè§£é‡Šå˜é‡å’Œæ§åˆ¶å˜é‡ä¸¤ç±»ï¼š

- **æ ¸å¿ƒè§£é‡Šå˜é‡**ï¼šæˆ‘ä»¬æœ€æ„Ÿå…´è¶£çš„å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬ç‰¹åˆ«å¸Œæœ›å¾—åˆ°å¯¹å…¶ç³»æ•°çš„ä¸€è‡´ä¼°è®¡ï¼ˆå½“æ ·æœ¬å®¹é‡æ— é™å¢å¤§æ—¶ï¼Œæ”¶æ•›äºå¾…ä¼°è®¡å‚æ•°çš„çœŸå€¼ï¼‰
- **æ§åˆ¶å˜é‡**ï¼šæˆ‘ä»¬å¯èƒ½å¯¹äºè¿™äº›å˜é‡æœ¬èº«å¹¶æ— å¤ªå¤§å…´è¶£ï¼›è€Œä¹‹æ‰€ä»¥æŠŠå®ƒä»¬ä¹Ÿæ”¾å…¥å›å½’æ–¹ç¨‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†â€œæ§åˆ¶ä½â€é‚£äº›å¯¹è¢«è§£é‡Šå˜é‡æœ‰å½±å“çš„é—æ¼å› ç´ ã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ ¸å¿ƒè§£é‡Šå˜é‡ä¸ğä¸ç›¸å…³å³å¯ ï¼ˆè¦æ±‚ç¡®ä¿ç›¸å…³ç³»æ•°ä¸º0ï¼‰ã€‚

### å¤šé‡å…±çº¿æ€§

æŸä¸€è§£é‡Šå˜é‡å¯ä»¥ç”±å…¶ä»–è§£é‡Šå˜é‡è§£é‡Šã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423141516797.png)

#### å‡è®¾æ£€éªŒ

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423141902121.png)

#### è§£å†³æ–¹æ³•

å¦‚æœå‘ç°å­˜åœ¨å¤šé‡å…±çº¿æ€§ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹å¤„ç†æ–¹æ³•ï¼š

1. å¦‚æœä¸å…³å¿ƒå…·ä½“çš„ **å›å½’ç³»æ•°**ï¼Œè€Œåªå…³å¿ƒ **æ•´ä¸ªæ–¹ç¨‹** é¢„æµ‹è¢«è§£é‡Šå˜é‡çš„èƒ½åŠ›ï¼Œåˆ™é€šå¸¸å¯ä»¥ä¸å¿…ç†ä¼šå¤šé‡å…±çº¿æ€§ï¼ˆå¤šé‡å…±çº¿æ€§çš„ä¸»è¦åæœæ˜¯ä½¿å¾—å¯¹å•ä¸ªå˜é‡çš„è´¡çŒ®ä¼°è®¡ä¸å‡†ï¼Œä½†æ‰€æœ‰å˜é‡çš„æ•´ä½“æ•ˆåº”ä»å¯ä»¥è¾ƒå‡†ç¡®åœ°ä¼°è®¡ï¼‰ã€‚
2. å…³å¿ƒå…·ä½“çš„å›å½’ç³»æ•°æ—¶ï¼Œå¦‚æœå¤šé‡å…±çº¿æ€§å¹¶ä¸å½±å“æ‰€å…³å¿ƒå˜é‡çš„ **æ˜¾è‘—æ€§**ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¸å¿…ç†ä¼šï¼›å¦åˆ™ï¼Œéœ€è¦å¢å¤§æ ·æœ¬å®¹é‡ï¼Œå‰”é™¤å¯¼è‡´ä¸¥é‡å…±çº¿æ€§çš„å˜é‡ï¼ˆå¯èƒ½ä¼šæœ‰å†…ç”Ÿæ€§çš„å½±å“ï¼‰ï¼Œæˆ–ä¿®æ”¹æ¨¡å‹ã€‚

### æ‰°åŠ¨é¡¹

åœ¨ä¹‹å‰çš„å›å½’åˆ†æä¸­ï¼Œæˆ‘ä»¬éƒ½é»˜è®¤äº†æ‰°åŠ¨é¡¹ $\mu_i$ æ˜¯çƒå‹æ‰°åŠ¨é¡¹ã€‚

çƒå‹æ‰°åŠ¨é¡¹ï¼šæ»¡è¶³ **åŒæ–¹å·®** å’Œ **æ— è‡ªç›¸å…³** ä¸¤ä¸ªæ¡ä»¶ã€‚

æ¨ªæˆªé¢æ•°æ®å®¹æ˜“å‡ºç° *å¼‚æ–¹å·®* çš„é—®é¢˜ï¼Œæ—¶é—´åºåˆ—æ•°æ®å®¹æ˜“å‡ºç° *è‡ªç›¸å…³* çš„é—®é¢˜ã€‚

#### å¼‚æ–¹å·®

æ•°æ®åˆ†å¸ƒæåº¦ä¸å¹³è¡¡ï¼Œå¦‚å›¾ç¤ºã€‚$OLS$ æ™®é€šæœ€å°äºŒä¹˜æ³•ã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423140237418.png)

##### å‡è®¾æ£€éªŒ

BP æ£€éªŒæˆ–è€…æ€€ç‰¹æ£€éªŒï¼ŒåŸå‡è®¾ï¼Œæ‰°åŠ¨é¡¹ä¸å­˜åœ¨å¼‚æ–¹å·®ï¼Œ P å€¼å°äº0.05ï¼Œå¦‚æœåœ¨95%çš„ç½®ä¿¡æ°´å¹³ä¸‹æ‹’ç»åŸå‡è®¾ï¼Œå³æˆ‘ä»¬è®¤ä¸ºæ‰°åŠ¨é¡¹å­˜åœ¨å¼‚æ–¹å·®ã€‚

ä½¿ç”¨ Stata:

```stata
// å›å½’ç»“æŸåä½¿ç”¨
estat hettest, rhs iid
estat imtest, white
```

##### è§£å†³æ–¹æ³•

1. ä½¿ç”¨OLS + ç¨³å¥çš„æ ‡å‡†è¯¯ï¼Œå¦‚æœå‘ç°å­˜åœ¨å¼‚æ–¹å·®ï¼Œä¸€ç§å¤„ç†æ–¹æ³•æ˜¯ï¼Œä»ç„¶è¿›è¡ŒOLS å›å½’ï¼Œä½†ä½¿ç”¨ç¨³å¥æ ‡å‡†è¯¯ã€‚è¿™æ˜¯æœ€ç®€å•ï¼Œä¹Ÿæ˜¯ç›®å‰é€šç”¨çš„æ–¹æ³•ã€‚åªè¦æ ·æœ¬å®¹é‡è¾ƒå¤§ï¼Œå³ä½¿åœ¨å¼‚æ–¹å·®çš„æƒ…å†µä¸‹ï¼Œè‹¥ä½¿ç”¨ç¨³å¥æ ‡å‡†è¯¯ï¼Œåˆ™æ‰€æœ‰å‚æ•°ä¼°è®¡ã€å‡è®¾æ£€éªŒå‡å¯ç…§å¸¸è¿›è¡Œã€‚
2. å¹¿ä¹‰æœ€å°äºŒä¹˜æ³•GLSï¼Œç¼ºç‚¹ï¼šåªèƒ½ç”¨æ ·æœ¬æ•°æ®æ¥ä¼°è®¡ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœä¸ç¨³å¥ï¼Œå­˜åœ¨å¶ç„¶æ€§ã€‚

```stata
regress y x1 x2 ... xk, robust
```

## é€æ­¥å›å½’

**å‘å‰é€æ­¥å›å½’**ï¼šå°†è‡ªå˜é‡é€ä¸ªå¼•å…¥æ¨¡å‹ï¼Œæ¯å¼•å…¥ä¸€ä¸ªè‡ªå˜é‡åéƒ½è¦è¿›è¡Œæ£€éªŒï¼Œæ˜¾è‘—æ—¶æ‰åŠ å…¥å›å½’æ¨¡å‹ã€‚ï¼ˆç¼ºç‚¹ï¼šéšç€ä»¥åå…¶ä»–è‡ªå˜é‡çš„å¼•å…¥ï¼ŒåŸæ¥æ˜¾è‘—çš„è‡ªå˜é‡ä¹Ÿå¯èƒ½åˆå˜ä¸ºä¸æ˜¾è‘—äº†ï¼Œä½†æ˜¯ï¼Œå¹¶æ²¡æœ‰å°†å…¶åŠæ—¶ä»å›å½’æ–¹ç¨‹ä¸­å‰”é™¤æ‰ã€‚ï¼‰

**å‘åé€æ­¥å›å½’**ï¼šå…ˆå°†æ‰€æœ‰å˜é‡å‡æ”¾å…¥æ¨¡å‹ï¼Œä¹‹åå°è¯•å°†å…¶ä¸­ä¸€ä¸ªè‡ªå˜é‡ä»æ¨¡å‹ä¸­å‰”é™¤ï¼Œçœ‹æ•´ä¸ªæ¨¡å‹è§£é‡Šå› å˜é‡çš„å˜å¼‚æ˜¯å¦æœ‰æ˜¾è‘—å˜åŒ–ï¼Œä¹‹åå°†æœ€æ²¡æœ‰è§£é‡ŠåŠ›çš„é‚£ä¸ªè‡ªå˜é‡å‰”é™¤ï¼›æ­¤è¿‡ç¨‹ä¸æ–­è¿­ä»£ï¼Œç›´åˆ°æ²¡æœ‰è‡ªå˜é‡ç¬¦åˆå‰”é™¤çš„æ¡ä»¶ã€‚ï¼ˆç¼ºç‚¹ï¼šè®¡ç®—é‡å¤§ï¼‰

```stata
// stat ä½¿ç”¨å‰éœ€è¦å‰”é™¤å¤šé‡å…±çº¿æ€§
stepwise regress y x1 x2 ... xk, pe(0.05)
stepwise regress y x1 x2 ... xk, pr(0.05)
```

## å›å½’æ¨¡å‹è§£é‡Š

æ€è€ƒæ¨¡å‹ $y_i=\beta_0+\beta_1\ln{x_i}$ æ€ä¹ˆè§£é‡Šï¼Ÿ

ä¼å¾·é‡Œå¥‡çš„ã€Šè®¡é‡ç»æµå­¦å¯¼è®ºï¼Œç°ä»£è§‚ç‚¹ã€‹æœ‰è¯¦ç»†çš„è®ºè¿°ï¼š

å–å¯¹æ•°æ„å‘³ç€åŸè¢«è§£é‡Šå˜é‡å¯¹è§£é‡Šå˜é‡çš„ **å¼¹æ€§**ï¼Œå³ç™¾åˆ†æ¯”çš„å˜åŒ–è€Œä¸æ˜¯æ•°å€¼çš„å˜åŒ–ã€‚å–å¯¹æ•°æœ‰ä¸€äº›ç»éªŒæ³•åˆ™ï¼š

å–å¯¹æ•°çš„å¥½å¤„ï¼šï¼ˆ1ï¼‰å‡å¼±æ•°æ®çš„å¼‚æ–¹å·®æ€§ï¼ˆ2ï¼‰å¦‚æœå˜é‡æœ¬èº«ä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œå–äº†å¯¹æ•°åå¯èƒ½æ¸è¿‘æœä»æ­£æ€åˆ†å¸ƒï¼ˆ3ï¼‰æ¨¡å‹å½¢å¼çš„éœ€è¦ï¼Œè®©æ¨¡å‹å…·æœ‰ç»æµå­¦æ„ä¹‰ã€‚

1. ä¸å¸‚åœºä»·å€¼ç›¸å…³çš„ï¼Œä¾‹å¦‚ï¼Œä»·æ ¼ã€é”€å”®é¢ã€å·¥èµ„ç­‰éƒ½å¯ä»¥å–å¯¹æ•°
2. ä»¥å¹´åº¦é‡çš„å˜é‡ï¼Œå¦‚å—æ•™è‚²å¹´é™ã€å·¥ä½œç»å†ç­‰é€šå¸¸ä¸å–å¯¹æ•°
3. æ¯”ä¾‹å˜é‡ï¼Œå¦‚å¤±ä¸šç‡ã€å‚ä¸ç‡ç­‰ï¼Œä¸¤è€…å‡å¯ï¼›
4. å˜é‡å–å€¼å¿…é¡»æ˜¯éè´Ÿæ•°ï¼Œå¦‚æœåŒ…å«0ï¼Œåˆ™å¯ä»¥å¯¹ y å–å¯¹æ•° ln(1+y)

å–å¯¹æ•°çš„å¥½å¤„ï¼š

1.  å‡å¼±æ•°æ®çš„ **å¼‚æ–¹å·®æ€§**
2.  å¦‚æœå˜é‡æœ¬èº«ä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œå–äº†å¯¹æ•°åå¯èƒ½æ¸è¿‘æœä»æ­£æ€åˆ†å¸ƒ
3.  æ¨¡å‹å½¢å¼çš„éœ€è¦ï¼Œè®©æ¨¡å‹å…·æœ‰ç»æµå­¦æ„ä¹‰

å››ç±»æ¨¡å‹å›å½’ç³»æ•°çš„è§£é‡Šï¼š

1. ä¸€å…ƒçº¿æ€§å›å½’ï¼šğ‘¦ = ğ‘ + ğ‘ğ‘¥+ ğœ‡ï¼Œx æ¯å¢åŠ  1 ä¸ªå•ä½ï¼Œy å¹³å‡å˜åŒ– b ä¸ªå•ä½
2. åŒå¯¹æ•°æ¨¡å‹ï¼šğ‘™ğ‘›ğ‘¦= ğ‘+ ğ‘ğ‘™ğ‘›ğ‘¥+ ğœ‡ï¼Œx æ¯å¢åŠ  1%ï¼Œy å¹³å‡å˜åŒ–b%
3. åŠå¯¹æ•°æ¨¡å‹ï¼šğ‘¦ = ğ‘ + ğ‘ğ‘™ğ‘›ğ‘¥+ ğœ‡ï¼Œx æ¯å¢åŠ  1%ï¼Œy å¹³å‡å˜åŒ– b/100 ä¸ªå•ä½
4. åŠå¯¹æ•°æ¨¡å‹ï¼šğ‘™ğ‘›ğ‘¦ = ğ‘+  ğ‘ğ‘¥+ ğœ‡ï¼Œx æ¯å¢åŠ  1 ä¸ªå•ä½ï¼Œy å¹³å‡å˜åŒ– (100b)%

## å›å½’è¯„ä»·

é¢„æµ‹å‹å›å½’ä¸€èˆ¬æ‰ä¼šæ›´çœ‹é‡ $R^2$ã€‚

è§£é‡Šå‹å›å½’æ›´å¤šçš„å…³æ³¨æ¨¡å‹æ•´ä½“ **æ˜¾è‘—æ€§** å³å¯ã€‚

å¯ä»¥å¯¹æ¨¡å‹è¿›è¡Œè°ƒæ•´ï¼Œä¾‹å¦‚å¯¹æ•°æ®å–å¯¹æ•°æˆ–è€…å¹³æ–¹åå†è¿›è¡Œå›å½’.

æ•°æ®çš„åˆ†å¸ƒæåº¦ä¸å‡åŒ€ï¼Œå¯èƒ½ä¼šå¯¼è‡´ $R^2$ è¾ƒä½ã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423145809163.png)

åœ¨å¯¹ **æ˜¾è‘—** çš„å›å½’ç³»æ•°è¯„ä»·æ—¶ï¼Œæ›´ä¸ºç²¾å‡†çš„ç ”ç©¶å½±å“è¯„ä»·é‡çš„é‡è¦å› ç´ ï¼ˆå»é™¤é‡çº²çš„å½±å“ï¼‰ï¼Œæˆ‘ä»¬å¯è€ƒè™‘ä½¿ç”¨ **æ ‡å‡†åŒ–** å›å½’ç³»æ•°ï¼Œæ ‡å‡†åŒ–ç³»æ•°çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œè¯´æ˜å¯¹å› å˜é‡çš„å½±å“å°±è¶Šå¤§ã€‚

è¦å…ˆè¯´æ˜åœ¨ *F æ£€éªŒ* ä¸‹å›å½’æ•ˆåº”æ˜¾è‘—ï¼Œç„¶åè®²è§£å„ä¸ªå›å½’ç³»æ•°ã€‚

**æŸäº›é”™è¯¯çš„åˆ†æåšæ³•ï¼š**

ä¸å¯å…ˆå¯¹å˜é‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦åˆ™ä¸å¥½è§£é‡Šæˆ–æœ‰ä¸å¥½çš„å½±å“ã€‚

ä¸è¦éšä¾¿å¯¹æ¨¡å‹å˜é‡ï¼ˆåŒ…å«è™šæ‹Ÿå˜é‡ï¼‰å¤æ‚ç»„åˆï¼Œå¦åˆ™ä¸å¥½è§£é‡Šã€‚

##  Stata ä½¿ç”¨

```stata
import excel "è¯¾å ‚ä¸­è®²è§£çš„å¥¶ç²‰æ•°æ®.xlsx", sheet("Sheet1") firstrow
// å®šé‡å˜é‡çš„æè¿°æ€§ç»Ÿè®¡
summarize å›¢è´­ä»·å…ƒ è¯„ä»·é‡ å•†å“æ¯›é‡kg
// å®šæ€§å˜é‡çš„é¢‘æ•°åˆ†å¸ƒï¼Œå¹¶å¾—åˆ°ç›¸åº”å­—æ¯å¼€å¤´çš„è™šæ‹Ÿå˜é‡
tabulate é…æ–¹ ,gen(A)
tabulate å¥¶æºäº§åœ° ,gen(B)
tabulate å›½äº§æˆ–è¿›å£ ,gen(C)
tabulate é€‚ç”¨å¹´é¾„å² ,gen(D)
tabulate åŒ…è£…å•ä½ ,gen(E)
tabulate åˆ†ç±» ,gen(F)
tabulate æ®µä½ ,gen(G)
// ä¸‹é¢è¿›è¡Œå›å½’
regress è¯„ä»·é‡ å›¢è´­ä»·å…ƒ å•†å“æ¯›é‡kg
// å¾—åˆ°æ ‡å‡†åŒ–å›å½’ç³»æ•°
regress è¯„ä»·é‡ å›¢è´­ä»·å…ƒ å•†å“æ¯›é‡kg, b
// ç”»å‡ºæ®‹å·®å›¾
regress è¯„ä»·é‡ å›¢è´­ä»·å…ƒ å•†å“æ¯›é‡kg A1 A2 A3 B1 B2 B3 B4 B5 B6 B7 B8 B9 C1 C2 D1 D2 D3 D4 D5 E1 E2 E3 E4 F1 F2 G1 G2 G3 G4
// æ®‹å·®ä¸æ‹Ÿåˆå€¼çš„æ•£ç‚¹å›¾
rvfplot 
// æ®‹å·®ä¸è‡ªå˜é‡å›¢è´­ä»·çš„æ•£ç‚¹å›¾
rvpplot  å›¢è´­ä»·å…ƒ

// ä¸ºä»€ä¹ˆè¯„ä»·é‡çš„æ‹Ÿåˆå€¼ä¼šå‡ºç°è´Ÿæ•°ï¼Ÿ
// æè¿°æ€§ç»Ÿè®¡å¹¶ç»™å‡ºåˆ†ä½æ•°å¯¹åº”çš„æ•°å€¼
summarize è¯„ä»·é‡, d
// ä½œè¯„ä»·é‡çš„æ¦‚ç‡å¯†åº¦ä¼°è®¡å›¾
kdensity è¯„ä»·é‡

// å¼‚æ–¹å·®BPæ£€éªŒ
estat hettest ,rhs iid
// å¼‚æ–¹å·®æ€€ç‰¹æ£€éªŒ
estat imtest,white
// ä½¿ç”¨OLS + ç¨³å¥çš„æ ‡å‡†è¯¯
regress è¯„ä»·é‡ å›¢è´­ä»·å…ƒ å•†å“æ¯›é‡kg A1 A2 A3 B1 B2 B3 B4 B5 B6 B7 B8 B9 C1 C2 D1 D2 D3 D4 D5 E1 E2 E3 E4 F1 F2 G1 G2 G3 G4, r

// è®¡ç®—VIF
estat  vif
```

# å²­å›å½’ / lasso å›å½’

ä½¿ç”¨è½¯ä»¶ï¼šStataã€‚

ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ **å¤šé‡å…±çº¿æ€§** çš„é—®é¢˜ã€‚

å²­å›å½’å’Œ lasso å›å½’åœ¨ OLS å›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°ä¸ŠåŠ ä¸Šäº†ä¸åŒçš„æƒ©ç½šé¡¹ï¼Œè¯¥æƒ©ç½šé¡¹ç”± **å›å½’ç³»æ•°çš„å‡½æ•°** æ„æˆï¼š

- ä¸€æ–¹é¢ï¼ŒåŠ å…¥çš„æƒ©ç½šé¡¹èƒ½å¤Ÿè¯†åˆ«å‡ºæ¨¡å‹ä¸­ä¸é‡è¦çš„å˜é‡ï¼Œå¯¹æ¨¡å‹èµ·åˆ°ç®€åŒ–ä½œç”¨ï¼Œå¯ä»¥çœ‹ä½œé€æ­¥å›å½’æ³•çš„å‡çº§ç‰ˆ

- å¦ä¸€æ–¹é¢ï¼ŒåŠ å…¥çš„æƒ©ç½šé¡¹èƒ½å¤Ÿè®©æ¨¡å‹å˜å¾— **å¯ä¼°è®¡**

## å²­å›å½’

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165603084.png)

æ‰€ä»¥é€‰æ‹©ä¸åŒ $\lambda$ ä¼šå¾—å‡ºä¸åŒçš„å›å½’ç³»æ•°ï¼Œé€‰æ‹© $\lambda$ çš„æ–¹æ³•ï¼š

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165909057.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165933033.png)

æœ€å°åŒ–å‡æ–¹é¢„æµ‹è¯¯å·®æ–¹æ³•ï¼Œå–ä¸åŒçš„ $\lambda$ ç„¶åå¤šæ¬¡è¿›è¡Œ K æŠ˜äº¤å‰éªŒè¯ï¼Œä½¿å¾—æ•´ä¸ªæ ·æœ¬çš„ MSPE ï¼ˆå‡æ–¹é¢„æµ‹è¯¯å·®ï¼‰æœ€å°ã€‚

## lasso å›å½’

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423170638310.png)

```stata
// æ³¨æ„ï¼šè¿™é‡Œè‡ªå˜é‡çš„é‡çº²ç›¸åŒæ‰€ä»¥ä¸ç”¨æ ‡å‡†åŒ–ï¼Œå¦‚æœéœ€è¦æ ‡å‡†åŒ–ï¼Œé‚£ä¹ˆå¯ä»¥å€ŸåŠ©Matlabçš„zscoreå‡½æ•°ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨SPSSï¼ˆåˆ†æ-æè¿°ç»Ÿè®¡-æè¿°ï¼šåœ¨æè¿°åˆ—è¡¨çš„æ–¹æ¡†å·¦ä¸‹è§’ï¼Œçœ‹åˆ°â€œå°†æ ‡å‡†åŒ–å¾—åˆ†å¦å­˜ä¸ºå˜é‡ï¼ˆZï¼‰ä¹‹åç‚¹å‡»æ‰“å‹¾ï¼Œç„¶åç¡®å®šã€‚ï¼‰
// Stataä¸€æ¬¡åªèƒ½æ ‡å‡†åŒ–ä¸€ä¸ªå˜é‡ï¼Œä¾‹å¦‚ï¼š egen Y = std(å•äº§)  è¿™ä¸ªä»£ç å°±è¡¨ç¤ºå°†å•äº§æ ‡å‡†åŒ–ï¼Œå¾—åˆ°çš„å˜é‡è®°ä¸ºY
cvlasso å•äº§ ç§å­è´¹ åŒ–è‚¥è´¹ å†œè¯è´¹ æœºæ¢°è´¹ çŒæº‰è´¹, lopt seed(520) // seed ä¸åŒç§å­
```

stata ä¼šç»™å‡ºå„ $\lambda$ çš„è®¡ç®—ç»“æœï¼Œä»¥åŠæå‡º 0 ç³»æ•°åçš„å›å½’ç»“æœã€‚

## ä½•æ—¶ä½¿ç”¨

æœ€ä¸€èˆ¬çš„OLSå¯¹æ•°æ®è¿›è¡Œå›å½’ï¼Œç„¶åè®¡ç®—æ–¹å·®è†¨èƒ€å› å­VIFï¼Œå¦‚æœ VIF >10 åˆ™è¯´æ˜å­˜åœ¨å¤šé‡å…±çº¿æ€§çš„é—®é¢˜ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦å¯¹å˜é‡è¿›è¡Œç­›é€‰ã€‚

# BP ç¥ç»ç®—æ³•

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429162305389.png)

BP åå‘ä¼ æ’­ï¼Œèƒ½å¤Ÿæ ¹æ®è¯¯å·®å†å»è°ƒæ•´å·®å€¼ã€‚

ç¥ç»ç½‘ç»œçš„å‚æ•°è·Ÿå±‚æ•°è¿˜æœ‰å„æ ·æœ¬è¾“å…¥ç‰¹å¾å€¼çš„æ•°é‡å¯†åˆ‡ç›¸å…³ï¼Œè€Œä¸”å¯ä»¥ç”¨æ¥è®­ç»ƒæ ·æœ¬å°‘è€Œç‰¹å¾å€¼å¤šçš„æ•°æ®é›†ã€‚

æ•ˆæœä¸é”™ï¼Œç›¸å½“ä¸‡é‡‘æ²¹ï¼Œä½†æ˜¯å…·ä½“è§£é‡Šéº»çƒ¦ï¼Œ**ç®€å•æ•°æ®é›†** æœ€å¥½è¿˜æ˜¯ç”¨å…¶ä»–æ¨¡å‹ã€‚

ä½¿ç”¨è½¯ä»¶ï¼šMatlabã€‚

## Matlab ä½¿ç”¨

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163406220.png)

### è®­ç»ƒ

è®¾ç½®æ•°æ®é›†æ¯”ä¾‹ï¼š

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163156212.png)

è®­ç»ƒç®—æ³•æœ‰ä»¥ä¸‹ 3 ç§ï¼š

- Levenbergâ€“Marquardt algorithmï¼šèƒ½æä¾›æ•°éçº¿æ€§æœ€å°åŒ–ï¼ˆå±€éƒ¨æœ€å°ï¼‰çš„æ•°å€¼è§£ï¼Œé€Ÿåº¦æœ€å¿«

- Scaled Conjugate Gradient
- Bayesianâ€regularizationï¼šé€Ÿåº¦æœ€æ…¢ï¼Œæ”¶æ•›æ¬¡æ•°å¤šï¼Œæ‹Ÿåˆæ•ˆæœæœ€å¥½

ä¸€èˆ¬æˆ‘ä»¬è¿˜å¯ä»¥ä¸»åŠ¨æŠŠæ•°æ®é›†åˆ†å‰²å¼€ï¼Œç”¨è¿™ 3 ç§è®­ç»ƒç®—æ³•ç®—å‡ºåå†çœ‹æ•ˆæœã€‚

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163752681.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163818936.png)

![](https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163935237.png)

### é¢„æµ‹

```matlab
load data_Octane.mat
nftool
% æ ¹æ®è®­ç»ƒå‡ºæ¥çš„ç½‘ç»œ net é¢„æµ‹
sim(net, new_X(1,:)')

predict_y = zeros(10,1);
for i = 1: 10
    result = sim(net, new_X(i,:)');
    predict_y(i) = result;
end
disp('é¢„æµ‹å€¼ä¸ºï¼š')
disp(predict_y)
```

# é€»è¾‘å›å½’

åˆç§° Logistic å›å½’ï¼Œç”±äºå¯¹å·²çŸ¥æ•°æ®åˆ†ç±»ï¼Œè¯¦è§åˆ†ç±»æ¨¡å‹ã€‚

