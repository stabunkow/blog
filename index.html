<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"stabunkow.github.io","root":"/blog/","images":"/blog/images","scheme":"Muse","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>
<meta name="description" content="Try to write something.">
<meta property="og:type" content="website">
<meta property="og:title" content="Hauk&#39;s Blog">
<meta property="og:url" content="http://stabunkow.github.io/blog/index.html">
<meta property="og:site_name" content="Hauk&#39;s Blog">
<meta property="og:description" content="Try to write something.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hauk">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://stabunkow.github.io/blog/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>Hauk's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hauk's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">~ o ha yo ~</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Hauk</p>
  <div class="site-description" itemprop="description">Try to write something.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives">
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%8F%92%E5%80%BC%E4%B8%8E%E6%8B%9F%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%8F%92%E5%80%BC%E4%B8%8E%E6%8B%9F%E5%90%88/" class="post-title-link" itemprop="url">数学建模-插值与拟合</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:03:32 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:03:32+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="插值算法">插值算法</h1>
<p>现有数据不够，不足以进行分析，需要补充一些靠谱的值。</p>
<p>插值算法经过 <strong>所有已知点</strong>，包含插值区间 <span class="math inline">\([a, b]\)</span></p>
<p>插值算法存在 代数多项式、分段多项式、三角多项式。</p>
<h2 id="多项式插值法">多项式插值法</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421184001641.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421184125977.png" /></p>
<h2 id="拉格朗日插值法">拉格朗日插值法</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421184234418.png" /></p>
<h2 id="龙格现象">龙格现象</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421184407055.png" /></p>
<h2 id="分段插值">分段插值</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421184649189.png" /></p>
<p>可进行分段线性插值、分段二次插值（在<span class="math inline">\(x_{i-1}, x_i, x_{i+1}\)</span>上）等。</p>
<h2 id="牛顿插值">牛顿插值</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421185036121.png" /></p>
<p>牛顿插值法的计算过程具有继承性，有新项时，可以在前 <span class="math inline">\(n\)</span> 项的添加新的项即可。</p>
<h2 id="hermite-插值">Hermite 插值</h2>
<p>不但要求在节点上的函数值相等，而且还要求对应的导数值也相等,甚至要求高阶导数也相等，保持函数光滑，密和程度更好。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421185619386.png" /></p>
<p>实际使用时，直接使用高次多项式 Hermite 插值会有龙格现象问题，所以往往使用分段三次进行 Hermite 插值。</p>
<h2 id="三次样条插值">三次样条插值</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421190127791.png" /></p>
<p>相比 Hermite 插值，三次样条插值更加平滑。</p>
<h2 id="matlab-使用">Matlab 使用</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = -<span class="built_in">pi</span>:<span class="built_in">pi</span>; <span class="comment">% 默认间隔1</span></span><br><span class="line">y = <span class="built_in">sin</span>(x);</span><br><span class="line">new_x = -<span class="built_in">pi</span>:<span class="number">0.1</span>:<span class="built_in">pi</span>;</span><br><span class="line">p1 = pchip(x, y, new_x); <span class="comment">% hermite 三次插值</span></span><br><span class="line">p2 = spline(x, y, new_x); <span class="comment">% 三次样条插值</span></span><br><span class="line"><span class="comment">% p2 = interpn (x, y, new_x, &#x27;spline&#x27;);</span></span><br><span class="line"><span class="comment">% 等价使用，默认 linear spline 最为精准</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(x, y, <span class="string">&#x27;o&#x27;</span>, new_x, p1, <span class="string">&#x27;r-&#x27;</span>, new_x, p2, <span class="string">&#x27;b-&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;样本点&#x27;</span>, <span class="string">&#x27;三次 hermite 插值&#x27;</span>, <span class="string">&#x27;三次样条插值&#x27;</span>, <span class="string">&#x27;Location&#x27;</span>, <span class="string">&#x27;SouthEast&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="拟合算法">拟合算法</h1>
<p>所给定的曲线不一定经过所有给定点，只要求曲线在某种准则下跟已有的数据点最为接近，误差损失最小，拟合最好。</p>
<h2 id="拟合评价">拟合评价</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421192328510.png" /></p>
<p>拟合的初衷是简单，太复杂过拟合也不好。</p>
<p>只有线性函数才能用于拟合优度，<strong>复杂函数</strong>（复合函数）不行，只看 SSE 即可。</p>
<p>线性函数：对参数 arg 为线性，例如： <span class="math inline">\(y=a+b x^2\)</span>，线性于参数（参数没有高次，不能有乘或除或参数的复合）</p>
<p><span class="math inline">\(y=e^{\beta_1+\beta_2x}\)</span> 是线性函数，<span class="math inline">\(y=a\sin(b+cx)\)</span> 不是。</p>
<h2 id="最小二乘法">最小二乘法</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421191608952.png" /></p>
<h3 id="matlab-使用-1">Matlab 使用</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">load data1</span><br><span class="line"><span class="built_in">plot</span>(x, y, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;x的值&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;y的值&#x27;</span>)</span><br><span class="line">n = <span class="built_in">size</span>(x, <span class="number">1</span>);</span><br><span class="line">k = (n * sum(x .* y) - sum(x) * sum(y)) / (n * sum(x .* x) - sum(x) * sum(x));</span><br><span class="line">b = (sum(x .* x) * sum(y) - sum(x) * sum(x .* y)) / (n * sum(x .* x) - sum(x) * sum(x));</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">grid on</span><br><span class="line">f = @(x) k * x + b;</span><br><span class="line">fplot(f, [<span class="number">2.5</span>, <span class="number">7</span>]) <span class="comment">% 指定区间绘图</span></span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;样本数据&#x27;</span>, <span class="string">&#x27;拟合函数&#x27;</span>, <span class="string">&#x27;location&#x27;</span>, <span class="string">&#x27;SouthEast&#x27;</span>)</span><br><span class="line"></span><br><span class="line">y_hat = k * x +b; <span class="comment">% y 的拟合值</span></span><br><span class="line">SSR = sum((y_hat - <span class="built_in">mean</span>(y)) .^ <span class="number">2</span>)  <span class="comment">% 回归平方和</span></span><br><span class="line">SST = sum((y - <span class="built_in">mean</span>(y)).^<span class="number">2</span>) <span class="comment">% 总体平方和</span></span><br><span class="line">R_2 = SSR / SST</span><br></pre></td></tr></table></figure>
<h2 id="其他拟合方法">其他拟合方法</h2>
<p>当数据量过大时，最小二乘法可能满足不了计算（例如内存不足），可能有其他以迭代为基础的拟合方法。</p>
<p>如 <em>梯度下降法</em>、<em>随机梯度下降法</em>、<em>共轭梯度下降法</em>等。</p>
<p>拟合时，需要选择变量起始迭代点，还有迭代步数。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">year = <span class="number">1790</span>:<span class="number">10</span>:<span class="number">2000</span>;</span><br><span class="line">population = [<span class="number">3.9</span> <span class="number">5.3</span> ...];</span><br><span class="line"><span class="built_in">plot</span>(year,population,<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">cftool  <span class="comment">% 拟合工具箱</span></span><br><span class="line"><span class="comment">% (1) X data 选择 year</span></span><br><span class="line"><span class="comment">% (2) Y data 选择 population</span></span><br><span class="line"><span class="comment">% (3) 拟合方式选择：Custom Equation (自定义方程)</span></span><br><span class="line"><span class="comment">% (4) 修改下方的方框为：x = f(t) = xm/(1+(xm/3.9-1)*exp(-r*(t-1790)))</span></span><br><span class="line"><span class="comment">% (5) 左边的result一栏最上面显示：Fit computation did not converge:即没有找到收敛解</span></span><br><span class="line"><span class="comment">% (6) 点击Fit Options，修改非线性最小二乘估计法拟合的初始值(StartPoint), r修改为0.02，xm修改为500 </span></span><br><span class="line"><span class="comment">% (7) 依次点击拟合工具箱的菜单栏最左边的文件—Generate Code</span></span><br><span class="line">[fitresult, gof] = createFit(year, population)</span><br><span class="line">t = <span class="number">2001</span>:<span class="number">2030</span>;</span><br><span class="line">xm = <span class="number">342.4</span>; </span><br><span class="line">r = <span class="number">0.02735</span>;</span><br><span class="line">predictions = xm ./ (<span class="number">1</span> + (xm ./ <span class="number">3.9</span> - <span class="number">1</span>) .* <span class="built_in">exp</span>(- r .* (t<span class="number">-1790</span>)));  <span class="comment">% 计算预测值</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(year, population, <span class="string">&#x27;o&#x27;</span>, t, predictions, <span class="string">&#x27;.&#x27;</span>)  <span class="comment">% 绘制预测结果图</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-SVD%E5%88%86%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-SVD%E5%88%86%E8%A7%A3/" class="post-title-link" itemprop="url">数学建模-SVD分解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:02:52 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:02:52+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="svd-分解">SVD 分解</h1>
<p>高等线性代数，奇异值分解。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142258565.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142457281.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142517737.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142537550.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142626873.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142703738.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142831766.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[compress_A]</span> = <span class="title">mysvd</span><span class="params">(A, ratio)</span></span></span><br><span class="line">    <span class="comment">% 函数作用：使用奇异值分解将矩阵A压缩到指定的特征比例</span></span><br><span class="line">    <span class="comment">% 输入变量：</span></span><br><span class="line">    <span class="comment">%     A：要压缩的m*n维的矩阵</span></span><br><span class="line">    <span class="comment">%     ratio：要保留原矩阵的特征比例（100%表示不压缩）</span></span><br><span class="line">    <span class="comment">% 输出变量：</span></span><br><span class="line">    <span class="comment">%     compress_A: 压缩后的矩阵</span></span><br><span class="line">    [U,S,V] = svd(A);   <span class="comment">% U:m*m S:m*n V:n*n</span></span><br><span class="line">    eigs = <span class="built_in">diag</span>(S);  <span class="comment">% diag函数可以返回S的主对角线元素，即矩阵A的奇异值，并将其保存到列向量中</span></span><br><span class="line">    SUM = sum(eigs);  <span class="comment">% 计算所有奇异值的总和</span></span><br><span class="line">    temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>  <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(eigs)</span><br><span class="line">        temp = temp + eigs(<span class="built_in">i</span>);</span><br><span class="line">        <span class="keyword">if</span> (temp / SUM) &gt; ratio</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;压缩后保留原矩阵的比例特征为：&#x27;</span>,num2str(roundn(<span class="number">100</span>*temp/SUM,<span class="number">-2</span>)),<span class="string">&#x27;%&#x27;</span>])</span><br><span class="line">    compress_A= U(:,<span class="number">1</span>:<span class="built_in">i</span>)*S(<span class="number">1</span>:<span class="built_in">i</span>,<span class="number">1</span>:<span class="built_in">i</span>)*V(:,<span class="number">1</span>:<span class="built_in">i</span>)&#x27;;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508143029688.png" /></p>
<h2 id="图片处理">图片处理</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210508142915370.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[]</span> = <span class="title">photo_compress</span><span class="params">(photo_address, save_address, ratio, greycompress)</span></span></span><br><span class="line">    <span class="comment">% 函数作用：利用SVD对图形进行压缩</span></span><br><span class="line">    <span class="comment">% 输入变量：</span></span><br><span class="line">    <span class="comment">%     photo_address：要压缩的图片存放的位置（建议输入完整的路径）</span></span><br><span class="line">    <span class="comment">%     save_address：将压缩后的图片保存的位置（建议输入完整的路径）</span></span><br><span class="line">    <span class="comment">%     ratio：要保留原矩阵的特征比例（100%表示不压缩）</span></span><br><span class="line">    <span class="comment">%     greycompress： 如果该值等于1，则会彩色的原图片转换为灰色图片后再压缩；默认值为0，表示不进行转换</span></span><br><span class="line">    <span class="comment">% 输出变量：</span></span><br><span class="line">    <span class="comment">%     无（不需要输出，因为函数运行过程中已经将图片保存）</span></span><br><span class="line">    <span class="keyword">if</span> nargin == <span class="number">3</span>  <span class="comment">% 判断用户输入的参数</span></span><br><span class="line">        greycompress = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    img = double(imread(photo_address));</span><br><span class="line">    <span class="comment">% 图片保存的对象是 &#x27;uint8&#x27; 类型，需要将其转换为double类型才能进行奇异值分解的操作</span></span><br><span class="line">    <span class="comment">% 注意:  img是图形的像素矩阵，如果是彩色图片则是三维矩阵，如果是灰色图片(R=G=B)则是二维矩阵</span></span><br><span class="line">    <span class="comment">% &#x27;赫本.jpg&#x27;是灰色的图片，得到的img类型是[914×1200]double</span></span><br><span class="line">    <span class="comment">% &#x27;千与千寻.jpg&#x27;是彩色的图片，得到的img类型是[768×1024×3]double</span></span><br><span class="line">    <span class="comment">% 因此我们可利用第三个维度的大小来判断图片是否为灰色的</span></span><br><span class="line">    <span class="comment">% 灰色图片的只有两个维度，所以size(img ,3) == 1</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (greycompress == <span class="number">1</span>) &amp;&amp; (<span class="built_in">size</span>(img ,<span class="number">3</span>) == <span class="number">3</span>)</span><br><span class="line">        img = double(rgb2gray(imread(photo_address)));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">size</span>(img ,<span class="number">3</span>) == <span class="number">3</span></span><br><span class="line">        R=img(:,:,<span class="number">1</span>);       <span class="comment">% RGB色彩模式三要素：红色</span></span><br><span class="line">        G=img(:,:,<span class="number">2</span>);       <span class="comment">% RGB色彩模式三要素：绿色</span></span><br><span class="line">        B=img(:,:,<span class="number">3</span>);       <span class="comment">% RGB色彩模式三要素：蓝色</span></span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;正在压缩:  &#x27;</span>,photo_address,<span class="string">&#x27;的红色要素&#x27;</span>])</span><br><span class="line">        r = mysvd(R, ratio);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;正在压缩:  &#x27;</span>,photo_address,<span class="string">&#x27;的绿色要素&#x27;</span>])</span><br><span class="line">        g = mysvd(G, ratio);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;正在压缩:  &#x27;</span>,photo_address,<span class="string">&#x27;的蓝色要素&#x27;</span>])</span><br><span class="line">        b = mysvd(B, ratio);</span><br><span class="line">        compress_img=<span class="built_in">cat</span>(<span class="number">3</span>,r,g,b);  <span class="comment">% 根据三个RGB矩阵（压缩后的r、g、b）生成图片对象</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;正在压缩灰色图片:  &#x27;</span>,photo_address])</span><br><span class="line">        compress_img = mysvd(img, ratio);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    imwrite(uint8(compress_img), save_address);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="section"></h1>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">数学建模-分类模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:52 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:52+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="分类模型">分类模型</h1>
<p>对于分类模型，一般为二分类模型和多分类模型。</p>
<p>训练数据一般为已标注的，再对未知数据进行预测。</p>
<h1 id="逻辑回归">逻辑回归</h1>
<p>又称 Logistic 回归。</p>
<p>使用软件：SPSS。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426161304649.png" /></p>
<p>直接使用线性回归模型，会有内生性问题，而且预测值会出现 <span class="math inline">\(y\)</span> &gt; 1 或 <span class="math inline">\(y\)</span> &lt; 0 等情况。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426162412965.png" /></p>
<h2 id="spss-操作">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426162721523.png" /></p>
<p>可对回归进行设置，向前（向后）逐步回归可选择的统计量有所区别，进入（或者除去）自变量的显著性水平可以自己调节。</p>
<p>会给出预测成功率的分类表，和逻辑回归系数表。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426163140172.png" /></p>
<h2 id="其他说明">其他说明</h2>
<p>预测结果较差时，可在 logistic 回归模型中加入平方项、交互项等，但是要注意过拟合现象。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426163508040.png" /></p>
<p>对模型求准确率，最好还是对原数据进行 <strong>交叉验证</strong>，求一个平均的准确率，消除偶然影响。</p>
<p>Logistic 回归也可用于多分类，将 <strong>Sigmoid</strong> 函数推广为 <strong>Softmax</strong> 函数。</p>
<h1 id="fisher-线性判别分析">Fisher 线性判别分析</h1>
<p>又称 LDA (Linear Discriminant Analysis)，给定训练集样例，设法将样例（数据）投影到一维的直线上，使得同类样例的投影点尽可能接近和密集，异类投影点尽可能远离。 SVM（支持向量机）则是将空间巧妙地映射到更高维度来分类非线性数据的方法。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426164834588.png" /></p>
<h2 id="spss-操作-1">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426164957502.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426165023610.png" /></p>
<p>Fisher 判别分析也可用于多分类，直接设置定义范围即可。</p>
<h1 id="svm-支持向量机">SVM 支持向量机</h1>
<p>SVM（支持向量机）则是将空间巧妙地映射到更高维度来分类非线性数据的方法。</p>
<p>待补充。</p>
<h1 id="决策树">决策树</h1>
<p>待补充。</p>
<h1 id="神经网络">神经网络</h1>
<p>待补充。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">数学建模-聚类模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:22 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:22+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="聚类模型">聚类模型</h1>
<p>聚类，就是将样本划分为由类似的对象组成的多个类的过程。聚类后，我们可以更加准确的在每个类中单独使用统计模型进行估计、分析或预测；也可以探究不同类之间的相关性和主要差异。</p>
<p>分类是已知类别的，聚类未知。</p>
<p>样本与样本之间的常用距离有欧式距离、或者曼哈顿距离等。</p>
<p>也可以将指标和样本矩阵倒转，指标进行聚类，以相关系数衡量夹角距离。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426195316752.png" /></p>
<h1 id="k-means-算法">K-means 算法</h1>
<ol type="1">
<li>指定需要划分的簇的个数K值（类的个数）</li>
<li>随机地选择K个数据对象作为初始的聚类中心</li>
<li>计算其余的各个数据对象到这K个初始聚类中心的距离，把数据对象划归到距离它最近的那个中心所处在的簇类中</li>
<li>调整新类并且重新计算出新类的中心</li>
<li>循环步骤 3 和 4，看中心是否收敛（不变），如果收敛或达到迭代次数则停止循环</li>
<li>结束</li>
</ol>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426193957697.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426194018560.png" /></p>
<p>优点：</p>
<ol type="1">
<li>算法简单、快速</li>
<li>对处理大数据集，该算法是相对高效率的</li>
</ol>
<p>缺点：</p>
<ol type="1">
<li>用户必须事先给出要生成的簇的数目K</li>
<li><strong>对初值敏感</strong> （不同初值会分类结果不同）</li>
<li><strong>对于孤立点数据敏感</strong> （孤立点不能单独形成类）</li>
</ol>
<h1 id="k-means-算法-1">K-means++ 算法</h1>
<p>选择初始聚类中心的基本原则是：初始的聚类中心之间的相互距离要尽可能的远。</p>
<p>对 <strong>初始化K个聚类中心</strong> 进行了优化</p>
<ol type="1">
<li>随机选取一个样本作为第一个聚类中心</li>
<li>计算每个样本与当前已有聚类中心的最短距离（即与最近一个聚类中心的距离），这个值越大，表示被选取作为聚类中心的概率较大；最后，用轮盘法（依据概率大小来进行抽选）选出下一个聚类中心。</li>
<li>重复步骤 2，直到选出K个聚类中心。</li>
</ol>
<p>分几类主要取决于个人的经验与感觉，通常的做法是多尝试几个 K 值，看分成几类的结果更好 <strong>解释</strong>，更符合分析 <strong>目的 </strong>等。</p>
<p>数据的量纲不一致时，需要标准化。</p>
<h2 id="spss-操作">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426194949309.png" /></p>
<h1 id="系统层次聚类">系统（层次）聚类</h1>
<p>系统聚类的合并算法通过计算两类数据点间的距离，对最为接近的两类数据点进行组合，并反复迭代这一过程，直到将所有数据点合成一类，并生成聚类谱系图。</p>
<p>类与类之间的常用距离：最短距离法、最长距离法、组间平均连接法、组内平均连接法、重心法等。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426195100447.png" /></p>
<ol type="1">
<li>将每个对象看作一类，计算两两之间的最小距离</li>
<li>将距离最小的两个类合并成一个新类</li>
<li>重新计算新类与所有类之间的距离</li>
<li>重复 2、3 两步，直到所有类最后合并成一类</li>
<li>结束</li>
</ol>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426195951206.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200151578.png" /></p>
<h2 id="spss-操作-1">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200251752.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200357762.png" /></p>
<h2 id="估计聚类数量">估计聚类数量</h2>
<p><strong>肘部法则</strong>：通过图形大致的估计出最优的聚类数量。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200530564.png" /></p>
<p>把数据粘贴到Excel表格中，并按照降序排好。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200744139.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426200859594.png" /></p>
<p>当指标个数为 2 或者 3 的时候可以再做散点图画图。</p>
<h1 id="dbscan-算法">DBSCAN 算法</h1>
<p>一种基于密度的聚类方法，聚类前不需要预先指定聚类的个数，生成的簇的个数不定（和数据有关）。要求聚类空间中的一定区域内所包含对象（点或其他空间对象）的数目不小于某一给定阈值。能在具有 <strong>噪声 </strong> 的空间数据库中发现任意形状的簇，可将密度足够大的相邻区域连接，能有效处理异常数据。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426201112210.png" /></p>
<ul>
<li>核心点及边界点：在半径 Eps 内含有不少于 MinPts 数目的点；在半径 Eps 内点的数量小于 MinPts，落在核心点的邻域内。</li>
<li>噪音点：既不是核心点也不是边界点的点，单独成点</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210426201348799.png" /></p>
<p>优点：</p>
<ol type="1">
<li>基于密度定义，能处理任意形状和大小的簇</li>
<li>可在聚类的同时发现异常点</li>
<li>与K-means比较起来，不需要输入要划分的聚类个数</li>
</ol>
<p>缺点：</p>
<ol type="1">
<li>输入参数 ε 和 Minpts 敏感，确定参数困难</li>
<li>由于DBSCAN算法中，变量 ε 和 Minpts 是全局唯一的，当聚类的密度不 <strong>均匀</strong> 时，聚类距离相差很大时，聚类质量差</li>
<li>当数据量大时，计算密度单元的计算复杂度大</li>
</ol>
<p>做出散点图后发现数据表现得很 "DBSCAN"，这时候再用 DBSCAN 进行聚类。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[IDX, isnoise]</span>=<span class="title">DBSCAN</span><span class="params">(X,epsilon,MinPts)</span></span></span><br><span class="line">    C=<span class="number">0</span>;</span><br><span class="line">    n=<span class="built_in">size</span>(X,<span class="number">1</span>);</span><br><span class="line">    IDX=<span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line">    D=pdist2(X,X); <span class="comment">% 生成距离矩阵</span></span><br><span class="line">    visited=<span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line">    isnoise=<span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">if</span> visited(<span class="built_in">i</span>)==<span class="number">0</span></span><br><span class="line">            visited(<span class="built_in">i</span>)=<span class="number">1</span>;</span><br><span class="line">            Neighbors=RegionQuery(<span class="built_in">i</span>);</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">numel</span>(Neighbors)&lt;MinPts</span><br><span class="line">                isnoise(<span class="built_in">i</span>)=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                C=C+<span class="number">1</span>;</span><br><span class="line">                ExpandCluster(<span class="built_in">i</span>,Neighbors,C);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ExpandCluster</span><span class="params">(i,Neighbors,C)</span></span></span><br><span class="line">        IDX(<span class="built_in">i</span>)=C;</span><br><span class="line">        k = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">true</span></span><br><span class="line">            <span class="built_in">j</span> = Neighbors(k);</span><br><span class="line">            <span class="keyword">if</span> visited(<span class="built_in">j</span>)==<span class="number">0</span></span><br><span class="line">                visited(<span class="built_in">j</span>)=<span class="number">1</span></span><br><span class="line">                Neighbors2=RegionQuery(<span class="built_in">j</span>);</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">numel</span>(Neighbors2)&gt;=MinPts</span><br><span class="line">                    Neighbors=[Neighbors Neighbors2];</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">if</span> IDX(<span class="built_in">j</span>)==<span class="number">0</span></span><br><span class="line">                IDX(<span class="built_in">j</span>)=C;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            k = k + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> k &gt; <span class="built_in">numel</span>(Neighbors)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Neighbors</span>=<span class="title">RegionQuery</span><span class="params">(i)</span></span></span><br><span class="line">        Neighbors=<span class="built_in">find</span>(D(<span class="built_in">i</span>,:)&lt;=epsilon);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PlotClusterinResult</span><span class="params">(X, IDX)</span></span></span><br><span class="line">    k=<span class="built_in">max</span>(IDX);</span><br><span class="line">    Colors=hsv(k);</span><br><span class="line">    Legends = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">0</span>:k</span><br><span class="line">        Xi=X(IDX==<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">i</span>~=<span class="number">0</span></span><br><span class="line">            Style = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">            MarkerSize = <span class="number">8</span>;</span><br><span class="line">            Color = Colors(<span class="built_in">i</span>,:);</span><br><span class="line">            Legends&#123;<span class="keyword">end</span>+<span class="number">1</span>&#125; = [<span class="string">&#x27;Cluster #&#x27;</span> num2str(<span class="built_in">i</span>)];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Style = <span class="string">&#x27;o&#x27;</span>;</span><br><span class="line">            MarkerSize = <span class="number">6</span>;</span><br><span class="line">            Color = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> ~<span class="built_in">isempty</span>(Xi)</span><br><span class="line">                Legends&#123;<span class="keyword">end</span>+<span class="number">1</span>&#125; = <span class="string">&#x27;Noise&#x27;</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(Xi)</span><br><span class="line">            <span class="built_in">plot</span>(Xi(:,<span class="number">1</span>),Xi(:,<span class="number">2</span>),Style,<span class="string">&#x27;MarkerSize&#x27;</span>,MarkerSize,<span class="string">&#x27;Color&#x27;</span>,Color);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="built_in">hold</span> on</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">hold</span> off</span><br><span class="line">    axis equal</span><br><span class="line">    grid on</span><br><span class="line">    <span class="built_in">legend</span>(Legends)</span><br><span class="line">    <span class="built_in">legend</span>(<span class="string">&#x27;Location&#x27;</span>, <span class="string">&#x27;NorthEastOutside&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">epsilon=<span class="number">0.5</span>;</span><br><span class="line">MinPts=<span class="number">10</span>;</span><br><span class="line">IDX=DBSCAN(X,epsilon,MinPts);</span><br><span class="line">PlotClusterinResult(X, IDX);</span><br></pre></td></tr></table></figure>
<h1 id="section"></h1>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">数学建模-回归分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:12 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:12+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="回归分析">回归分析</h1>
<p>回归分析的使命：</p>
<ol type="1">
<li>判断哪些 X 变量是同 Y 真的相关</li>
<li>判断相关性是正的还是负的</li>
<li>估计回归系数权重（还要标准化去量纲之后）</li>
</ol>
<p>回归分析的分类：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162048564.png" /></p>
<p>回归的方法和评价跟 <strong>拟合</strong> 类似。</p>
<p>使用软件：Stata。</p>
<h1 id="合理预测模型">合理预测模型</h1>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429164529866.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429164546728.png" /></p>
<h1 id="多元线性回归">多元线性回归</h1>
<p>跟拟合类似，对横截面数据进行回归。</p>
<p>一元线性回归，一般称 <span class="math inline">\(y_i=\beta_0+\beta_1x_i+\mu_i\)</span> 添加残差。</p>
<p>自变量和因变量可通过变量转化变成线性模型，<span class="math inline">\(lny_i=\beta_0+\beta_1\ln{x_i}+\mu_i\)</span>, <span class="math inline">\(y_i=\beta_0+\beta_1x_i+\beta_2x_i^2+\mu_i\)</span></p>
<p>使用线性回归之前，需要对数据进行预处理。</p>
<h2 id="回归系数">回归系数</h2>
<p><span class="math inline">\(y_i=\beta_0+\beta_1x_i+\mu_i\)</span>， 称 <span class="math inline">\(\beta_0, \beta_1\)</span> 为回归系数。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162439941.png" /></p>
<h2 id="虚拟变量">虚拟变量</h2>
<p>自变量中有定性变量，例如性别、地域，在回归中 <span class="math inline">\(y_i = \beta_0 + \beta_1x_{1i} + ... +\delta_0d_0+...+\mu_i\)</span></p>
<p>变量 <span class="math inline">\(d_i\)</span> 取 0 或 1</p>
<p>避免完全 <strong>多重共线性</strong> 的影响，引入虚拟变量的个数一般是分类数减1。</p>
<h2 id="假定满足">假定满足</h2>
<p>回归模型满足 4 个假定：</p>
<p>假定1：线性假定，因变量与自变量存在线性关系</p>
<p>假定2：严格外生性，所有的自变量跟扰动项不相关，保证估计出来的回归系数无偏且一致。</p>
<p>假定3：完全多重无关性，保证能估计出来，自变量满足列满秩，<span class="math inline">\(X&#39;X\)</span> 可逆。</p>
<p>假定4：球型干扰项，同方差，无自相关，<span class="math inline">\(E(\xi_i\xi_j|x) = 0\)</span>， <span class="math inline">\(\xi\)</span> 为扰动项。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423164647820.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165346306.png" /></p>
<h3 id="内生性">内生性</h3>
<p>就是由尚未添加的变量，该变量既跟 y 有关，也跟已添加的自变量有关。</p>
<figure>
<img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162618842.png" alt="image-20210422162618842" /><figcaption>image-20210422162618842</figcaption>
</figure>
<p>即 <span class="math inline">\(u_i\)</span> 其实包含其他相关变量影响，导致估计不准确。</p>
<p>再以一个例子为例：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422162842676.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 蒙特卡洛模拟：内生性会造成回归系数的巨大误差</span></span><br><span class="line">times = <span class="number">300</span>; <span class="comment">% 蒙特卡洛的次数</span></span><br><span class="line">R = <span class="built_in">zeros</span>(times, <span class="number">1</span>);  <span class="comment">% 用来储存扰动项 u和x1 的相关系数</span></span><br><span class="line">K = <span class="built_in">zeros</span>(times, <span class="number">1</span>);  <span class="comment">% 用来储存遗漏了x2之后，只用y对x1回归得到的回归系数 k</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: times</span><br><span class="line">    n = <span class="number">30</span>;  <span class="comment">% 样本数据量为n</span></span><br><span class="line">    x1 = <span class="number">-10</span> + <span class="built_in">rand</span>(n, <span class="number">1</span>) * <span class="number">20</span>;   <span class="comment">% x1在-10和10上均匀分布，大小为30*1</span></span><br><span class="line">    u1 = normrnd(<span class="number">0</span>, <span class="number">5</span>, n, <span class="number">1</span>) - <span class="built_in">rand</span>(n, <span class="number">1</span>);  <span class="comment">% 随机生成一组符合正态分布的随机数</span></span><br><span class="line">    x2 = <span class="number">0.3</span> * x1 + u1;   <span class="comment">% x2与x1的相关性不确定，随机生成x2</span></span><br><span class="line">    u = normrnd(<span class="number">0</span>, <span class="number">1</span>, n, <span class="number">1</span>);  <span class="comment">% 扰动项u服从标准正态分布</span></span><br><span class="line">    y = <span class="number">0.5</span> + <span class="number">2</span> * x1 + <span class="number">5</span> * x2 + u;  <span class="comment">% 构造y</span></span><br><span class="line">    <span class="comment">% 最小二乘法估计出来的k y=kx+b</span></span><br><span class="line">    k = (n * sum(x1 .* y)-sum(x1) * sum(y))/(n * sum(x1 .* x1)-sum(x1)* sum(x1)); </span><br><span class="line">    K(<span class="built_in">i</span>) = k;</span><br><span class="line">    u = <span class="number">5</span> * x2 + u;  <span class="comment">%% 因为我们回归中忽略了 5*x2，所以扰动项要加上5*x2 （实际扰动存在内生性）</span></span><br><span class="line">    r = corrcoef(x1, u);  <span class="comment">% 2*2的相关系数矩阵 0说明不相关</span></span><br><span class="line">    R(<span class="built_in">i</span>) = r(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">plot</span>(R, K, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&quot;x_1和u&#x27;的相关系数&quot;</span>)</span><br><span class="line">ylabel(<span class="string">&quot;k的估计值&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>无内生性要求所有 <strong>解释变量（X）</strong> 跟 <strong>扰动项</strong> 不相关，确保其全部外生比较困难，但可以弱化此条件。</p>
<p>将解释变量分为核心解释变量和控制变量两类：</p>
<ul>
<li><strong>核心解释变量</strong>：我们最感兴趣的变量，因此我们特别希望得到对其系数的一致估计（当样本容量无限增大时，收敛于待估计参数的真值）</li>
<li><strong>控制变量</strong>：我们可能对于这些变量本身并无太大兴趣；而之所以把它们也放入回归方程，主要是为了“控制住”那些对被解释变量有影响的遗漏因素。</li>
</ul>
<p>在实际应用中，我们只要保证核心解释变量与𝝁不相关即可 （要求确保相关系数为0）。</p>
<h3 id="多重共线性">多重共线性</h3>
<p>某一解释变量可以由其他解释变量解释。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423141516797.png" /></p>
<h4 id="假设检验">假设检验</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423141902121.png" /></p>
<h4 id="解决方法">解决方法</h4>
<p>如果发现存在多重共线性，可以采取以下处理方法：</p>
<ol type="1">
<li>如果不关心具体的 <strong>回归系数</strong>，而只关心 <strong>整个方程</strong> 预测被解释变量的能力，则通常可以不必理会多重共线性（多重共线性的主要后果是使得对单个变量的贡献估计不准，但所有变量的整体效应仍可以较准确地估计）。</li>
<li>关心具体的回归系数时，如果多重共线性并不影响所关心变量的 <strong>显著性</strong>，那么也可以不必理会；否则，需要增大样本容量，剔除导致严重共线性的变量（可能会有内生性的影响），或修改模型。</li>
</ol>
<h3 id="扰动项">扰动项</h3>
<p>在之前的回归分析中，我们都默认了扰动项 <span class="math inline">\(\mu_i\)</span> 是球型扰动项。</p>
<p>球型扰动项：满足 <strong>同方差</strong> 和 <strong>无自相关</strong> 两个条件。</p>
<p>横截面数据容易出现 <em>异方差</em> 的问题，时间序列数据容易出现 <em>自相关</em> 的问题。</p>
<h4 id="异方差">异方差</h4>
<p>数据分布极度不平衡，如图示。<span class="math inline">\(OLS\)</span> 普通最小二乘法。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423140237418.png" /></p>
<h5 id="假设检验-1">假设检验</h5>
<p>BP 检验或者怀特检验，原假设，扰动项不存在异方差， P 值小于0.05，如果在95%的置信水平下拒绝原假设，即我们认为扰动项存在异方差。</p>
<p>使用 Stata:</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 回归结束后使用</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span>, rhs iid</span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">imtest</span>, white</span><br></pre></td></tr></table></figure>
<h5 id="解决方法-1">解决方法</h5>
<ol type="1">
<li>使用OLS + 稳健的标准误，如果发现存在异方差，一种处理方法是，仍然进行OLS 回归，但使用稳健标准误。这是最简单，也是目前通用的方法。只要样本容量较大，即使在异方差的情况下，若使用稳健标准误，则所有参数估计、假设检验均可照常进行。</li>
<li>广义最小二乘法GLS，缺点：只能用样本数据来估计，这样得到的结果不稳健，存在偶然性。</li>
</ol>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">regress</span> y x1 x2 ... xk, robust</span><br></pre></td></tr></table></figure>
<h2 id="逐步回归">逐步回归</h2>
<p><strong>向前逐步回归</strong>：将自变量逐个引入模型，每引入一个自变量后都要进行检验，显著时才加入回归模型。（缺点：随着以后其他自变量的引入，原来显著的自变量也可能又变为不显著了，但是，并没有将其及时从回归方程中剔除掉。）</p>
<p><strong>向后逐步回归</strong>：先将所有变量均放入模型，之后尝试将其中一个自变量从模型中剔除，看整个模型解释因变量的变异是否有显著变化，之后将最没有解释力的那个自变量剔除；此过程不断迭代，直到没有自变量符合剔除的条件。（缺点：计算量大）</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stat 使用前需要剔除多重共线性</span></span><br><span class="line"><span class="keyword">stepwise</span> <span class="keyword">regress</span> y x1 x2 ... xk, pe(0.05)</span><br><span class="line"><span class="keyword">stepwise</span> <span class="keyword">regress</span> y x1 x2 ... xk, <span class="keyword">pr</span>(0.05)</span><br></pre></td></tr></table></figure>
<h2 id="回归模型解释">回归模型解释</h2>
<p>思考模型 <span class="math inline">\(y_i=\beta_0+\beta_1\ln{x_i}\)</span> 怎么解释？</p>
<p>伍德里奇的《计量经济学导论，现代观点》有详细的论述：</p>
<p>取对数意味着原被解释变量对解释变量的 <strong>弹性</strong>，即百分比的变化而不是数值的变化。取对数有一些经验法则：</p>
<p>取对数的好处：（1）减弱数据的异方差性（2）如果变量本身不符合正态分布，取了对数后可能渐近服从正态分布（3）模型形式的需要，让模型具有经济学意义。</p>
<ol type="1">
<li>与市场价值相关的，例如，价格、销售额、工资等都可以取对数</li>
<li>以年度量的变量，如受教育年限、工作经历等通常不取对数</li>
<li>比例变量，如失业率、参与率等，两者均可；</li>
<li>变量取值必须是非负数，如果包含0，则可以对 y 取对数 ln(1+y)</li>
</ol>
<p>取对数的好处：</p>
<ol type="1">
<li>减弱数据的 <strong>异方差性</strong></li>
<li>如果变量本身不符合正态分布，取了对数后可能渐近服从正态分布</li>
<li>模型形式的需要，让模型具有经济学意义</li>
</ol>
<p>四类模型回归系数的解释：</p>
<ol type="1">
<li>一元线性回归：𝑦 = 𝑎 + 𝑏𝑥+ 𝜇，x 每增加 1 个单位，y 平均变化 b 个单位</li>
<li>双对数模型：𝑙𝑛𝑦= 𝑎+ 𝑏𝑙𝑛𝑥+ 𝜇，x 每增加 1%，y 平均变化b%</li>
<li>半对数模型：𝑦 = 𝑎 + 𝑏𝑙𝑛𝑥+ 𝜇，x 每增加 1%，y 平均变化 b/100 个单位</li>
<li>半对数模型：𝑙𝑛𝑦 = 𝑎+ 𝑏𝑥+ 𝜇，x 每增加 1 个单位，y 平均变化 (100b)%</li>
</ol>
<h2 id="回归评价">回归评价</h2>
<p>预测型回归一般才会更看重 <span class="math inline">\(R^2\)</span>。</p>
<p>解释型回归更多的关注模型整体 <strong>显著性</strong> 即可。</p>
<p>可以对模型进行调整，例如对数据取对数或者平方后再进行回归.</p>
<p>数据的分布极度不均匀，可能会导致 <span class="math inline">\(R^2\)</span> 较低。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423145809163.png" /></p>
<p>在对 <strong>显著</strong> 的回归系数评价时，更为精准的研究影响评价量的重要因素（去除量纲的影响），我们可考虑使用 <strong>标准化</strong> 回归系数，标准化系数的绝对值越大，说明对因变量的影响就越大。</p>
<p>要先说明在 <em>F 检验</em> 下回归效应显著，然后讲解各个回归系数。</p>
<p><strong>某些错误的分析做法：</strong></p>
<p>不可先对变量进行归一化，否则不好解释或有不好的影响。</p>
<p>不要随便对模型变量（包含虚拟变量）复杂组合，否则不好解释。</p>
<h2 id="stata-使用">Stata 使用</h2>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import excel <span class="string">&quot;课堂中讲解的奶粉数据.xlsx&quot;</span>, sheet(<span class="string">&quot;Sheet1&quot;</span>) firstrow</span><br><span class="line"><span class="comment">// 定量变量的描述性统计</span></span><br><span class="line"><span class="keyword">summarize</span> 团购价元 评价量 商品毛重kg</span><br><span class="line"><span class="comment">// 定性变量的频数分布，并得到相应字母开头的虚拟变量</span></span><br><span class="line"><span class="keyword">tabulate</span> 配方 ,<span class="keyword">gen</span>(A)</span><br><span class="line"><span class="keyword">tabulate</span> 奶源产地 ,<span class="keyword">gen</span>(B)</span><br><span class="line"><span class="keyword">tabulate</span> 国产或进口 ,<span class="keyword">gen</span>(C)</span><br><span class="line"><span class="keyword">tabulate</span> 适用年龄岁 ,<span class="keyword">gen</span>(<span class="keyword">D</span>)</span><br><span class="line"><span class="keyword">tabulate</span> 包装单位 ,<span class="keyword">gen</span>(<span class="keyword">E</span>)</span><br><span class="line"><span class="keyword">tabulate</span> 分类 ,<span class="keyword">gen</span>(F)</span><br><span class="line"><span class="keyword">tabulate</span> 段位 ,<span class="keyword">gen</span>(<span class="keyword">G</span>)</span><br><span class="line"><span class="comment">// 下面进行回归</span></span><br><span class="line"><span class="keyword">regress</span> 评价量 团购价元 商品毛重kg</span><br><span class="line"><span class="comment">// 得到标准化回归系数</span></span><br><span class="line"><span class="keyword">regress</span> 评价量 团购价元 商品毛重kg, b</span><br><span class="line"><span class="comment">// 画出残差图</span></span><br><span class="line"><span class="keyword">regress</span> 评价量 团购价元 商品毛重kg A1 A2 A3 B1 B2 B3 B4 B5 B6 B7 B8 B9 C1 C2 D1 D2 D3 D4 D5 E1 E2 E3 E4 F1 F2 G1 G2 G3 G4</span><br><span class="line"><span class="comment">// 残差与拟合值的散点图</span></span><br><span class="line"><span class="keyword">rvfplot</span> </span><br><span class="line"><span class="comment">// 残差与自变量团购价的散点图</span></span><br><span class="line"><span class="keyword">rvpplot</span>  团购价元</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为什么评价量的拟合值会出现负数？</span></span><br><span class="line"><span class="comment">// 描述性统计并给出分位数对应的数值</span></span><br><span class="line"><span class="keyword">summarize</span> 评价量, <span class="keyword">d</span></span><br><span class="line"><span class="comment">// 作评价量的概率密度估计图</span></span><br><span class="line"><span class="keyword">kdensity</span> 评价量</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异方差BP检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">hettest</span> ,rhs iid</span><br><span class="line"><span class="comment">// 异方差怀特检验</span></span><br><span class="line"><span class="keyword">estat</span> <span class="keyword">imtest</span>,white</span><br><span class="line"><span class="comment">// 使用OLS + 稳健的标准误</span></span><br><span class="line"><span class="keyword">regress</span> 评价量 团购价元 商品毛重kg A1 A2 A3 B1 B2 B3 B4 B5 B6 B7 B8 B9 C1 C2 D1 D2 D3 D4 D5 E1 E2 E3 E4 F1 F2 G1 G2 G3 G4, r</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算VIF</span></span><br><span class="line"><span class="keyword">estat</span>  <span class="keyword">vif</span></span><br></pre></td></tr></table></figure>
<h1 id="岭回归-lasso-回归">岭回归 / lasso 回归</h1>
<p>使用软件：Stata。</p>
<p>主要是为了解决 <strong>多重共线性</strong> 的问题。</p>
<p>岭回归和 lasso 回归在 OLS 回归模型的损失函数上加上了不同的惩罚项，该惩罚项由 <strong>回归系数的函数</strong> 构成：</p>
<ul>
<li><p>一方面，加入的惩罚项能够识别出模型中不重要的变量，对模型起到简化作用，可以看作逐步回归法的升级版</p></li>
<li><p>另一方面，加入的惩罚项能够让模型变得 <strong>可估计</strong></p></li>
</ul>
<h2 id="岭回归">岭回归</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165603084.png" /></p>
<p>所以选择不同 <span class="math inline">\(\lambda\)</span> 会得出不同的回归系数，选择 <span class="math inline">\(\lambda\)</span> 的方法：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165909057.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423165933033.png" /></p>
<p>最小化均方预测误差方法，取不同的 <span class="math inline">\(\lambda\)</span> 然后多次进行 K 折交叉验证，使得整个样本的 MSPE （均方预测误差）最小。</p>
<h2 id="lasso-回归">lasso 回归</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210423170638310.png" /></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意：这里自变量的量纲相同所以不用标准化，如果需要标准化，那么可以借助Matlab的zscore函数，或者直接使用SPSS（分析-描述统计-描述：在描述列表的方框左下角，看到“将标准化得分另存为变量（Z）之后点击打勾，然后确定。）</span></span><br><span class="line"><span class="comment">// Stata一次只能标准化一个变量，例如： egen Y = std(单产)  这个代码就表示将单产标准化，得到的变量记为Y</span></span><br><span class="line">cvlasso 单产 种子费 化肥费 农药费 机械费 灌溉费, lopt seed(520) <span class="comment">// seed 不同种子</span></span><br></pre></td></tr></table></figure>
<p>stata 会给出各 <span class="math inline">\(\lambda\)</span> 的计算结果，以及提出 0 系数后的回归结果。</p>
<h2 id="何时使用">何时使用</h2>
<p>最一般的OLS对数据进行回归，然后计算方差膨胀因子VIF，如果 VIF &gt;10 则说明存在多重共线性的问题，此时我们需要对变量进行筛选。</p>
<h1 id="bp-神经算法">BP 神经算法</h1>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429162305389.png" /></p>
<p>BP 反向传播，能够根据误差再去调整差值。</p>
<p>神经网络的参数跟层数还有各样本输入特征值的数量密切相关，而且可以用来训练样本少而特征值多的数据集。</p>
<p>效果不错，相当万金油，但是具体解释麻烦，<strong>简单数据集</strong> 最好还是用其他模型。</p>
<p>使用软件：Matlab。</p>
<h2 id="matlab-使用">Matlab 使用</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163406220.png" /></p>
<h3 id="训练">训练</h3>
<p>设置数据集比例：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163156212.png" /></p>
<p>训练算法有以下 3 种：</p>
<ul>
<li><p>Levenberg–Marquardt algorithm：能提供数非线性最小化（局部最小）的数值解，速度最快</p></li>
<li><p>Scaled Conjugate Gradient</p></li>
<li><p>Bayesian‐regularization：速度最慢，收敛次数多，拟合效果最好</p></li>
</ul>
<p>一般我们还可以主动把数据集分割开，用这 3 种训练算法算出后再看效果。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163752681.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163818936.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210429163935237.png" /></p>
<h3 id="预测">预测</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">load data_Octane.mat</span><br><span class="line">nftool</span><br><span class="line"><span class="comment">% 根据训练出来的网络 net 预测</span></span><br><span class="line">sim(net, new_X(<span class="number">1</span>,:)&#x27;)</span><br><span class="line"></span><br><span class="line">predict_y = <span class="built_in">zeros</span>(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: <span class="number">10</span></span><br><span class="line">    result = sim(net, new_X(<span class="built_in">i</span>,:)&#x27;);</span><br><span class="line">    predict_y(<span class="built_in">i</span>) = result;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;预测值为：&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(predict_y)</span><br></pre></td></tr></table></figure>
<h1 id="逻辑回归">逻辑回归</h1>
<p>又称 Logistic 回归，由于对已知数据分类，详见分类模型。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%92%99%E7%89%B9%E5%8D%A1%E7%BD%97%E6%A8%A1%E6%8B%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%92%99%E7%89%B9%E5%8D%A1%E7%BD%97%E6%A8%A1%E6%8B%9F/" class="post-title-link" itemprop="url">数学建模-蒙特卡罗模拟</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:06 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:06+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="蒙特卡罗模拟">蒙特卡罗模拟</h1>
<p>蒙特卡罗方法又称统计模拟法，是一种随机模拟方法，以概率和统计理论方法为基础的一种计算方法，是使用随机数（或更常⻅的伪随机数）来解决很多计算问题的方法。将所求解的问题同一定的概率模型相联系，用电子计算机实现统计模拟或抽样，以获得问题的近似解。</p>
<p>由大数定理可知，当样本容量足够大时，事件的发生频率即为其概率。</p>
<h2 id="例题1投针实验">例题1：投针实验</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210424105525942.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">l = <span class="number">0.520</span>; <span class="comment">% 针的长度</span></span><br><span class="line">a = <span class="number">1.314</span>; <span class="comment">% 宽度距离 （大于针的长度 l 即可）</span></span><br><span class="line">n = <span class="number">1000000</span>; <span class="comment">% 做 n 次投针实验</span></span><br><span class="line">m = <span class="number">0</span>; <span class="comment">% 与平行线相交的次数</span></span><br><span class="line">x = <span class="built_in">rand</span>(<span class="number">1</span>, n) * a / <span class="number">2</span>; <span class="comment">% 服从均匀分布生成，扔针的距离是随机的，x 代表针的中点到最近平行线的距离</span></span><br><span class="line">phi = <span class="built_in">rand</span>(<span class="number">1</span>, n) * <span class="built_in">pi</span>; <span class="comment">% 假设模拟真实投针，扔针的角度是随机的</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    <span class="keyword">if</span> x(<span class="built_in">i</span>) &lt;= l / <span class="number">2</span> * <span class="built_in">sin</span>(phi(<span class="built_in">i</span>))</span><br><span class="line">        m = m + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">p = m / n;</span><br><span class="line">mypi = (<span class="number">2</span> * l) / (a * p); <span class="comment">% 根据公式得我们所计算的 pi</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;蒙特卡罗方法得到pi为：&#x27;</span> num2str(mypi)])</span><br><span class="line"><span class="comment">% 可以进行多次实验再求平均</span></span><br></pre></td></tr></table></figure>
<h2 id="例题2三门问题">例题2：三门问题</h2>
<p>你参加一档电视节目，节目组提供了ABC三扇⻔，主持人告诉你，其中一扇⻔后边有辆汽⻋，其它两扇⻔后是空的。假如你选择了B⻔，这时，主持人打开了C⻔，让你看到C⻔后什么都没有，然后问你要不要改选A⻔？</p>
<p>本题问题得实质是因为概率空间不同。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">100000</span>; <span class="comment">% 模拟次数</span></span><br><span class="line">a = <span class="number">0</span>; <span class="comment">% 不改变主意时赢得汽车的次数</span></span><br><span class="line">b = <span class="number">0</span>; <span class="comment">% 改变主意时赢得汽车的次数</span></span><br><span class="line">c = <span class="number">0</span>; <span class="comment">% 失败的次数</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    x = randi([<span class="number">1</span> <span class="number">3</span>]);</span><br><span class="line">    y = randi([<span class="number">1</span> <span class="number">3</span>]); <span class="comment">% 随机生成一个 1-3 的整数</span></span><br><span class="line">    change = randi([<span class="number">0</span>, <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> x == y</span><br><span class="line">        <span class="keyword">if</span> change == <span class="number">0</span></span><br><span class="line">            a = a + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            c = c + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span> change == <span class="number">0</span></span><br><span class="line">            c = c + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            b = b + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;蒙特卡罗方法得到的不改变主意时的获奖概率为：&#x27;</span> num2str(a/n)])</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;蒙特卡罗方法得到的改变主意时的获奖概率为：&#x27;</span> num2str(b/n)])</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;蒙特卡罗方法得到的没有获奖的概率为：&#x27;</span> num2str(c/n)])</span><br></pre></td></tr></table></figure>
<h2 id="例题3排队问题">例题3：排队问题</h2>
<p>假设某银行工作时间只有一个服务窗口，工作人员只能逐个的接待顾客。当来的顾客较多时，一部分顾客就需要排队等待。</p>
<p>假设：1) 顾客到来的间隔时间服从参数为0.1的指数分布 2) 每个顾客的服务时间服从均值为10，方差为4的正态分布(单位为分钟，若服务时间小于1分钟，则按1分钟计算) 3) 排队按先到先服务的规则，且不限制队伍的⻓度，每天工作时⻓为8小时。</p>
<p>试回答下面的问题：1) 模拟1个工作日，在这个工作日共接待了多少客户，客户平均等待的时间为多少? 2) 模拟100个工作日，计算出平均每日接待客户的个数以及每日客户的平均等待时⻓。</p>
<p>指数分布，符合自然界使用寿命长度，参数为 <span class="math inline">\(\lambda\)</span>, 均值为 <span class="math inline">\(1/\lambda\)</span></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 问题1</span></span><br><span class="line">tic <span class="comment">% 计算时间</span></span><br><span class="line"><span class="built_in">i</span> = <span class="number">1</span>; <span class="comment">% 第 i 个客户</span></span><br><span class="line">w = <span class="number">0</span>; <span class="comment">% 等待时间总和</span></span><br><span class="line">x(<span class="number">1</span>) = exprnd(<span class="number">10</span>); <span class="comment">% 第0个客户和第1个客户到达时间间隔</span></span><br><span class="line">c(<span class="number">1</span>) = x(<span class="number">1</span>);</span><br><span class="line">b(<span class="number">1</span>) = c(<span class="number">1</span>); <span class="comment">% 开始服务时间</span></span><br><span class="line"><span class="keyword">while</span> b(<span class="built_in">i</span>) &lt;= <span class="number">480</span></span><br><span class="line">    y(<span class="built_in">i</span>) = normrnd(<span class="number">10</span>, <span class="number">2</span>) <span class="comment">% 服从均值10，方差4的正态分布的服务时间</span></span><br><span class="line">    <span class="keyword">if</span> y(<span class="built_in">i</span>) &lt; <span class="number">1</span></span><br><span class="line">        y(<span class="built_in">i</span>) = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    e(<span class="built_in">i</span>) = b(<span class="built_in">i</span>) + y(<span class="built_in">i</span>);</span><br><span class="line">    wait(<span class="built_in">i</span>) = b(<span class="built_in">i</span>) - c(<span class="built_in">i</span>); <span class="comment">%　开始服务时间减去到达时间</span></span><br><span class="line">    w = w + wait(<span class="built_in">i</span>);</span><br><span class="line">    <span class="built_in">i</span>　＝　<span class="built_in">i</span> + <span class="number">1</span>;</span><br><span class="line">    x(<span class="built_in">i</span>) = exprnd(<span class="number">10</span>);</span><br><span class="line">    c(<span class="built_in">i</span>) = c(<span class="built_in">i</span><span class="number">-1</span>) + x(<span class="built_in">i</span>);</span><br><span class="line">    b(<span class="built_in">i</span>) = <span class="built_in">max</span>(c(<span class="built_in">i</span>), e(<span class="built_in">i</span><span class="number">-1</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">n = <span class="built_in">i</span> - <span class="number">1</span>; <span class="comment">% 共服务的人的个数</span></span><br><span class="line">t = w / n;</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;银行一天8小时一共服务的客户人数为: &#x27;</span> num2str(n)])</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;客户的平均等待时间为: &#x27;</span> num2str(t)])</span><br><span class="line">toc</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 问题2</span></span><br><span class="line">day = <span class="number">100</span></span><br><span class="line">n = <span class="built_in">zeros</span>(day, <span class="number">1</span>);</span><br><span class="line">t = <span class="built_in">zeros</span>(day, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> k = <span class="number">1</span>:day</span><br><span class="line">    <span class="built_in">i</span> = <span class="number">1</span>;</span><br><span class="line">    w = <span class="number">0</span>;</span><br><span class="line">    x(<span class="number">1</span>) = exprnd(<span class="number">10</span>);</span><br><span class="line">    c(<span class="number">1</span>) = x(<span class="number">1</span>);</span><br><span class="line">    b(<span class="number">1</span>) = c(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> b(<span class="built_in">i</span>) &lt;= <span class="number">480</span></span><br><span class="line">        y(<span class="built_in">i</span>) = normrnd(<span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> y(<span class="built_in">i</span>) &lt; <span class="number">1</span></span><br><span class="line">            y(<span class="built_in">i</span>) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        e(<span class="built_in">i</span>) = b(<span class="built_in">i</span>) + y(<span class="built_in">i</span>);</span><br><span class="line">        wait(<span class="built_in">i</span>) = b(<span class="built_in">i</span>) - c(<span class="built_in">i</span>);</span><br><span class="line">        w = w + wait(<span class="built_in">i</span>);</span><br><span class="line">        <span class="built_in">i</span> = <span class="built_in">i</span> + <span class="number">1</span>;</span><br><span class="line">        x(<span class="built_in">i</span>) = exprnd(<span class="number">10</span>);</span><br><span class="line">        c(<span class="built_in">i</span>) = c(<span class="built_in">i</span><span class="number">-1</span>) + x(<span class="built_in">i</span>);</span><br><span class="line">        b(<span class="built_in">i</span>) = <span class="built_in">max</span>(c(<span class="built_in">i</span>), e(<span class="built_in">i</span><span class="number">-1</span>));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    n(k) = <span class="built_in">i</span> - <span class="number">1</span>;</span><br><span class="line">    t(k) = w / n(k);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([num2str(day) <span class="string">&#x27;个工作日中，银行每日平均服务的客户人数为: &#x27;</span> num2str(<span class="built_in">mean</span>(n))])</span><br><span class="line"><span class="built_in">disp</span>([num2str(day) <span class="string">&#x27;个工作日中，银行每日客户的平均等待时间为: &#x27;</span> num2str(<span class="built_in">mean</span>(t))])</span><br></pre></td></tr></table></figure>
<h2 id="例题4有约束的非线性规划问题">例题4：有约束的非线性规划问题</h2>
<p>取值限定，随机取值</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210424114201566.png" /></p>
<p>线性规划问题可有数学方法，找到一个确定的解。</p>
<p>非线性规划往往只能找到局部最优解。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">1000000</span>;</span><br><span class="line">x1 = unifrnd(<span class="number">20</span>, <span class="number">30</span>, n, <span class="number">1</span>); <span class="comment">%　在 [20 30] 内均匀分布的随机数</span></span><br><span class="line">x2 = x1 - <span class="number">10</span>;</span><br><span class="line">x3 = unifrnd(<span class="number">-10</span>, <span class="number">16</span>, n, <span class="number">1</span>);</span><br><span class="line">fmax = -<span class="built_in">inf</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    x = [x1(<span class="built_in">i</span>) x2(<span class="built_in">i</span>) x3(<span class="built_in">i</span>)];</span><br><span class="line">    <span class="keyword">if</span> (-x(<span class="number">1</span>) + <span class="number">2</span>*x(<span class="number">2</span>) + <span class="number">2</span>*x(<span class="number">3</span>) &gt;= <span class="number">0</span>) &amp; (x(<span class="number">1</span>) + <span class="number">2</span>*x(<span class="number">2</span>) + <span class="number">2</span>*x(<span class="number">3</span>) &lt;= <span class="number">72</span>)</span><br><span class="line">        result = x(<span class="number">1</span>) * x(<span class="number">2</span>) * x(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span> result &gt; fmax</span><br><span class="line">            fmax = result;</span><br><span class="line">            X = x;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>(strcat(<span class="string">&#x27;蒙特卡罗模拟得到的最大值为&#x27;</span> num2str(fmax)))</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最大值处x1 x2 x3的取值为：&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(X)</span><br><span class="line"><span class="comment">% 再缩小范围重新模拟得到更加精确的取值</span></span><br></pre></td></tr></table></figure>
<h2 id="例题5买书问题">例题5：买书问题</h2>
<p>取值限定，随机取值</p>
<p>0-1 规划问题（非背包问题限制）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210424114042207.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">min_money = +Inf;</span><br><span class="line">min_result = randi([<span class="number">1</span>, <span class="number">6</span>], <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">n = <span class="number">100000</span>;</span><br><span class="line">M = [</span><br><span class="line">    <span class="number">18</span>  <span class="number">39</span>  <span class="number">29</span>  <span class="number">48</span>	<span class="number">59</span></span><br><span class="line">    <span class="number">24</span>	<span class="number">45</span>	<span class="number">23</span>	<span class="number">54</span>	<span class="number">44</span></span><br><span class="line">    <span class="number">22</span>	<span class="number">45</span>	<span class="number">23</span>	<span class="number">53</span>	<span class="number">53</span></span><br><span class="line">    <span class="number">28</span>	<span class="number">47</span>	<span class="number">17</span>	<span class="number">57</span>	<span class="number">47</span></span><br><span class="line">    <span class="number">24</span>	<span class="number">42</span>	<span class="number">24</span>	<span class="number">47</span>	<span class="number">59</span></span><br><span class="line">    <span class="number">27</span>	<span class="number">48</span>	<span class="number">20</span>	<span class="number">55</span>	<span class="number">53</span></span><br><span class="line">];</span><br><span class="line">freight = [<span class="number">10</span> <span class="number">15</span> <span class="number">15</span> <span class="number">10</span> <span class="number">10</span> <span class="number">15</span>];</span><br><span class="line"><span class="keyword">for</span> k = <span class="number">1</span>:n</span><br><span class="line">    result = randi([<span class="number">1</span>, <span class="number">6</span>], <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">    index = unique(result);</span><br><span class="line">    money = sum(freight(index));</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">5</span></span><br><span class="line">        money = money + M(result(<span class="built_in">i</span>), <span class="built_in">i</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> money &lt; min_money</span><br><span class="line">        min_money = money;</span><br><span class="line">        min_result = result;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">min_money</span><br><span class="line">min_result</span><br></pre></td></tr></table></figure>
<h2 id="例题6导弹追踪问题">例题6：导弹追踪问题</h2>
<p>纯模拟问题，设置时间间隔。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210424133305195.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">v = <span class="number">200</span>;</span><br><span class="line">dt = <span class="number">0.0000001</span>;</span><br><span class="line">x = [<span class="number">0</span>, <span class="number">20</span>]; <span class="comment">% 导弹和船的坐标</span></span><br><span class="line">y = [<span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line">t = <span class="number">0</span>; <span class="comment">% 飞行时间</span></span><br><span class="line">d = <span class="number">0</span>; <span class="comment">% 飞行距离</span></span><br><span class="line">m = <span class="built_in">sqrt</span>(<span class="number">2</span>) / <span class="number">2</span>; <span class="comment">% 定为 sin45 常量</span></span><br><span class="line">dd = <span class="built_in">sqrt</span>((x(<span class="number">2</span>) - x(<span class="number">1</span>)) ^ <span class="number">2</span> + (y(<span class="number">2</span>) - y(<span class="number">1</span>)) ^ <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span></span><br><span class="line">    <span class="built_in">plot</span>(x(<span class="built_in">i</span>), y(<span class="built_in">i</span>), <span class="string">&#x27;.k&#x27;</span>, <span class="string">&#x27;MarkerSize&#x27;</span>, <span class="number">1</span>)  <span class="comment">% 画出导弹和B船所在的坐标，点的大小为1，颜色为黑色(k)，用小点表示</span></span><br><span class="line">    grid on</span><br><span class="line">    <span class="built_in">hold</span> on  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">axis([<span class="number">0</span> <span class="number">30</span> <span class="number">0</span> <span class="number">10</span>]) <span class="comment">% 固定x轴的范围为0-30  固定y轴的范围为0-10</span></span><br><span class="line">k = <span class="number">0</span>;  <span class="comment">% 引入一个变量  为了控制画图的速度</span></span><br><span class="line"><span class="keyword">while</span> (dd &gt;= <span class="number">0.001</span>) &#123;</span><br><span class="line">    t = t + dt;</span><br><span class="line">    d = d + <span class="number">3</span> * v * dt;</span><br><span class="line">    x(<span class="number">2</span>) = <span class="number">20</span> + t * v * m;</span><br><span class="line">    y(<span class="number">2</span>) = <span class="number">20</span> + t * v * m;</span><br><span class="line">    dd = <span class="built_in">sqrt</span>((x(<span class="number">2</span>) - x(<span class="number">1</span>)) ^ <span class="number">2</span> + (y(<span class="number">2</span>) - y(<span class="number">1</span>)) ^ <span class="number">2</span>);</span><br><span class="line">    tan_alpha = (y(<span class="number">2</span>) - y(<span class="number">1</span>)) / (x(<span class="number">2</span>) - x(<span class="number">1</span>));</span><br><span class="line">    cos_alpha = <span class="built_in">sqrt</span>(<span class="number">1</span> / (<span class="number">1</span> + tan_alpha ^ <span class="number">2</span>));</span><br><span class="line">    sin_alpha = <span class="built_in">sqrt</span>(<span class="number">1</span> - cos_alpha ^ <span class="number">2</span>);</span><br><span class="line">    x(<span class="number">1</span>) = x(<span class="number">1</span>) + <span class="number">3</span> * v * dt * cos_alpha;</span><br><span class="line">    y(<span class="number">1</span>) = y(<span class="number">1</span>) + <span class="number">3</span> * v * dt * sin_alpha;</span><br><span class="line">    k = k + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">mod</span>(k, <span class="number">500</span>) == <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span></span><br><span class="line">            <span class="built_in">plot</span>(x(<span class="built_in">i</span>), y(<span class="built_in">i</span>), <span class="string">&#x27;.k&#x27;</span>, <span class="string">&#x27;MarkerSize&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">hold</span> on <span class="comment">% 不关闭图形，继续画图</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        pause(<span class="number">0.001</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> d &gt; <span class="number">50</span> </span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;导弹没有击中B船&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> d &lt;= <span class="number">50</span> &amp;&amp; dd &lt; <span class="number">0.001</span> </span><br><span class="line">    	<span class="built_in">disp</span>([<span class="string">&#x27;导弹飞行&#x27;</span> num2str(d) <span class="string">&#x27;单位后击中B船&#x27;</span>])</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;导弹飞行的时间为&#x27;</span> num2str(t*<span class="number">60</span>) <span class="string">&#x27;分钟&#x27;</span>])</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="例题7旅行商问题">例题7：旅行商问题</h2>
<p>取值限定，随机取值，节点数多时难以到达最优结果。</p>
<p>部分优化方案，先运行聚类算法，再运行蒙特卡洛模拟。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210424135533997.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">coord = [</span><br><span class="line">        <span class="number">0.6683</span> <span class="number">0.6195</span> <span class="number">0.4</span> <span class="number">0.2439</span> <span class="number">0.1707</span> <span class="number">0.2293</span> <span class="number">0.5171</span> <span class="number">0.8732</span> <span class="number">0.6878</span> <span class="number">0.8488</span>;</span><br><span class="line">        <span class="number">0.2536</span> <span class="number">0.2634</span> <span class="number">0.4439</span> <span class="number">0.1463</span> <span class="number">0.2293</span> <span class="number">0.761</span>  <span class="number">0.9414</span> <span class="number">0.6536</span> <span class="number">0.5219</span> <span class="number">0.3609</span></span><br><span class="line">  	]&#x27;;</span><br><span class="line">n = <span class="built_in">size</span>(coord, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(coord(:, <span class="number">1</span>),coord(:, <span class="number">2</span>), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    text(coord(<span class="built_in">i</span>, <span class="number">1</span>) + <span class="number">0.01</span>, coord(<span class="built_in">i</span>, <span class="number">2</span>) + <span class="number">0.01</span>, num2str(<span class="built_in">i</span>)) <span class="comment">% 在图上标上城市的编号</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">zeros</span>(n);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>:n  </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">i</span>  </span><br><span class="line">        coord_i = coord(<span class="built_in">i</span>, :);   </span><br><span class="line">        x_i = coord_i(<span class="number">1</span>);     </span><br><span class="line">        y_i = coord_i(<span class="number">2</span>);  <span class="comment">% 城市i的横坐标为x_i，纵坐标为y_i</span></span><br><span class="line">        coord_j = coord(<span class="built_in">j</span>, :);   </span><br><span class="line">        x_j = coord_j(<span class="number">1</span>);     </span><br><span class="line">        y_j = coord_j(<span class="number">2</span>);  <span class="comment">% 城市j的横坐标为x_j，纵坐标为y_j</span></span><br><span class="line">        d(<span class="built_in">i</span>,<span class="built_in">j</span>) = <span class="built_in">sqrt</span>((x_i - x_j) ^ <span class="number">2</span> + (y_i - y_j) ^ <span class="number">2</span>);   <span class="comment">% 计算城市i和j的距离</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">d = d+d&#x27;; <span class="comment">% 矩阵对称</span></span><br><span class="line">min_result = +<span class="built_in">inf</span>;</span><br><span class="line">min_path = [<span class="number">1</span>:n]; </span><br><span class="line">N = <span class="number">10000000</span>; <span class="comment">% 模拟次数</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:N  <span class="comment">% 开始循环</span></span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">    path = randperm(n);  <span class="comment">% 生成一个1-n的随机打乱的序列</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n<span class="number">-1</span> </span><br><span class="line">        result = d(path(<span class="built_in">i</span>), path(<span class="built_in">i</span>+<span class="number">1</span>)) + result;  <span class="comment">% 按照这个序列不断的更新走过的路程这个值</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    result = d(path(<span class="number">1</span>), path(n)) + result;  <span class="comment">% 别忘了加上从最后一个城市返回到最开始那个城市的距离</span></span><br><span class="line">    <span class="keyword">if</span> result &lt; min_result</span><br><span class="line">        min_path = path;</span><br><span class="line">        min_result = result;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">min_result</span><br><span class="line">min_path</span><br><span class="line">min_path = [min_path, min_path(<span class="number">1</span>)];</span><br><span class="line">n = n + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n<span class="number">-1</span> </span><br><span class="line">    <span class="built_in">j</span> = <span class="built_in">i</span> + <span class="number">1</span>;</span><br><span class="line">    coord_i = coord(min_path(<span class="built_in">i</span>), :);   </span><br><span class="line">    x_i = coord_i(<span class="number">1</span>);     </span><br><span class="line">    y_i = coord_i(<span class="number">2</span>); </span><br><span class="line">    coord_j = coord(min_path(<span class="built_in">j</span>), :);   </span><br><span class="line">    x_j = coord_j(<span class="number">1</span>);     </span><br><span class="line">    y_j = coord_j(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">plot</span>([x_i, x_j],[y_i, y_j], <span class="string">&#x27;-&#x27;</span>)    <span class="comment">% 每两个点就作出一条线段，直到所有的城市都走完</span></span><br><span class="line">    pause(<span class="number">0.5</span>)  <span class="comment">% 暂停0.5s再画</span></span><br><span class="line">    <span class="built_in">hold</span> on</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%AF%84%E4%BB%B7%E7%B1%BB%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E8%AF%84%E4%BB%B7%E7%B1%BB%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">数学建模-评价类问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:05 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:05+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="评价类问题">评价类问题</h1>
<p>例如：选择那种方案更好，哪个员工或者运动员更优秀。</p>
<p>评价类问题用打分解决，使用权重对各个对象进行各方面综合打分，各方面的占比为权重，其和为 1。</p>
<p>确定评价体系、形成评价指标：</p>
<ul>
<li>评价的目标是什么（例选择最佳的 xxx）</li>
<li>可选方案有哪些 （题目中给出的各个对象）</li>
<li>评价准则或指标是什么 （根据什么来评价好坏）</li>
</ul>
<p>如果题目没有数据支撑来确定评价准则，需要自己根据背景资料、常识及网上的资料来确定。</p>
<p><strong>直接</strong> 进行权重表格来进行填表会怎么样？</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420141905625.png" /></p>
<p>会导致考虑不周全、重要性程度不相一致，提出一组隐含矛盾的数据。</p>
<h2 id="层次分析法">层次分析法</h2>
<p>先考虑指标与指标之间的关系，进行 <strong>两两比较</strong>。</p>
<p>然后再计算该指标下各个对象进行 <strong>两两比较</strong>，得出相应的权重得分。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420142508201.png" /></p>
<p>如果评价传递之间，出现了矛盾之处：A&gt;B，B&gt;C, C&gt;A，需要将矩阵调整为 <strong>一致矩阵</strong>。</p>
<p><span class="math inline">\(a_{ik} = a_{ij} \times a_{jk}\)</span>，矩阵 各行（各列） 之间成倍数关系。</p>
<p>所以使用判断矩阵求权重之前，必须先进行一致性检验（与一致矩阵是否有太大的差别）。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = [</span><br><span class="line">    <span class="number">1</span> <span class="number">2</span> <span class="number">4</span>;</span><br><span class="line">    <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span> <span class="number">2</span>;</span><br><span class="line">    <span class="number">1</span>/<span class="number">4</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span></span><br><span class="line">]</span><br><span class="line">[V, D] = eig(A) <span class="comment">% 求出特征向量和特征值</span></span><br><span class="line">A * [<span class="number">1</span>; <span class="number">1</span>/<span class="number">2</span>; <span class="number">1</span>/<span class="number">4</span>] - <span class="number">3</span> * [<span class="number">1</span>; <span class="number">1</span>/<span class="number">2</span>; <span class="number">1</span>/<span class="number">4</span>] <span class="comment">% 验证特征值对应的特征向量</span></span><br></pre></td></tr></table></figure>
<p>一致矩阵 只有一个特征值为 <span class="math inline">\(n\)</span> 其余为 0，当 正互反矩阵 非一致时，最大特征值 <span class="math inline">\(\lambda_{max} \gt n\)</span>。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420145055408.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>:<span class="number">1</span>:<span class="number">8</span>]</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(a, <span class="number">2</span>)</span><br><span class="line">    A = [</span><br><span class="line">        <span class="number">1</span> <span class="number">2</span> a(<span class="built_in">i</span>);</span><br><span class="line">        <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span> <span class="number">2</span>;</span><br><span class="line">        <span class="number">1</span>/a(<span class="built_in">i</span>) <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span></span><br><span class="line">    ]</span><br><span class="line">    b = [b <span class="built_in">max</span>(eig(A))]</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">plot</span>(a, b)</span><br></pre></td></tr></table></figure>
<h3 id="一致性检验步骤">一致性检验步骤</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420145549930.png" /></p>
<h3 id="使用判断矩阵计算权重">使用判断矩阵计算权重</h3>
<h4 id="算数平均法">算数平均法</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420150136897.png" /></p>
<h4 id="几何平均法">几何平均法</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420150242875.png" /></p>
<h4 id="特征值法">特征值法</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420150546640.png" /></p>
<h3 id="步骤整合">步骤整合</h3>
<p>再根据各指标计算的权重结果和指标间的比较计算结果，填入权重表中去。（三种方法都试）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420152052224.png" /></p>
<p>计算可使用 Excel 进行计算（按 F4 锁定计算单元格）</p>
<p>计算步骤重述：</p>
<p>第一步：（使用 Visio 等画图）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogblogimage-20210420152430628.png" /></p>
<p>第二步：写出判断矩阵</p>
<p>第三步：进行一致性检验，计算相对权重</p>
<p>第四步：计算得分，排序</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;输入判断矩阵&#x27;</span>)</span><br><span class="line">A = input(<span class="string">&#x27;判断矩阵 A = &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 算数平均法</span></span><br><span class="line">Sum_A = sum(A); <span class="comment">% 按列求和，先归一化</span></span><br><span class="line">n = <span class="built_in">size</span>(A, <span class="number">1</span>);</span><br><span class="line">SUM_A = <span class="built_in">repmat</span>(Sum_A, n, <span class="number">1</span>);</span><br><span class="line">Stand_A = A ./ SUM_A;</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;算数平均法求权重的结果为：&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(sum(Stand_A, <span class="number">2</span>) / n)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 几何平均法</span></span><br><span class="line">Product_A = prod(A, <span class="number">2</span>); <span class="comment">% 按行相乘</span></span><br><span class="line">Product_n_A = Product_A .^ (<span class="number">1</span> / n); <span class="comment">% 开 n 次方</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;几何平均法求权重的结果为：&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(Product_n_A ./ sum(Product_n_A)) <span class="comment">% 再归一化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 特征值法</span></span><br><span class="line">[V, D] = eig(A); <span class="comment">% 特征向量和特征值 D 是特征值对角矩阵</span></span><br><span class="line">Max_eig = <span class="built_in">max</span>(<span class="built_in">max</span>(D));</span><br><span class="line">[r, c] = <span class="built_in">find</span>(D == Max_eig, <span class="number">1</span>); <span class="comment">% find 返回矩阵中前 n 各不为 0 的下标索引</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;特征值法求权重的结果为：&#x27;</span>) </span><br><span class="line"><span class="built_in">disp</span>(V(:, c) ./ sum(V(:, c))) <span class="comment">% 对应列特征向量归一化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 一致性比例计算</span></span><br><span class="line">CI = (Max_eig - n) / (n - <span class="number">1</span>);</span><br><span class="line">RI = [<span class="number">0</span> <span class="number">0</span> <span class="number">0.52</span> <span class="number">0.89</span> <span class="number">1.12</span> <span class="number">1.26</span> <span class="number">1.36</span> <span class="number">1.41</span> <span class="number">1.46</span> <span class="number">1.49</span> <span class="number">1.52</span> <span class="number">1.54</span> <span class="number">1.56</span> <span class="number">1.58</span> <span class="number">1.59</span>];</span><br><span class="line">CR = CI / RI(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> CR &lt; <span class="number">0.10</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;因为CR &lt; 0.10，所以该判断矩阵A的一致性可以接受!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;注意：CR &gt;= 0.10，因此该判断矩阵A需要进行修改!&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="局限性">局限性</h3>
<ol type="1">
<li>决策层（指标） <span class="math inline">\(n\)</span> 不能太多</li>
<li>主观确定决策层数据，如果决策层指标数据已知，可以使用其他更精确的方法</li>
</ol>
<h2 id="优劣解距离法">优劣解距离法</h2>
<p>又称为 Topsis 法。</p>
<p>其利用原始数据的信息，客观反应各评价方案之间的差距。</p>
<p>归一化构造计算评分：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420161550792.png" /></p>
<p>存在极大型指标（效益性）和极小型指标（成本型），需要将所有指标都转化成极大型，对极小型来说，指标正向化最常用 <span class="math inline">\(max-x\)</span></p>
<p>除此之外，指标与指标间存在量纲，需要进行 <strong>标准化处理</strong>。</p>
<p>Tip：</p>
<ul>
<li><p>归一化，数据分布到 [0, 1] 区间或指定区间</p></li>
<li><p>标准化，数据变化到 均值为 0， 标准差为 1 的分布</p></li>
<li><p>中心化，所有数据减去数据的均值</p></li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420162634874.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420162907068.png" /></p>
<p>Topsis 法基本过程为 先将原始数据矩阵统一指标类型（一般正向化处理）得到正向化的矩阵，再对正向化的矩阵进行标准化处理以消除各指标量纲的影响，并找到有限方案中的最优方案和最劣方案，然后分别计算各评价对象与最优方案和最劣方案间的距离，获得各评价对象与最优方案的相对接近程度，以此作为评价优劣的依据。该方法对数据分布及样本含量没有严格限制，数据计算简单易行。</p>
<h3 id="指标正向化">指标正向化</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420163134882.png" /></p>
<h4 id="极小型指标">极小型指标</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420163206835.png" /></p>
<h4 id="中间型指标">中间型指标</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420163303729.png" /></p>
<h4 id="区间型指标">区间型指标</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420163340736.png" /></p>
<h3 id="步骤整合-1">步骤整合</h3>
<p>第一步：将原始矩阵正向化</p>
<p>第二步：正向化矩阵标准化</p>
<p>第三步：计算归一化的得分</p>
<p>可以的话再到 Excel 中去，对得分做一个条状图显示及排序。</p>
<p>Topsis 法还可以跟层次分析法结合，对指标确定权重</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420164035178.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420164101291.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 极小型指标正向化</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[posit_x]</span> = <span class="title">Min2Max</span><span class="params">(x)</span></span></span><br><span class="line">    posit_x = <span class="built_in">max</span>(x) - x;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 中间型指标正向化</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[posit_x]</span> = <span class="title">Mid2Max</span><span class="params">(x, best)</span></span></span><br><span class="line">    M = <span class="built_in">max</span>(<span class="built_in">abs</span>(x - best));</span><br><span class="line">    posit_x = <span class="number">1</span> - <span class="built_in">abs</span>(x - best) / M;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 区间型指标正向化</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[posit_x]</span> = <span class="title">Inter2Max</span><span class="params">(x, a, b)</span></span></span><br><span class="line">    r_x = <span class="built_in">size</span>(x, <span class="number">1</span>);</span><br><span class="line">    M = <span class="built_in">max</span>([a - <span class="built_in">min</span>(x), <span class="built_in">max</span>(x) - b]);</span><br><span class="line">    posit_x = <span class="built_in">zeros</span>(r_x, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:r_x</span><br><span class="line">        <span class="keyword">if</span> x(<span class="built_in">i</span>) &lt; a</span><br><span class="line">            posit_x(<span class="built_in">i</span>) = <span class="number">1</span> - (a - x(<span class="built_in">i</span>)) / M;</span><br><span class="line">        <span class="keyword">elseif</span> x(<span class="built_in">i</span>) &gt; b</span><br><span class="line">            posit_x(<span class="built_in">i</span>) = <span class="number">1</span> - (x(<span class="built_in">i</span>) - b) / M;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            posit_x(<span class="built_in">i</span>) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[posit_x]</span> = <span class="title">Positivization</span><span class="params">(x, type, i)</span></span></span><br><span class="line"><span class="comment">% 输入：</span></span><br><span class="line"><span class="comment">% x：需要正向化处理的指标对应的原始列向量</span></span><br><span class="line"><span class="comment">% type： 指标的类型（1：极小型， 2：中间型， 3：区间型）</span></span><br><span class="line"><span class="comment">% i： 说明正在处理的是原始矩阵中的哪一列</span></span><br><span class="line"><span class="comment">% 输出：</span></span><br><span class="line"><span class="comment">% posit_x：正向化后的列向量</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span>  <span class="comment">%极小型</span></span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列是极小型，正在正向化&#x27;</span>] )</span><br><span class="line">        posit_x = Min2Max(x);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列极小型正向化处理完成&#x27;</span>] )</span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> <span class="built_in">type</span> == <span class="number">2</span>  <span class="comment">%中间型</span></span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列是中间型&#x27;</span>] )</span><br><span class="line">        best = input(<span class="string">&#x27;请输入最佳的那一个值： &#x27;</span>);</span><br><span class="line">        posit_x = Mid2Max(x, best);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列中间型正向化处理完成&#x27;</span>] )</span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">elseif</span> <span class="built_in">type</span> == <span class="number">3</span>  <span class="comment">%区间型</span></span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列是区间型&#x27;</span>] )</span><br><span class="line">        a = input(<span class="string">&#x27;请输入区间的下界： &#x27;</span>);</span><br><span class="line">        b = input(<span class="string">&#x27;请输入区间的上界： &#x27;</span>); </span><br><span class="line">        posit_x = Inter2Max(x,a,b);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;第&#x27;</span> num2str(<span class="built_in">i</span>) <span class="string">&#x27;列区间型正向化处理完成&#x27;</span>] )</span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;~~~~~~~~~~~~~~~~~~~~分界线~~~~~~~~~~~~~~~~~~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;没有这种类型的指标，请检查Type向量中是否有除了1、2、3之外的其他值&#x27;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[lnp]</span> =  <span class="title">mylog</span><span class="params">(p)</span></span></span><br><span class="line">    n = <span class="built_in">length</span>(p);</span><br><span class="line">    lnp = <span class="built_in">zeros</span>(n,<span class="number">1</span>); </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">if</span> p(<span class="built_in">i</span>) == <span class="number">0</span>   <span class="comment">% 如果第i个元素为0 那么返回的第i个结果也为0</span></span><br><span class="line">            lnp(<span class="built_in">i</span>) = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            lnp(<span class="built_in">i</span>) = <span class="built_in">log</span>(p(<span class="built_in">i</span>));  </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[W]</span> = <span class="title">Entropy_Method</span><span class="params">(Z)</span></span></span><br><span class="line"><span class="comment">% 计算有 n 个样本，m 个指标的样本所对应的的熵权</span></span><br><span class="line"><span class="comment">% 输入</span></span><br><span class="line"><span class="comment">% Z ： n * m 的矩阵（要经过正向化和标准化处理，且元素中不存在负数）</span></span><br><span class="line"><span class="comment">% 输出</span></span><br><span class="line"><span class="comment">% W：熵权，1 * m 的行向量</span></span><br><span class="line">    [n, m] = <span class="built_in">size</span>(Z);</span><br><span class="line">    D = <span class="built_in">zeros</span>(<span class="number">1</span>, m);  <span class="comment">% 初始化保存信息效用值的行向量</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:m</span><br><span class="line">        x = Z(:, <span class="built_in">i</span>);  <span class="comment">% 取出第i列的指标</span></span><br><span class="line">        p = x / sum(x);</span><br><span class="line">        <span class="comment">% 注意，p有可能为0，此时计算ln(p)*p时，Matlab会返回NaN，所以这里我们自己定义一个函数</span></span><br><span class="line">        e = -sum(p .* mylog(p)) / <span class="built_in">log</span>(n); <span class="comment">% 计算信息熵</span></span><br><span class="line">        D(<span class="built_in">i</span>) = <span class="number">1</span> - e; <span class="comment">% 信息效用值</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    W = D ./ sum(D);  <span class="comment">% 将信息效用值归一化，得到权重    </span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">load data_water_quality.mat</span><br><span class="line">[n, m] = <span class="built_in">size</span>(X);</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;共有&#x27;</span> num2str(n) <span class="string">&#x27;个评价对象, &#x27;</span> num2str(m) <span class="string">&#x27;个评价指标&#x27;</span>]) </span><br><span class="line">Judge = input([<span class="string">&#x27;这&#x27;</span> num2str(m) <span class="string">&#x27;个指标是否需要经过正向化处理，需要请输入1 ，不需要输入0：  &#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> Judge == <span class="number">1</span></span><br><span class="line">    <span class="comment">% 注意，Position和Type是两个同维度的行向量</span></span><br><span class="line">    Position = input(<span class="string">&#x27;请输入需要正向化处理的指标所在的列，例如第2、3、6三列需要处理，那么你需要输入[2,3,6]： &#x27;</span>);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;请输入需要处理的这些列的指标类型（1：极小型， 2：中间型， 3：区间型）&#x27;</span>)</span><br><span class="line">    Type = input(<span class="string">&#x27;例如：第2列是极小型，第3列是区间型，第6列是中间型，就输入[1,3,2]：&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(Position, <span class="number">2</span>) <span class="comment">%这里需要对这些列分别处理，因此我们需要知道一共要处理的次数，即循环的次数</span></span><br><span class="line">        X(:, Position(<span class="built_in">i</span>)) = Positivization(X(:, Position(<span class="built_in">i</span>)), Type(<span class="built_in">i</span>), Position(<span class="built_in">i</span>));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;正向化后的矩阵 X = &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(X)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&quot;请输入是否需要增加权重向量，需要输入1，不需要输入0&quot;</span>)</span><br><span class="line">Judge = input(<span class="string">&#x27;请输入是否需要增加权重： &#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> Judge == <span class="number">1</span></span><br><span class="line">    Judge = input(<span class="string">&#x27;使用熵权法确定权重请输入1，否则输入0： &#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> Judge == <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> sum(sum(Z &lt; <span class="number">0</span>)) &gt; <span class="number">0</span>   <span class="comment">% 如果之前标准化后的Z矩阵中存在负数，则重新对X进行标准化</span></span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;原来标准化得到的Z矩阵中存在负数，所以需要对X重新标准化&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">                <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:m</span><br><span class="line">                    Z(<span class="built_in">i</span>,<span class="built_in">j</span>) = [X(<span class="built_in">i</span>, <span class="built_in">j</span>) - <span class="built_in">min</span>(X(:, <span class="built_in">j</span>))] / [<span class="built_in">max</span>(X(:, <span class="built_in">j</span>)) - <span class="built_in">min</span>(X(:, <span class="built_in">j</span>))];</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;X重新进行标准化得到的标准化矩阵Z为:  &#x27;</span>)</span><br><span class="line">            <span class="built_in">disp</span>(Z)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        weight = Entropy_Method(Z);</span><br><span class="line">        <span class="built_in">disp</span>(<span class="string">&#x27;熵权法确定的权重为：&#x27;</span>)</span><br><span class="line">        <span class="built_in">disp</span>(weight)</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;如果你有3个指标，你就需要输入3个权重，例如它们分别为0.25,0.25,0.5, 则你需要输入[0.25,0.25,0.5]&#x27;</span>]);</span><br><span class="line">        weight = input([<span class="string">&#x27;你需要输入&#x27;</span> num2str(m) <span class="string">&#x27;个权数。&#x27;</span> <span class="string">&#x27;请以行向量的形式输入这&#x27;</span> num2str(m) <span class="string">&#x27;个权重: &#x27;</span>]);</span><br><span class="line">        OK = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> OK == <span class="number">0</span> </span><br><span class="line">            <span class="comment">% 这里要注意浮点数的运算是不精准的。</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(sum(weight) - <span class="number">1</span>) &lt; <span class="number">0.000001</span> &amp;&amp; <span class="built_in">size</span>(weight, <span class="number">1</span>) == <span class="number">1</span> &amp;&amp; <span class="built_in">size</span>(weight, <span class="number">2</span>) == m   </span><br><span class="line">                OK = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                weight = input(<span class="string">&#x27;输入有误，请重新输入权重行向量: &#x27;</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">   	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    weight = <span class="built_in">ones</span>(<span class="number">1</span>, m) ./ m ; <span class="comment">% 不需要加权重就默认权重都相同，即都为1/m</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 进行标准化</span></span><br><span class="line">Z = X ./ <span class="built_in">repmat</span>(sum(X .* X) .^ <span class="number">0.5</span>, n, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;标准化矩阵 Z = &#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(Z)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 计算与最大值的距离和最小值的距离，并算出得分</span></span><br><span class="line">D_P = sum([(Z - <span class="built_in">repmat</span>(<span class="built_in">max</span>(Z), n, <span class="number">1</span>)) .^ <span class="number">2</span> ], <span class="number">2</span>) .* <span class="built_in">repmat</span>(weight, n, <span class="number">1</span>) ,<span class="number">2</span>) .^ <span class="number">0.5</span>; <span class="comment">% D+</span></span><br><span class="line">D_N = sum([(Z - <span class="built_in">repmat</span>(<span class="built_in">min</span>(Z), n, <span class="number">1</span>)) .^ <span class="number">2</span> ], <span class="number">2</span>) .* <span class="built_in">repmat</span>(weight, n, <span class="number">1</span>) ,<span class="number">2</span>) .^ <span class="number">0.5</span>; <span class="comment">% D-</span></span><br><span class="line">S = D_N ./ (D_P + D_N); </span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最后的得分为：&#x27;</span>)</span><br><span class="line">Stand_S = S / sum(S) <span class="comment">% 最后再进行归一化</span></span><br><span class="line">[sorted_S, index] = <span class="built_in">sort</span>(Stand_S, <span class="string">&#x27;descend&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="熵权法">熵权法</h3>
<p>层次分析法再赋权，主观性太强，客观 = 数据本身就可以告诉我们权重。</p>
<p>指标的 <strong>变异</strong> 程度越小，所反映的信息量也越少，其对应的权值也应该越低。</p>
<p>用指标的标准差来衡量样本的变异程度，指标的标准差越大，其信息熵越小。</p>
<p>越不可能发生的事情，信息量越多；信息熵越大，信息量越小。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420183258315.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420183352485.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420190226782.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 蒙特卡洛模拟：指标的标准差和信息熵成反比</span></span><br><span class="line">n = <span class="number">30</span>;</span><br><span class="line">N = <span class="number">100</span>;</span><br><span class="line">result = <span class="built_in">zeros</span>(N, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:N</span><br><span class="line">    x = <span class="built_in">rand</span>(n, <span class="number">1</span>); <span class="comment">% 随机生成 n 个位于 (0, 1) 区间的样本</span></span><br><span class="line">    p = x / sum(x);</span><br><span class="line">    e = -sum(p .* mylog(p)) / <span class="built_in">log</span>(n);</span><br><span class="line">    sd = std(x); <span class="comment">% 标准差</span></span><br><span class="line">    result(<span class="built_in">i</span>, <span class="number">1</span>) = e;</span><br><span class="line">    result(<span class="built_in">i</span>, <span class="number">2</span>) = sd;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(result(:, <span class="number">1</span>), result(:, <span class="number">2</span>), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;信息熵&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;标准差&#x27;</span>)</span><br><span class="line">[r, p] = corrcoef(result(:, <span class="number">1</span>), result(:, <span class="number">2</span>)) <span class="comment">% 计算相关系数和对应 p 值（相关性检验和假设验证）</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤">步骤</h4>
<p>1）标准化（两种方法）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420183624362.png" /></p>
<p>2）计算 相对熵计算所要用的概率</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420183749023.png" /></p>
<p>3）计算信息熵，计算信息效用值，由此归一化得出每个指标的熵权</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420184205788.png" /></p>
<p>但不是 <strong>所有情况</strong> 都适合使用 熵权法，合适的时候使用。</p>
<h2 id="灰色关联分析">灰色关联分析</h2>
<p>创建虚拟母序列，视为系统行为特征。</p>
<p>计算灰色关联度来作为权重。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420202436009.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">load data_water_quality.mat</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 判断是否需要正向化</span></span><br><span class="line">[n, m] = <span class="built_in">size</span>(X);</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;共有&#x27;</span> num2str(n) <span class="string">&#x27;个评价对象, &#x27;</span> num2str(m) <span class="string">&#x27;个评价指标&#x27;</span>]) </span><br><span class="line">Judge = input([<span class="string">&#x27;这&#x27;</span> num2str(m) <span class="string">&#x27;个指标是否需要经过正向化处理，需要请输入1 ，不需要输入0：  &#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> Judge == <span class="number">1</span></span><br><span class="line">    <span class="comment">% 注意，Position和Type是两个同维度的行向量</span></span><br><span class="line">    Position = input(<span class="string">&#x27;请输入需要正向化处理的指标所在的列，例如第2、3、6三列需要处理，那么你需要输入[2,3,6]： &#x27;</span>);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;请输入需要处理的这些列的指  标类型（1：极小型， 2：中间型， 3：区间型） &#x27;</span>)</span><br><span class="line">    Type = input(<span class="string">&#x27;例如：第2列是极小型，第3列是区间型，第6列是中间型，就输入[1,3,2]：  &#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : <span class="built_in">size</span>(Position, <span class="number">2</span>)</span><br><span class="line">        X(:,Position(<span class="built_in">i</span>)) = Positivization(X(:,Position(<span class="built_in">i</span>)), Type(<span class="built_in">i</span>), Position(<span class="built_in">i</span>));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;正向化后的矩阵 X =  &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(X)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 对正向化后的矩阵进行预处理</span></span><br><span class="line">Mean = <span class="built_in">mean</span>(X);</span><br><span class="line">Z = X ./ <span class="built_in">repmat</span>(Mean, <span class="built_in">size</span>(X,<span class="number">1</span>), <span class="number">1</span>); </span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;预处理后的矩阵为：&#x27;</span>); </span><br><span class="line"><span class="built_in">disp</span>(Z)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 构造母序列和子序列</span></span><br><span class="line">Y = <span class="built_in">max</span>(Z,[],<span class="number">2</span>);  <span class="comment">% 母序列为虚拟的，用每一行的最大值构成的列向量表示母序列（max用法）</span></span><br><span class="line">X = Z; <span class="comment">% 子序列就是预处理后的数据矩阵</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 计算得分</span></span><br><span class="line">absX0_Xi = <span class="built_in">abs</span>(X - <span class="built_in">repmat</span>(Y, <span class="number">1</span>, <span class="built_in">size</span>(X, <span class="number">2</span>)))  <span class="comment">% 计算|X0-Xi|矩阵</span></span><br><span class="line">a = <span class="built_in">min</span>(<span class="built_in">min</span>(absX0_Xi)) <span class="comment">% 计算两级最小差a</span></span><br><span class="line">b = <span class="built_in">max</span>(<span class="built_in">max</span>(absX0_Xi)) <span class="comment">% 计算两级最大差b</span></span><br><span class="line">rho = <span class="number">0.5</span>; <span class="comment">% 分辨系数取0.5</span></span><br><span class="line"><span class="built_in">gamma</span> = (a + rho*b) ./ (absX0_Xi  + rho * b); <span class="comment">% 计算子序列中各个指标与母序列的关联系数</span></span><br><span class="line">weight = <span class="built_in">mean</span>(<span class="built_in">gamma</span>) / sum(<span class="built_in">mean</span>(<span class="built_in">gamma</span>)); <span class="comment">% 利用子序列中各个指标的灰色关联度计算权重</span></span><br><span class="line">score = sum(X .* <span class="built_in">repmat</span>(weight, <span class="built_in">size</span>(X,<span class="number">1</span>), <span class="number">1</span>), <span class="number">2</span>); <span class="comment">% 未归一化的得分</span></span><br><span class="line">Stand_S = score / sum(score);  <span class="comment">% 归一化后的得分</span></span><br><span class="line">[sorted_S, index] = <span class="built_in">sort</span>(Stand_S, <span class="string">&#x27;descend&#x27;</span>) <span class="comment">% 进行排序</span></span><br></pre></td></tr></table></figure>
<h2 id="模糊综合评价">模糊综合评价</h2>
<p>模糊性：非确定性概念（帅，高，白，年轻）。</p>
<p>模糊集合承认亦此亦彼。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420211626286.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210420211659726.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421102121700.png" /></p>
<p>一级模糊综合评价例题（3道，可查 pdf）：</p>
<p>对于综合评价，可把方案视为评语集，指标视为因素级，采用主观或客观方法得出权重。</p>
<p>指标必须经过正向化。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421111750925.png" /></p>
<p>多级模糊综合评价例题（2道），可以简化对比计算。</p>
<p>模糊综合评价方法最好在题目给出隶属度相关信息的时候使用。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">数学建模-时间序列预测模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:03 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:03+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="时间序列分析">时间序列分析</h1>
<p>时间序列也称动态序列，是指将某种现象的指标数值按照时间顺序排列而成的数值序列。</p>
<p>时间序列分析大致可分成三大部分，分别是描述过去、分析规律和预测未来。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427153139000.png" /></p>
<p>时间序列由两个组成要素构成：</p>
<ol type="1">
<li>第一个要素是时间要素：年、季度、月、周、日、小时、分钟、秒</li>
<li>第二个要素是数值要素</li>
</ol>
<p>时间序列可以分为时期时间序列和时点时间序列：</p>
<ul>
<li><strong>时期序列</strong> 中，数值要素反映现象在一定时期内发展的结果</li>
<li><strong>时点序列</strong> 中，数值要素反映现象在一定时点上的瞬间水平</li>
</ul>
<p>时期序列可加，时点序列不可加。</p>
<h1 id="时间序列分解">时间序列分解</h1>
<p>因为时间序列是某个指标数值长期变化的数值表现，所以时间序列数值变化背后必然蕴含着数值变换的规律性，这些规律性就是时间序列分析的切入点。</p>
<p>一般情况下，时间序列的 <strong>数值变化规律</strong> 有以下四种：（数值变化规律分开观察）</p>
<ul>
<li>长期变动趋势</li>
<li>季节变动规律</li>
<li>周期变动规律</li>
<li>不规则变动（随机扰动项）</li>
</ul>
<p>一个时间序列往往是以上四类变化形式的 <strong>叠加</strong>。</p>
<p>长期趋势 <strong>T</strong> 指的是统计指标在相当长的一段时间内，受到 <strong>长期趋势影响因素</strong> 的影响，表现出 <strong>持续上升</strong> 或 <strong>持续下降</strong> 的趋势，通常用字母 T 表示。例如，随着国家经济的发展，人均收入将逐渐提升；随着医学水平的提高，新生儿死亡率在不断下降。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427153633160.png" /></p>
<p>季节趋势 <strong>S</strong> 是指由于 <strong>季节的转变</strong> 使得指标数值发生 <strong>周期性变动</strong> 。这里的季节是 <strong>广义</strong> 的，一般以月、季、周为时间单位，不能以 <strong>年</strong> 作单位。例如雪糕和棉衣的销量都会随着季节气温的变化而周期变化；每年的长假（五一、十一、春节）都会引起出行人数的大量增加。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427153759975.png" /></p>
<p>循环变动 <strong>C</strong> 与季节变动的周期不同，循环变动通常以 <strong>若干年</strong> 为周期，在曲线图上表现为 <strong>波浪式</strong> 的周期变动。这种周期变动的特征表现为增加和减少 <strong>交替</strong> 出现，但是并不具 <strong>严格规则</strong> 的周期性连续变动。最典型的周期案例就是市场经济的商业周期和的整个国家的经济周期。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427154013293.png" /></p>
<p>不规则变动 <strong>I</strong> 是由某些随机因素导致的数值变化，这些因素的作用是不可预知和没有规律性的，可以视为由于众多 <strong>偶然</strong> 因素对时间序列造成的影响（在回归中又被称为扰动项）。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427154055743.png" /></p>
<p>以上四种变动就是时间序列数值变化的 <strong>分解</strong> 结果。</p>
<p>有时这些变动会同时出现在一个时间序列里面，有时也可能只出现一种或几种，这是由引起各种变动的影响因素决定的。正是由于变动组合的不确定性，时间序列的数值变化才那么千变万化。</p>
<p>四种变动与指标数值最终变动的关系可能是 <strong>叠加</strong> 关系，也可能是 <strong>乘积</strong> 关系。</p>
<p>如果四种变动之间是相互独立的关系，那么叠加模型可以表示为：<span class="math inline">\(Y=T+S+C+I\)</span></p>
<p>如果四种变动之间存在相互影响关系，那么应该使用乘积模型：<span class="math inline">\(Y=T \times S \times C \times I\)</span></p>
<p>数据具有 <strong>年内的周期性时</strong> 才能使用时间序列分解，例如数据包含月份数据(周期为12)、季度数据(周期为4) ，如果 <strong>单纯</strong> 是年份数据则不行。</p>
<p>在具体的时间序列图上，如果随着时间的推移，序列的季节 <strong>波动变得越来越大</strong> ，则反映各种变动之间的关系发生变化，建议使用乘积模型；反之，如果时间序列图的 <strong>波动保持恒定</strong>，则可以直接使用叠加模型；当然，如果不存在季节波动，则两种分解均可以。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427154703653.png" /></p>
<h2 id="spss-操作">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427154826619.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427154938459.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427155014860.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427155048405.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427155251732.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427155406628.png" /></p>
<h1 id="未来指标预测">未来指标预测</h1>
<h2 id="指数平滑模型">指数平滑模型</h2>
<h3 id="simple-模型">Simple 模型</h3>
<p>不含 <strong>趋势</strong> 和 <strong>季节</strong> 成分，由过去数据 <strong>加权</strong> 所得，只能预测 <strong>1</strong> 期。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427160443250.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427160653727.png" /></p>
<p>红色是预测的线。</p>
<h3 id="霍特-布朗线性趋势模型">霍特 / 布朗线性趋势模型</h3>
<p>含有 <strong>线性趋势</strong>、不含 <strong>季节</strong> 成分</p>
<p>该方法包含一个预测方程和两个平滑方程（一个用于水平，另一个用于趋势）。原理不细讲。</p>
<p>由式子不断递推所得。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427161415441.png" /></p>
<h3 id="阻尼趋势模型">阻尼趋势模型</h3>
<p>霍特线性趋势模型对对未来预测值过高，特别是对于长期预测。引入了一种 <strong>阻尼</strong> 效应，用来缓解较高的线性趋势。（比如人口、GDP）</p>
<p><span class="math inline">\(\phi\)</span> 越小，阻力越大。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427161834051.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427161925157.png" /></p>
<h3 id="简单季节性模型">简单季节性模型</h3>
<p>不含 <strong>趋势</strong>，含 <strong>稳定季节成分</strong> 。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427162147223.png" /></p>
<h3 id="温特加法模型">温特加法模型</h3>
<p>含有 <strong>线性趋势</strong> 和 <strong>稳定季节成分</strong> （时间序列分解加法）。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427162434210.png" /></p>
<h3 id="温特乘法模型">温特乘法模型</h3>
<p>含有 <strong>线性趋势</strong> 和 <strong>不稳定季节成分</strong> （时间序列分解乘法）。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427162511905.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427162622987.png" /></p>
<p>由于是乘法，认为不稳定，蓝色的线会波动大一点。</p>
<p>SPSS 专家建模的一些问题，如果是预测可不用关注参数显著值，解释需要，但是有的时候已经给了最好的模型，显著值可能不佳。</p>
<h2 id="一元时间序列分析模型">一元时间序列分析模型</h2>
<h3 id="时间序列的平稳性">时间序列的平稳性</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427163900337.png" /></p>
<p>只有 b g 是平稳的。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427164249314.png" /></p>
<h3 id="差分方程">差分方程</h3>
<p>滞后项，之前 <span class="math inline">\(p\)</span> 个数据。</p>
<p>将某个时间序列变量表示为该变量的 <strong>滞后项</strong>、 <strong>时间 t</strong> 和 <strong>其他变量</strong> 的函数，这样的一个函数方程被称为差分方程。</p>
<p>扰动项没有一般说明默认为 白噪声 序列。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427165117945.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427165227078.png" /></p>
<h3 id="滞后算子">滞后算子</h3>
<p>是一种表达式写法，方便表示。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427165642561.png" /></p>
<h3 id="arp-模型">AR(p) 模型</h3>
<p>为预测，生成的模型。</p>
<p>包含收 <strong>自身因素</strong> 影响较大的现象，对受 其他因素 影响不宜使用。</p>
<p>需要模型 <strong>稳定</strong>，共有 <span class="math inline">\(p\)</span> 阶元素，由于模型（自回归模型）特性，具有 <strong>自相关</strong> 现象。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427170802064.png" /></p>
<p>AR(q) 模型平稳的条件：（模长，解的长度大小）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427172028993.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427172150223.png" /></p>
<h3 id="maq-模型">MA(q) 模型</h3>
<p>q 阶 <strong>移动平均</strong>，使用扰动项，使得均值较为平稳。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427190608642.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427191007976.png" /></p>
<p>1 阶移动平均模型可以和无穷阶的自回归模型相互转换，但是需要模型中的参数少，所以还是要移动平均过程。</p>
<h4 id="maq-平稳证明">MA(q) 平稳证明</h4>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427191346473.png" /></p>
<h3 id="armap-q-模型">ARMA(p, q) 模型</h3>
<p>无趋势和季节性。</p>
<p>自回归移动平均模型，就是设法将自回归过程 AR 和移动平均过程 MA 结合起来，<strong>共同模拟</strong> 产生既有时间序列样本数据的那个随机过程的模型。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427191527084.png" /></p>
<p>ARMA 模型的平稳性和自回归 AR 模型相关，MA 一定是平稳的。</p>
<p>一般，我们可以通过观察时序图来判断时间序列是否平稳，当然，也有相应的假设检验方法能帮助我们对数据的平稳性进行检验。</p>
<h3 id="acf-相关系数">ACF 相关系数</h3>
<p>反映 <span class="math inline">\(x_t\)</span> 和 <span class="math inline">\(x_{t-s}\)</span> 之间的相关系数。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427192728250.png" /></p>
<h3 id="pacf-偏自相关系数">PACF 偏自相关系数</h3>
<p>用于衡量 <span class="math inline">\(x_t\)</span> 和 <span class="math inline">\(x_{t-s}\)</span> 之间剔除掉所有中间取值后的线性关系。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427193244049.png" /></p>
<h3 id="arma-模型识别和估计">ARMA 模型识别和估计</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427193402971.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427193422471.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427193520111.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427193731632.png" /></p>
<p>通过图形识别 ARMA 模型的拖尾现象，但识别 <strong>阶数</strong> 较为困难，求解需要依赖于计算机。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427194029531.png" /></p>
<h3 id="模型选择">模型选择</h3>
<p>往往使用 BIC 准则。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427194444160.png" /></p>
<p>原假设为残差为 0，p 值 大于 0.05 可接受。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427194827652.png" /></p>
<h3 id="arima-模型">ARIMA 模型</h3>
<p>差分自回归移动平均模型，通过差分，使得模型变得平稳。</p>
<figure>
<img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427195248970.png" alt="image-20210427195248970" /><figcaption>image-20210427195248970</figcaption>
</figure>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427195226853.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427195340604.png" /></p>
<h3 id="sarima-模型">SARIMA 模型</h3>
<p>到目前为止，我们只关注非季节性数据和非季节性 ARIMA 模型。然而，ARIMA 模型也能够对广泛的季节数据进行建模。季节性ARIMA模型是通过在 ARIMA 模型中包含额外的季节性项而生成的，其形式如下：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427195454598.png" /></p>
<h3 id="arch-模型">ARCH 模型</h3>
<p>自回归条件异方差模型，在现代高频金融时间序列中，数据经常出现波动性聚集的特点，但从长期来看数据是平稳的，即长期方差（无条件方差）是定值，但从短期来看方差是不稳定的，我们称这种异方差为条件异方差。传统的时间序列模型如ARMA模型识别不出来这一特征。ARCH 模型的实质是对扰动项进行建模。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428141452691.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428141718171.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428141944170.png" /></p>
<h3 id="garch-模型">GARCH 模型</h3>
<p>广义的 ARCH 模型。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428142348994.png" /></p>
<p>使用 LM 检验 GARCH 效应，对 扰动项评分进行检验。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428142437533.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428142700532.png" /></p>
<h1 id="灰色预测">灰色预测</h1>
<p>灰色预测是对既含有已知信息又含有不确定信息的系统进行预测，就是对在一定范围内变化的、与 <strong>时间</strong>有关的灰色过程进行预测。</p>
<p>灰色预测对原始数据进行生成处理来寻找系统变动的规律，并生成有较强 <strong>规律性</strong> 的数据序列，然后建立相应的 <strong>微分方程模型</strong>，从而预测事物未来发展趋势的状况。</p>
<p>GM(1,1) （第一个 1 表示微分方程是<strong>一阶的</strong>，后面的 1 表示只有<strong>一个变量</strong>）是使用原始的离散非负数据列，通过一次 <strong>累加</strong> 生成削弱随机性的较有规律的新的离散数据列，然后通过建立微分方程模型，得到在离散点处的解经过累减生成的原始数据的近似估计值，从而预测原始数据的后续发展。</p>
<p>AGO 序列累加数据列，<span class="math inline">\(x^{(1)}(m)=\sum\limits^m_{i=0}{x^{(0)}(i)}\)</span>, <span class="math inline">\(x^{(0)}\)</span> 为原数据列，<span class="math inline">\(z^{(1)}\)</span> 为紧邻均值生成序列。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428164949228.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428165408638.png" /></p>
<h2 id="ols-回归原理复习">OLS 回归原理复习</h2>
<p>OLS 最小二乘法。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428165708350.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428165936523.png" /></p>
<p>要求 <span class="math inline">\(X^TX\)</span> 可逆，列满秩，还可以推导到多系数的情况。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428170117415.png" /></p>
<p>如果 <span class="math inline">\(X^TX\)</span> 不可逆，要么增加样本，要么减少系数（岭回归思想，$ X^TX+I$ 一定可逆）</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428170954491.png" /></p>
<p>灰建模的初衷是对 <strong>数列</strong> 建立 <strong>近似</strong> 的 <strong>微分方程模型</strong> ，但是由于微分方程只适合连续可微函数, 而时间序列数据非连续，更谈不上可微性，因此灰色预测建模得到的是近似微分方程，称之为灰微分方程。</p>
<p>一阶微分方程求解知识（高数）：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428171747866.png" /></p>
<p>所以可得</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428171954961.png" /></p>
<p>所以要求数据具有准指数规律。</p>
<h2 id="准指数规律检验及评价">准指数规律检验及评价</h2>
<p>关注 级比 和 光滑比。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428182236623.png" /></p>
<p>发展系数 <span class="math inline">\(a\)</span> 越小预测的越精确。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428182411169.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428183036016.png" /></p>
<h2 id="gm11模型的拓展">GM(1,1)模型的拓展</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428183748156.png" /></p>
<p>灰色预测使用：</p>
<ol type="1">
<li>数据是以年份度量的非负数据（如果是月份或者季度数据一定要用上时间序列模型）</li>
<li>数据能经过准指数规律的检验（除了前两期外，后面至少90%的期数的光滑比要低于0.5）</li>
<li>数据的期数较短且和其他数据之间的关联性不强（小于等于10，也不能太短了，比如只有3期数据），要是数据期数较长，一般用传统的时间序列模型比较合适</li>
</ol>
<h2 id="代码">代码</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[result, x0_hat, relative_residuals, eta]</span> = <span class="title">gm11</span><span class="params">(x0, predict_num)</span></span></span><br><span class="line">    <span class="comment">% 函数作用：使用传统的GM(1,1)模型对数据进行预测</span></span><br><span class="line">    <span class="comment">%     x0：要预测的原始数据</span></span><br><span class="line">    <span class="comment">%     predict_num： 向后预测的期数</span></span><br><span class="line">    <span class="comment">% 输出变量：</span></span><br><span class="line">    <span class="comment">%     result：预测值</span></span><br><span class="line">    <span class="comment">%     x0_hat：对原始数据的拟合值</span></span><br><span class="line">    <span class="comment">%     relative_residuals： 对模型进行评价时计算得到的相对残差</span></span><br><span class="line">    <span class="comment">%     eta： 对模型进行评价时计算得到的级比偏差</span></span><br><span class="line">    n = <span class="built_in">length</span>(x0);</span><br><span class="line">    x1 = cumsum(x0);</span><br><span class="line">    z1 = (x1(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>) + x1(<span class="number">2</span>:<span class="keyword">end</span>)) / <span class="number">2</span>;</span><br><span class="line">    y = x0(<span class="number">2</span>:<span class="keyword">end</span>);</span><br><span class="line">    x = z1;</span><br><span class="line">    <span class="comment">% OLS 最小二乘法</span></span><br><span class="line">    k = ((n - <span class="number">1</span>) * sum(x .* y) - sum(x) * sum(y)) / ((n - <span class="number">1</span>) * sum(x .* x) - sum(x) * sum(x));</span><br><span class="line">    b = (sum(x .* x) * sum(y) - sum(x) * sum(x .* y)) / ((n - <span class="number">1</span>) * sum(x .* x) - sum(x) * sum(x));</span><br><span class="line">    <span class="comment">% -a就是发展系数,  b就是灰作用量</span></span><br><span class="line">    a = -k;</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;现在进行GM(1,1)预测的原始数据是: &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(mat2str(x0&#x27;))</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;最小二乘法拟合得到的发展系数为&#x27;</span> num2str(-a) <span class="string">&#x27;，灰作用量是&#x27;</span> num2str(b)])</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***************分割线***************&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 拟合值计算</span></span><br><span class="line">    x0_hat = <span class="built_in">zeros</span>(n, <span class="number">1</span>);</span><br><span class="line">    x0_hat(<span class="number">1</span>) = x0(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> m = <span class="number">1</span>:n<span class="number">-1</span></span><br><span class="line">        x0_hat(m+<span class="number">1</span>) = (<span class="number">1</span> - <span class="built_in">exp</span>(a)) * (x0(<span class="number">1</span>) - b/a) * <span class="built_in">exp</span>(-a*m);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 保存预测值</span></span><br><span class="line">    result = <span class="built_in">zeros</span>(predict_num, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:predict_num</span><br><span class="line">        result(<span class="built_in">i</span>) = (<span class="number">1</span> - <span class="built_in">exp</span>(a)) * (x0(<span class="number">1</span>) - b/a) * <span class="built_in">exp</span>(-a * (n+<span class="built_in">i</span><span class="number">-1</span>)); <span class="comment">% 带入公式直接计算</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 计算绝对残差和相对残差</span></span><br><span class="line">    absolute_residuals = x0(<span class="number">2</span>:<span class="keyword">end</span>) - x0_hat(<span class="number">2</span>:<span class="keyword">end</span>);</span><br><span class="line">    relative_residuals = <span class="built_in">abs</span>(absolute_residuals) ./ x0(<span class="number">2</span>:<span class="keyword">end</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 计算级比和级比偏差</span></span><br><span class="line">    class_ratio = x0(<span class="number">2</span>:<span class="keyword">end</span>) ./ x0(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>);  <span class="comment">% 计算级比 sigma(k) = x0(k) / x0(k-1)</span></span><br><span class="line">    eta = <span class="built_in">abs</span>(<span class="number">1</span>-(<span class="number">1</span><span class="number">-0.5</span>*a)/(<span class="number">1</span>+<span class="number">0.5</span>*a)*(<span class="number">1.</span>/class_ratio));  <span class="comment">% 计算级比偏差</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[result]</span> = <span class="title">new_gm11</span><span class="params">(x0, predict_num)</span></span></span><br><span class="line">    <span class="comment">% 函数作用：使用新信息的GM(1,1)模型对数据进行预测</span></span><br><span class="line">    <span class="comment">% 输入变量</span></span><br><span class="line">    <span class="comment">%     x0：要预测的原始数据</span></span><br><span class="line">    <span class="comment">%     predict_num： 向后预测的期数</span></span><br><span class="line">    <span class="comment">% 输出变量</span></span><br><span class="line">    <span class="comment">%     result：预测值</span></span><br><span class="line">    result = <span class="built_in">zeros</span>(predict_num, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:predict_num</span><br><span class="line">    	<span class="comment">% 不断使用新的预测值加入再去预测</span></span><br><span class="line">    	result(<span class="built_in">i</span>) = gm11(x0, <span class="number">1</span>);</span><br><span class="line">    	x0 = [x0; result(<span class="built_in">i</span>)];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[result]</span> = <span class="title">metabolism_gm11</span><span class="params">(x0, predict_num)</span></span></span><br><span class="line">    <span class="comment">% 函数作用：使用新陈代谢的GM(1,1)模型对数据进行预测</span></span><br><span class="line">    <span class="comment">% 输入变量</span></span><br><span class="line">    <span class="comment">%     x0：要预测的原始数据</span></span><br><span class="line">    <span class="comment">%     predict_num： 向后预测的期数</span></span><br><span class="line">    <span class="comment">% 输出变量</span></span><br><span class="line">    <span class="comment">%     result：预测值</span></span><br><span class="line">    result = <span class="built_in">zeros</span>(predict_num, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:predict_num  </span><br><span class="line">        result(<span class="built_in">i</span>) = gm11(x0, <span class="number">1</span>);  <span class="comment">% 将预测一期的结果保存到result中</span></span><br><span class="line">        x0 = [x0(<span class="number">2</span>:<span class="keyword">end</span>); result(<span class="built_in">i</span>)];  <span class="comment">% 更新x0向量，此时x0多了新的预测信息，并且删除了最开始的那个向量，队列轮转</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">year = [<span class="number">1995</span>:<span class="number">1</span>:<span class="number">2004</span>]&#x27;;</span><br><span class="line">x0 = [<span class="number">174</span>, <span class="number">179</span>, <span class="number">183</span>, <span class="number">189</span>, <span class="number">207</span>, <span class="number">234</span>, <span class="number">220.5</span>, <span class="number">256</span>, <span class="number">270</span>, <span class="number">285</span>]&#x27;;  <span class="comment">% 原始数据序列</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(year, x0, <span class="string">&#x27;o-&#x27;</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gca, <span class="string">&#x27;xtick&#x27;</span>, year(<span class="number">1</span>:<span class="number">1</span>:<span class="keyword">end</span>))</span><br><span class="line">xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;排污总量&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sum(x0 &lt; <span class="number">0</span>) &gt; <span class="number">0</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;灰色预测的时间序列中不能有负数&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">length</span>(x0);</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;原始数据的长度为&#x27;</span> num2str(n)])</span><br><span class="line"><span class="keyword">if</span> n &lt;= <span class="number">3</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;数据量太小&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 数据太多时提示可考虑使用其他方法（不报错）</span></span><br><span class="line"><span class="keyword">if</span> n &gt; <span class="number">10</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;数据量多，一定要考虑使用其他的方法，例如ARIMA，指数平滑等&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;------------------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;准指数规律检验&#x27;</span>)</span><br><span class="line">x1 = cumsum(x0); <span class="comment">% 生成 AGO 序列</span></span><br><span class="line">rho = x0(<span class="number">2</span>:<span class="keyword">end</span>) ./ x1(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>); <span class="comment">% 计算光滑度rho(k) = x0(k) / x1(k-1)</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(year(<span class="number">2</span>:<span class="keyword">end</span>), rho, <span class="string">&#x27;o-&#x27;</span>, [year(<span class="number">2</span>), year(<span class="keyword">end</span>)], [<span class="number">0.5</span>, <span class="number">0.5</span>], <span class="string">&#x27;-&#x27;</span>) </span><br><span class="line">grid on</span><br><span class="line">text(year(<span class="keyword">end</span><span class="number">-1</span>) + <span class="number">0.2</span>, <span class="number">0.55</span>, <span class="string">&#x27;临界线&#x27;</span>)</span><br><span class="line">set(gca, <span class="string">&#x27;xtick&#x27;</span>, year(<span class="number">2</span>:<span class="number">1</span>:<span class="keyword">end</span>))</span><br><span class="line">xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;原始数据的光滑度&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;指标1：光滑比小于0.5的数据占比为&#x27;</span> num2str(<span class="number">100</span> * sum(rho&lt; <span class="number">0.5</span>) / (n - <span class="number">1</span>)) <span class="string">&#x27;%&#x27;</span>])</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;指标2：除去前两个时期外，光滑比小于0.5的数据占比为&#x27;</span> num2str(<span class="number">100</span> * sum(rho(<span class="number">3</span>:<span class="keyword">end</span>) &lt; <span class="number">0.5</span>) / (n<span class="number">-3</span>)) <span class="string">&#x27;%&#x27;</span>])</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;参考标准：指标1一般要大于60%, 指标2要大于90%&#x27;</span>)</span><br><span class="line">Judge = input(<span class="string">&#x27;你认为可以通过准指数规律的检验吗？可以通过请输入1，不能请输入0：&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> Judge == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> n &lt;= <span class="number">4</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;数据只有4期，因此我们直接将三种方法的结果求平均即可~&#x27;</span>)</span><br><span class="line">    predict_num = input(<span class="string">&#x27;请输入你要往后面预测的期数： &#x27;</span>);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是传统的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    [result1, x0_hat, relative_residuals, eta] = gm11(x0, predict_num</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是进行新信息的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    result2 = new_gm11(x0, predict_num);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是进行新陈代谢的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    result3 = metabolism_gm11(x0, predict_num);</span><br><span class="line">    result = (result1 + result2 + result3) / <span class="number">3</span>;</span><br><span class="line">    result</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;因为原数据的期数大于4，所以我们可以将数据组分为训练组和试验组&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">7</span></span><br><span class="line">        test_num = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    	test_num = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    train_x0 = x0(<span class="number">1</span>:<span class="keyword">end</span>-test_num);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;训练数据是: &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(mat2str(train_x0&#x27;))</span><br><span class="line">    test_x0 = x0(<span class="keyword">end</span>-test_num+<span class="number">1</span>:<span class="keyword">end</span>);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;试验数据是: &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(mat2str(test_x0&#x27;))</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是传统的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    result1 = gm11(train_x0, test_num);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是进行新信息的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    result2 = new_gm11(train_x0, test_num);</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;***下面是进行新陈代谢的GM(1,1)模型预测的详细过程***&#x27;</span>)</span><br><span class="line">    result3 = metabolism_gm11(train_x0, test_num);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    test_year = year(<span class="keyword">end</span>-test_num+<span class="number">1</span>:<span class="keyword">end</span>);</span><br><span class="line">    <span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">plot</span>(test_year,test_x0,<span class="string">&#x27;o-&#x27;</span>,test_year,result1,<span class="string">&#x27;*-&#x27;</span>,test_year,result2,<span class="string">&#x27;+-&#x27;</span>,test_year,result3,<span class="string">&#x27;x-&#x27;</span>)</span><br><span class="line">    grid on</span><br><span class="line">    set(gca, <span class="string">&#x27;xtick&#x27;</span>, year(<span class="keyword">end</span>-test_num+<span class="number">1</span>):<span class="number">1</span>:year(<span class="keyword">end</span>))</span><br><span class="line">    <span class="built_in">legend</span>(<span class="string">&#x27;试验组的真实数据&#x27;</span>, <span class="string">&#x27;传统GM(1,1)预测结果&#x27;</span>, <span class="string">&#x27;新信息GM(1,1)预测结果&#x27;</span>, <span class="string">&#x27;新陈代谢GM(1,1)预测结果&#x27;</span>)</span><br><span class="line">    xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">    ylabel(<span class="string">&#x27;排污总量&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    SSE1 = sum((test_x0-result1).^<span class="number">2</span>);</span><br><span class="line">    SSE2 = sum((test_x0-result2).^<span class="number">2</span>);</span><br><span class="line">    SSE3 = sum((test_x0-result3).^<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;传统GM(1,1)对于试验组预测的误差平方和为&#x27;</span> num2str(SSE1)])</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;新信息GM(1,1)对于试验组预测的误差平方和为&#x27;</span> num2str(SSE2)])</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;新陈代谢GM(1,1)对于试验组预测的误差平方和为&#x27;</span> num2str(SSE3)])</span><br><span class="line">    <span class="keyword">if</span> SSE1 &lt; SSE2 &amp; SSE1 &lt; SSE3</span><br><span class="line">    	choose = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">elseif</span> SSE2 &lt; SSE3</span><br><span class="line">    	choose = <span class="number">2</span>;</span><br><span class="line">   	<span class="keyword">else</span></span><br><span class="line">   		choose = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    Model = &#123;<span class="string">&#x27;传统GM(1,1)模型&#x27;</span>, <span class="string">&#x27;新信息GM(1,1)模型&#x27;</span>, <span class="string">&#x27;新陈代谢GM(1,1)模型&#x27;</span>&#125;;</span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;因为&#x27;</span>,Model(choose),<span class="string">&#x27;的误差平方和最小，所以我们应该选择其进行预测&#x27;</span>])</span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    predict_num = input(<span class="string">&#x27;请输入你要往后面预测的期数： &#x27;</span>);</span><br><span class="line">    [result, x0_hat, relative_residuals, eta] = gm11(x0, predict_num);</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="number">2</span></span><br><span class="line">        result = new_gm11(x0, predict_num);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> choose == <span class="number">3</span></span><br><span class="line">        result = metabolism_gm11(x0, predict_num);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    result</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(year(<span class="number">2</span>:<span class="keyword">end</span>), relative_residuals, <span class="string">&#x27;*-&#x27;</span>) </span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;相对残差&#x27;</span>) </span><br><span class="line">xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">set(gca,<span class="string">&#x27;xtick&#x27;</span>,year(<span class="number">2</span>:<span class="number">1</span>:<span class="keyword">end</span>))</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(year(<span class="number">2</span>:<span class="keyword">end</span>), eta, <span class="string">&#x27;o-&#x27;</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;级比偏差&#x27;</span>) </span><br><span class="line">xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">set(gca, <span class="string">&#x27;xtick&#x27;</span>, year(<span class="number">2</span>:<span class="number">1</span>:<span class="keyword">end</span>))</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;****下面将输出对原数据拟合的评价结果***&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% &lt; 0.1 不错 &lt; 0.2 可接受</span></span><br><span class="line">average_relative_residuals = <span class="built_in">mean</span>(relative_residuals);  <span class="comment">% 计算平均相对残差 mean函数用来均值</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;平均相对残差为&#x27;</span> num2str(average_relative_residuals)])</span><br><span class="line">average_eta = <span class="built_in">mean</span>(eta);   <span class="comment">% 计算平均级比偏差</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;平均级比偏差为&#x27;</span> num2str(average_eta)])</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;------------------------------------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">plot</span>(year, x0, <span class="string">&#x27;-o&#x27;</span>, year, x0_hat, <span class="string">&#x27;-*m&#x27;</span>, year(<span class="keyword">end</span>)+<span class="number">1</span>:year(<span class="keyword">end</span>)+predict_num, result, <span class="string">&#x27;-*b&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>([year(<span class="keyword">end</span>), year(<span class="keyword">end</span>)+<span class="number">1</span>], [x0(<span class="keyword">end</span>), result(<span class="number">1</span>)], <span class="string">&#x27;-*b&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;原始数据&#x27;</span>,<span class="string">&#x27;拟合数据&#x27;</span>,<span class="string">&#x27;预测数据&#x27;</span>)</span><br><span class="line">set(gca, <span class="string">&#x27;xtick&#x27;</span>, [year(<span class="number">1</span>):<span class="number">1</span>:year(<span class="keyword">end</span>)+predict_num])</span><br><span class="line">xlabel(<span class="string">&#x27;年份&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;排污总量&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="例题演示">例题演示</h1>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210427200049434.png" /></p>
<h2 id="spss-操作-1">SPSS 操作</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210514210415804.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210514210603197.png" /></p>
<h2 id="例题1.-销售数据预测">例题1. 销售数据预测</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428105409192.png" /></p>
<p>数据为季度数据（有四个周期），从图中看出也有季节性波动，即第二季度的销量较高，第四季度较低。</p>
<p>根据时间序列图可知数据不平稳，有向上的趋势。</p>
<p>SPSS 的专家建模给出的最合适的模型是温特加法模型，意味着原时间序列数据含有线性趋势和稳定的季节成分，我们可以使用加法时间序列分解。</p>
<p>SPSS 也会对发现的异常值使用序列平均值来替代。</p>
<p>注：</p>
<ul>
<li>预测值和拟合值是不相同的，预测值是将样本外年份的数据带入模型计算得到的，而拟合值是将样本的年份重新带入模型计算得到。</li>
<li>保留残差的ACF和PACF图形可以帮助我们判断残差是否为白噪声，即该时间序列是否能被模型识别完全。</li>
<li>一般比较两个模型的好坏，我们可以使用平稳的R方（文档上翻译成了固定的R方）或者标准化BIC（BIC准则），这两个指标既考虑了拟合的好坏，又考虑了模型的复杂度</li>
<li>R方可用来反映线性模型拟合的好坏，越接近于1拟合的越准确</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428112219505.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428112250580.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428112351973.png" /></p>
<h2 id="例题2.-人口数据预测">例题2. 人口数据预测</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428112742127.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428112800341.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130305431.png" /></p>
<h2 id="例题3.-上证指数预测">例题3. 上证指数预测</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130416367.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130446738.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130528074.png" /></p>
<p>剔除异常值后进行预测：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130748041.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428130820019.png" /></p>
<h2 id="例题4.-gdp增速预测">例题4. GDP增速预测</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428131014195.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428131052801.png" /></p>
<p>预测 <strong>两要</strong>：一要结合背景；二要合理假设，预测 <strong>两不要</strong>：不要硬套模型；不要不做解释</p>
<p>GDP 还受到了国内政策和其他社会因素的影响。</p>
<h2 id="例题5.-深成b指时间序列预测">例题5. 深成B指时间序列预测</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428150820881.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428150845208.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428150947333.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428151022241.png" /></p>
<p>太多的滞后项会增加预测的 <strong>误差</strong> ，太少的滞后项又会 <strong>遗失</strong> 部分相关信息。经验和理论知识通常是用来决定滞后项阶数的最好方式，然而，依然存在着一些准则帮助我们确定滞后的阶数。为了确定哪个模型拟合效果最好，我们分别估计出了这四种模型，并给出了对应的AIC和BIC值，我们认为AIC与BIC值较小，模型拟合效果较好。</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>AIC</th>
<th>BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model1：ARMA（3,3）</td>
<td>3575.15</td>
<td>3614.903</td>
</tr>
<tr class="even">
<td>Model2：ARMA（8,8）</td>
<td>3567.47</td>
<td>3656.915</td>
</tr>
<tr class="odd">
<td>Model3：ARMA（3,8）</td>
<td>3576.66</td>
<td>3641.258</td>
</tr>
<tr class="even">
<td>Model4：ARMA（8,3）</td>
<td>3575.39</td>
<td>3639.992</td>
</tr>
</tbody>
</table>
<p>这四个模型中应选取Model1，即ARMA（3,3）模型。此时，AIC值和BIC值的平均值最小。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428151626110.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428151730932.png" /></p>
<p>检验残差是否为白噪声，使用 Ljung‐Box Q 检验，来检验ARMA模型的有效性，滞后12项的检验值的P值大于0.05，在5%的显著性水平下并不能拒绝原假设。故可以认为通过白噪声检验，即我们认为回归得到的残差不存在较明显的相关性，因此模型有效性较好。</p>
<p>接下来再用LM检验是否存在 GARCH 误差。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428151857264.png" /></p>
<p>再通过 GARCH 调整参数，选择使用带有GARCH(1,1) 且 <span class="math inline">\(v_t\)</span> 服从t分布的扰动项的 ARMA(3,3) 模型进行估计。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210428152359223.png" /></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insheet</span> using <span class="string">&quot;Bindex.csv&quot;</span></span><br><span class="line"><span class="keyword">gen</span> datevar = <span class="built_in">date</span>(date, <span class="string">&quot;YMD&quot;</span>)</span><br><span class="line"><span class="keyword">format</span> datevar %td</span><br><span class="line"><span class="keyword">label</span> variable datevar <span class="string">&quot;日期&quot;</span></span><br><span class="line"><span class="keyword">tsset</span> datevar</span><br><span class="line"><span class="keyword">gen</span> time = _n <span class="comment">// 系统记录到后台的观测值的个数</span></span><br><span class="line"><span class="keyword">tsset</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">line</span> index datevar</span><br><span class="line"><span class="keyword">gen</span> r = 100 * (index - <span class="keyword">L</span>.index) / <span class="keyword">L</span>.index <span class="comment">// L 为 lag 滞后项的缩写</span></span><br><span class="line"><span class="keyword">summarize</span> r</span><br><span class="line"><span class="keyword">line</span> r datevar</span><br><span class="line"></span><br><span class="line"><span class="comment">// ADF PADF 检测</span></span><br><span class="line"><span class="keyword">dfuller</span> r</span><br><span class="line"><span class="keyword">ac</span> r,lags(20) <span class="comment">// 自相关系数图</span></span><br><span class="line"><span class="keyword">pac</span> r,lags(20) </span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> matsize 1500</span><br><span class="line"><span class="keyword">arima</span> r,<span class="keyword">arima</span>(3,0,3)   <span class="comment">// 用ARIMA(3,0,3)模型对r进行估计</span></span><br><span class="line"><span class="keyword">estat</span> ic   <span class="comment">// 得到AIC和BIC，用于选择合适的模型（选小原则）</span></span><br><span class="line"><span class="keyword">arima</span> r,<span class="keyword">arima</span>(8,0,8)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"><span class="keyword">arima</span> r,<span class="keyword">arima</span>(3,0,8)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"><span class="keyword">arima</span> r,<span class="keyword">arima</span>(8,0,3)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"></span><br><span class="line"><span class="comment">// 残差分布直方图</span></span><br><span class="line"><span class="keyword">arima</span> r,<span class="keyword">arima</span>(3,0,3)</span><br><span class="line"><span class="keyword">predict</span> residess, residuals</span><br><span class="line"><span class="keyword">hist</span> residess,norm freq</span><br><span class="line"></span><br><span class="line"><span class="comment">// 残差白噪声序列，检验方法为Q检验</span></span><br><span class="line"><span class="keyword">wntestq</span> residess, lag(12)</span><br><span class="line"><span class="keyword">gen</span> ressq = residess^2</span><br><span class="line"><span class="keyword">wntestq</span> ressq, lag(12)</span><br><span class="line"></span><br><span class="line"><span class="comment">// LM检验：是否存在ARCH误差</span></span><br><span class="line"><span class="keyword">reg</span> ressq <span class="keyword">l</span>.ressq l2.ressq l3.ressq l4.ressq l5.ressq</span><br><span class="line"><span class="keyword">gen</span> LM_STAT=<span class="built_in">e</span>(<span class="keyword">N</span>)*<span class="built_in">e</span>(r2) <span class="comment">// 计算LM统计量</span></span><br><span class="line"><span class="keyword">display</span> LM_STAT</span><br><span class="line"><span class="keyword">display</span> chiprob(<span class="built_in">e</span>(df_m),LM_STAT) <span class="comment">// 计算 p 值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用AIC BIC选择合适的模型进行估计 </span></span><br><span class="line"><span class="comment">// 注意：扰动项的分布在金融数据中常服从t分布</span></span><br><span class="line"><span class="comment">// 正态分布下GARCH(1,1)估计</span></span><br><span class="line"><span class="keyword">arch</span> r,<span class="keyword">arima</span>(3 0 3) <span class="keyword">arch</span>(1) garch(1)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"><span class="comment">// t分布下GARCH(1,1)估计</span></span><br><span class="line"><span class="keyword">arch</span> r,<span class="keyword">arima</span>(3 0 3) <span class="keyword">arch</span>(1) garch(1) distribution(t 3)  <span class="comment">// 自由度为3的t分布</span></span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"><span class="keyword">arch</span> r,<span class="keyword">arima</span>(3 0 3) <span class="keyword">arch</span>(2) garch(2)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"><span class="keyword">arch</span> r,<span class="keyword">arima</span>(3 0 3) <span class="keyword">arch</span>(2) garch(2) distribution(t 3)</span><br><span class="line"><span class="keyword">estat</span> ic</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到拟合结果，并进行预测</span></span><br><span class="line"><span class="keyword">arch</span> r,<span class="keyword">arima</span>(3 0 3) <span class="keyword">arch</span>(1) garch(1) distribution(t 3)</span><br><span class="line"><span class="keyword">tsappend</span>, add(10)  <span class="comment">// 将时间延长10期</span></span><br><span class="line"><span class="keyword">predict</span> result <span class="comment">// 对数据进行预测</span></span><br><span class="line"><span class="keyword">tsline</span> result r, legend(<span class="keyword">label</span>(1 <span class="string">&quot;预测值&quot;</span>)  <span class="keyword">label</span>(2 <span class="string">&quot;真实值&quot;</span>))</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%95%B0%E6%A8%A1%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E6%95%B0%E6%A8%A1%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">数学建模-数模基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:02 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:02+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="假设检验">假设检验</h1>
<p>在 <em>相关性分析</em>、<em>回归分析</em> 等问题中，需要对数据的分布做出合理假设，认为其符合某种分布，这样分析才有意义。</p>
<p>在原假设成立的情况下，数据需要满足 <strong>某一分布</strong>，p 值为当原假设为真时，比所得到的样本观察结果更极端的结果出现的概率。原假设 <span class="math inline">\(H_0\)</span> 成立时的最低显著性水平为 <span class="math inline">\(\alpha\)</span> ， 若 p 值大于 <span class="math inline">\(\alpha\)</span> ，接受原假设，<span class="math inline">\(1 - \alpha\)</span> 即为置信水平。</p>
<h2 id="步骤">步骤</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422141019850.png" /></p>
<h2 id="均值检验">均值检验</h2>
<p>在已知样本服从正态分布的情况下，比较两个平均数的差异是否显著，从而承认或拒绝原假设。</p>
<p><img src="https://img-blog.csdn.net/20180624110938247?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RpYW5ndWl5dXl1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" /></p>
<p><em>Z 检验</em> 的核心是总体服从正态分布，且该正态分布的均值未知，需要我们检验，但 <strong>方差</strong> 已知。</p>
<p>然而，在 <strong>现实问题</strong> 中，总体的方差也往往是未知的，如果总体方差未知，可以通过引入样本方差，来进行 <em>t 检验</em>。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422141259974.png" /></p>
<h3 id="例题">例题</h3>
<p>为了比较两种产品、两种仪器、两种方法等的 <strong>差异</strong>，我们常在 <strong>相同</strong> 的条件下做对比试验，得到一批成对的观察值，然后分析观察数据作出推断，这种方法常称为逐对比较法。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422141941592.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210422142902242.png" /></p>
<h2 id="分布检验">分布检验</h2>
<p>不能知道总体服从什么类型的分布，这时就需要根据样本来检验关于分布的假设，使用 <em>卡方拟合检验法</em>，它可以用来检验总体是否具有某一个指定的分布或属于某一个分布族。</p>
<h1 id="描述统计">描述统计</h1>
<h2 id="excel">Excel</h2>
<p>F4 技巧，函数，数据透视表。</p>
<p>饼图、柱状图、条形图、直方图、折线图、散点图、箱线图的绘画使用。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421200940453.png" /></p>
<h2 id="matlab">Matlab</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MIN = <span class="built_in">min</span>(Test); <span class="comment">% 每一列的最小值</span></span><br><span class="line">MAX = <span class="built_in">max</span>(Test); <span class="comment">% 每一列的最大值</span></span><br><span class="line">MEAN = <span class="built_in">mean</span>(Test); <span class="comment">% 每一列的均值</span></span><br><span class="line">MEDIAN = median(Test); <span class="comment">%每一列的中位数</span></span><br><span class="line">SKEWNESS = skewness(Test); <span class="comment">%每一列的偏度</span></span><br><span class="line">KURTOSIS = kurtosis(Test);  <span class="comment">%每一列的峰度</span></span><br><span class="line">STD = std(Test);  <span class="comment">% 每一列的标准差</span></span><br><span class="line">RESULT = [MIN;MAX;MEAN;MEDIAN;SKEWNESS;KURTOSIS;STD]</span><br></pre></td></tr></table></figure>
<h2 id="spss">SPSS</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210421201009807.png" /></p>
<h1 id="matlab-使用">Matlab 使用</h1>
<h2 id="实时脚本运行">实时脚本运行</h2>
<p>可以美化公式。</p>
<h2 id="三维绘图">三维绘图</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">X = [<span class="number">1</span> <span class="number">2</span> <span class="number">4</span>];</span><br><span class="line">Y = [<span class="number">3</span> <span class="number">5</span>];</span><br><span class="line">Z = [<span class="number">4</span> <span class="number">8</span> <span class="number">10</span>; <span class="number">5</span> <span class="number">9</span> <span class="number">13</span>] <span class="comment">% n * m</span></span><br><span class="line">mesh(X, Y, Z) <span class="comment">% 也可以一一对应</span></span><br><span class="line">xlabel(<span class="string">&#x27;x轴&#x27;</span>)  </span><br><span class="line">ylabel(<span class="string">&#x27;y轴&#x27;</span>)  </span><br><span class="line">zlabel(<span class="string">&#x27;z轴&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mesh(Z) <span class="comment">% 单纯绘图 X 1:3 Y 1:2</span></span><br><span class="line">hidden off <span class="comment">%% 取消遮挡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 以 mesh 低密度形成曲线</span></span><br><span class="line">n = <span class="number">11</span>;</span><br><span class="line">tem = <span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">5</span>, n); <span class="comment">% 0-5 等距分隔成 n 份</span></span><br><span class="line">x = <span class="built_in">repmat</span>(tem, n, <span class="number">1</span>);</span><br><span class="line">y = <span class="built_in">repmat</span>(tem, n, <span class="number">1</span>);</span><br><span class="line">z = x .^ <span class="number">2</span> - y .^ <span class="number">2</span>;</span><br><span class="line">mesh(x, y, z)</span><br><span class="line">axis vis3d</span><br><span class="line"></span><br><span class="line">[x, y] = <span class="built_in">meshgrid</span>(<span class="number">-5</span>:<span class="number">0.5</span>:<span class="number">5</span>); <span class="comment">% 限制区域</span></span><br><span class="line">tem = <span class="built_in">sqrt</span>(x .^ <span class="number">2</span> + y .^ <span class="number">2</span> + <span class="number">1e-12</span>); <span class="comment">% eps 也可以，防止 0/0 = NaN</span></span><br><span class="line">z = <span class="built_in">sin</span>(tem) ./ tem;</span><br><span class="line">mesh(x, y, z)</span><br><span class="line">axis vis3d</span><br><span class="line"></span><br><span class="line"><span class="comment">% meshc 同时绘制等高线</span></span><br><span class="line"><span class="comment">% meshz 加底柱</span></span><br><span class="line"><span class="comment">% surf 绘制面</span></span><br><span class="line">[x, y] = <span class="built_in">meshgrid</span>(linespace(<span class="number">0</span>, <span class="number">5</span>, <span class="number">11</span>));</span><br><span class="line">z = x .^ <span class="number">2</span> - y .^ <span class="number">2</span>;</span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">mesh(x, y, z)</span><br><span class="line">title(<span class="string">&#x27;mesh&#x27;</span>)</span><br><span class="line">axis vis3d</span><br><span class="line"></span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">surf(x, y, z)</span><br><span class="line">title(<span class="string">&#x27;surf&#x27;</span>)</span><br><span class="line">axis vis3d</span><br><span class="line"><span class="comment">% surfl 加灯光</span></span><br><span class="line"><span class="comment">% shading flat/interp 光滑模式</span></span><br><span class="line"></span><br><span class="line">[x, y] = <span class="built_in">meshgrid</span>(<span class="number">-3</span>:<span class="number">0.1</span>:<span class="number">3</span>);</span><br><span class="line">peaks</span><br><span class="line">maxz = <span class="built_in">max</span>(<span class="built_in">max</span>(z));</span><br><span class="line">minz = <span class="built_in">min</span>(<span class="built_in">min</span>(z));</span><br><span class="line">levels = <span class="built_in">linspace</span>(minz, maxz, <span class="number">5</span>); <span class="comment">% levels 为数值也可以</span></span><br><span class="line">contour(x, y, z, levels, <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;ShowText&#x27;</span>, <span class="string">&#x27;on&#x27;</span>)</span><br><span class="line"><span class="comment">% contourf contour3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% plot3 三位空间折线图</span></span><br><span class="line">t = linespace(<span class="number">0</span>, <span class="number">4</span> * <span class="built_in">pi</span>, <span class="number">100</span>);</span><br><span class="line">x = <span class="built_in">sin</span>(t) + <span class="number">1</span>;</span><br><span class="line">y = <span class="built_in">cos</span>(t);</span><br><span class="line">z = t;</span><br><span class="line"><span class="built_in">plot3</span>(x, y, z);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 符号函数</span></span><br><span class="line">syms u v</span><br><span class="line">r = <span class="number">2</span> + <span class="built_in">sin</span>(<span class="number">7</span> .* u + <span class="number">5</span> .* v);</span><br><span class="line">x = r .* <span class="built_in">cos</span>(u) .* <span class="built_in">sin</span>(v);</span><br><span class="line">y = r .* <span class="built_in">sin</span>(u) .* <span class="built_in">sin</span>(v);</span><br><span class="line">z = r .* <span class="built_in">cos</span>(v);</span><br><span class="line">fmesh(x, y, z, [<span class="number">0</span> <span class="number">2</span> * <span class="built_in">pi</span> <span class="number">0</span> <span class="built_in">pi</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">% 隐函数绘制</span></span><br><span class="line">f = @(x, y, z) x .^ <span class="number">2</span> + y .^ <span class="number">2</span> - z .^ <span class="number">2</span>; <span class="comment">% == 0</span></span><br><span class="line">fimplicit(f);</span><br></pre></td></tr></table></figure>
<h2 id="符号运算">符号运算</h2>
<p>不定积分、定积分求解，方程组求解。</p>
<p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 符号表达式可以化解、因式分解</span></span><br><span class="line">y = m ^ <span class="number">2</span> - n ^ <span class="number">2</span>;</span><br><span class="line">simplify(y)</span><br><span class="line"><span class="built_in">factor</span>(y)</span><br><span class="line">expand(y) <span class="comment">% 多项式展开</span></span><br><span class="line">collect(y) <span class="comment">% 多项式合并</span></span><br><span class="line">[z1, z2] = numden(sym(<span class="number">2.5</span>)) <span class="comment">% 计算分子和分母</span></span><br><span class="line">mupad <span class="comment">% 符号运算工具箱</span></span><br><span class="line"></span><br><span class="line">syms x</span><br><span class="line">y = x ^ <span class="number">4</span> - <span class="number">5</span> * x ^ <span class="number">2</span> + <span class="number">6</span></span><br><span class="line">diff(y) <span class="comment">% 求一阶导</span></span><br><span class="line">diff(y, <span class="number">2</span>) <span class="comment">% 求二阶导</span></span><br><span class="line"><span class="comment">% 注意对矩阵 diff 是求差分</span></span><br><span class="line"></span><br><span class="line">y = <span class="built_in">cos</span>(x) * <span class="built_in">tan</span>(x)</span><br><span class="line">dy = diff(y, <span class="number">10</span>)</span><br><span class="line">simplify(dy)</span><br><span class="line"></span><br><span class="line">syms x1 x2 x3</span><br><span class="line">y1 = x1^<span class="number">5</span>*x2+x2*x3-x1^<span class="number">2</span>*x3</span><br><span class="line">py1 = diff(y1,x1,<span class="number">1</span>) <span class="comment">% 对x1求一阶偏导</span></span><br><span class="line">py2 = diff(y1,x1,x2) <span class="comment">% 先对x1求偏导，再对x2求偏导</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 不定积分 不会加上常数和绝对值</span></span><br><span class="line">syms x</span><br><span class="line">y = x ^ <span class="number">2</span></span><br><span class="line">int(y, x)</span><br><span class="line">syms x</span><br><span class="line">y = <span class="number">1</span>/x</span><br><span class="line">int(y, x)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 定积分 不是所有函数都能推出积分</span></span><br><span class="line">syms x</span><br><span class="line">y = <span class="built_in">sin</span>(x)</span><br><span class="line">int(y, x, <span class="number">0</span>, <span class="built_in">pi</span> / <span class="number">2</span>)</span><br><span class="line">syms x a b</span><br><span class="line">y = <span class="built_in">exp</span>(x)</span><br><span class="line">int(y, x, a, b)</span><br><span class="line"></span><br><span class="line">y = <span class="number">1</span> / <span class="built_in">exp</span>(x) * <span class="built_in">log</span>(x+<span class="number">2</span>*x^<span class="number">2</span>+<span class="built_in">sin</span>(x)) <span class="comment">% 无法求出积分</span></span><br><span class="line">int(y,x,<span class="number">0</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment">% 我们可以计算数值积分：数值积分可用于求定积分的近似值</span></span><br><span class="line">syms x </span><br><span class="line">y = @(x) <span class="number">1</span> ./ <span class="built_in">exp</span>(x) .* <span class="built_in">log</span>(x+<span class="number">2.</span>*x.^<span class="number">2</span>+<span class="built_in">sin</span>(x))  <span class="comment">% 注意，写成函数句柄时，要用点乘或者点除</span></span><br><span class="line">integral(y,<span class="number">0</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题1: 求解单变量方程</span></span><br><span class="line">syms x</span><br><span class="line">answ = solve(<span class="built_in">sin</span>(x) == <span class="number">1</span>, x)</span><br><span class="line">eqn = (<span class="built_in">sin</span>(x) == <span class="number">1</span>)</span><br><span class="line"><span class="comment">% 因为三角函数是周期函数，如果要得到所有的解，则需要加上条件</span></span><br><span class="line">[answ, params, condions] = solve(eqn, x, <span class="string">&#x27;ReturnConditions&#x27;</span>, <span class="built_in">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题2: 多变量方程求解</span></span><br><span class="line">syms a b c x</span><br><span class="line">eqn = (a*x^<span class="number">2</span> + b*x + c == <span class="number">0</span>);</span><br><span class="line">answ1 = solve(eqn, x)  <span class="comment">% 将x视为未知数求解 </span></span><br><span class="line">answ2 = solve(eqn, a) <span class="comment">% 将a视为未知数求解</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题3：方程组求解</span></span><br><span class="line">syms u v a</span><br><span class="line">eqn = [<span class="number">2</span>*u + v == a, u - v == <span class="number">1</span>];</span><br><span class="line">answ = solve(eqn, [u, v])</span><br><span class="line">answ.u</span><br><span class="line">answ.v</span><br><span class="line">[answ_u, answ_v] = solve(eqn, [u, v])</span><br><span class="line"></span><br><span class="line"><span class="comment">%% solve 可能会警告</span></span><br><span class="line">syms x</span><br><span class="line">eqn = (<span class="built_in">sin</span>(x) == x^<span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">solve(eqn, x)  <span class="comment">% 警告</span></span><br><span class="line"><span class="comment">% 画图看看 </span></span><br><span class="line">fplot(<span class="built_in">sin</span>(x), [<span class="number">-2</span> <span class="number">2</span>])  <span class="comment">% fplot函数可绘制表达式的图形</span></span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">fplot(x^<span class="number">2</span> - <span class="number">1</span>, [<span class="number">-2</span> <span class="number">2</span>]) </span><br><span class="line"></span><br><span class="line"><span class="comment">%% vpasolve函数求解，可以指定区间</span></span><br><span class="line">syms x</span><br><span class="line">eqn = <span class="built_in">sin</span>(x) == x^<span class="number">2</span> - <span class="number">1</span>;</span><br><span class="line">vpasolve(eqn, x, [<span class="number">0</span> <span class="number">2</span>])</span><br><span class="line">vpasolve(eqn, x, [<span class="number">-1</span> <span class="number">0</span>])</span><br><span class="line">vpasolve(eqn, x, [<span class="number">-10</span> <span class="number">10</span>])</span><br><span class="line">vpasolve(eqn, x, <span class="string">&#x27;random&#x27;</span>, <span class="built_in">true</span>) </span><br><span class="line">vpasolve(eqn, x, <span class="number">-5</span>)   <span class="comment">% 给定搜索的起始点</span></span><br><span class="line"></span><br><span class="line">syms x y</span><br><span class="line">eqn = [x^<span class="number">2</span> - <span class="number">2</span>*x - <span class="number">3</span>*x*y == <span class="number">10</span>, y^<span class="number">4</span> == <span class="built_in">exp</span>(<span class="number">-2</span>*x/<span class="number">3</span>*y)]</span><br><span class="line">fimplicit(x^<span class="number">2</span> - <span class="number">2</span>*x - <span class="number">3</span>*x*y == <span class="number">10</span>, [<span class="number">-10</span> <span class="number">10</span>],<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">fimplicit(y^<span class="number">4</span> == <span class="built_in">exp</span>(<span class="number">-2</span>*x/<span class="number">3</span>*y), [<span class="number">-10</span> <span class="number">10</span>],<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">[answ_x, answ_y] = vpasolve(eqn, [x, y],[<span class="number">-4</span> <span class="number">-1</span>;<span class="number">1</span> <span class="number">5</span>])</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="comment">% 符号变量变回数值变量</span></span><br><span class="line"><span class="built_in">plot</span>(double(answ_x), double(answ_y), <span class="string">&#x27;ko&#x27;</span>, <span class="string">&#x27;MarkerSize&#x27;</span>, <span class="number">10</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">% 默认工具箱求解</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span> = <span class="title">my_fun</span><span class="params">(x)</span></span></span><br><span class="line">    F(<span class="number">1</span>) = <span class="built_in">exp</span>(-<span class="built_in">exp</span>(-(x(<span class="number">1</span>)+x(<span class="number">2</span>)))) - x(<span class="number">2</span>)*(<span class="number">1</span>+x(<span class="number">1</span>)^<span class="number">2</span>);</span><br><span class="line">    F(<span class="number">2</span>) = x(<span class="number">1</span>)*<span class="built_in">cos</span>(x(<span class="number">2</span>)) + x(<span class="number">2</span>)*<span class="built_in">sin</span>(x(<span class="number">1</span>)) - <span class="number">0.5</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">x0 = [<span class="number">0</span>,<span class="number">0</span>];  <span class="comment">% 初始值</span></span><br><span class="line">result_x = fsolve(@my_fun,x0)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 效果等同于</span></span><br><span class="line">syms x1 x2</span><br><span class="line">eqn =  [<span class="built_in">exp</span>(-<span class="built_in">exp</span>(-(x1+x2))) - x2*(<span class="number">1</span>+x1^<span class="number">2</span>) == <span class="number">0</span>, x1*<span class="built_in">cos</span>(x2) + x2*<span class="built_in">sin</span>(x1) - <span class="number">0.5</span> == <span class="number">0</span>]</span><br><span class="line">[answ_x1, answ_x2] = vpasolve(eqn, [x1, x2], [<span class="number">0</span> <span class="number">0</span>])</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">数学建模-微分方程模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 20:01:01 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T20:01:01+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="微分方程模型">微分方程模型</h1>
<h2 id="基本概念">基本概念</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430163821793.png" /></p>
<p>建立微分方程：专业知识 + 套用现有模型</p>
<h2 id="解析解">解析解</h2>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210430164233449.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">dsolve(<span class="string">&#x27;y-Dy=2*x&#x27;</span>, <span class="string">&#x27;x&#x27;</span>) <span class="comment">% 需指定自变量，默认为 t, 否则 x 会被看为常数</span></span><br><span class="line">syms y(x)</span><br><span class="line">eqn = (y - diff(y,x) == <span class="number">2</span>*x);</span><br><span class="line">dsolve(eqn)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 可以含其他参数</span></span><br><span class="line">syms y(x) a</span><br><span class="line">eqn = (y - diff(y,x) == a*x);  </span><br><span class="line">dsolve(eqn)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例2</span></span><br><span class="line">syms y(x)</span><br><span class="line">eqn = (y - diff(y,x) == <span class="number">2</span>*x);  </span><br><span class="line">cond = (y(<span class="number">0</span>) == <span class="number">3</span>);</span><br><span class="line">dsolve(eqn, cond)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例3</span></span><br><span class="line">dsolve(<span class="string">&#x27;D2y+4*Dy+29*y=0&#x27;</span>,<span class="string">&#x27;y(0)=0,Dy(0)=15&#x27;</span>,<span class="string">&#x27;x&#x27;</span>) </span><br><span class="line">syms y(x)</span><br><span class="line">eqn = (diff(y,x,<span class="number">2</span>) + <span class="number">4</span>*diff(y,x) + <span class="number">29</span>*y  == <span class="number">0</span>);</span><br><span class="line">Dy = diff(y,x);</span><br><span class="line">cond = [(y(<span class="number">0</span>) == <span class="number">0</span>), (Dy(<span class="number">0</span>) == <span class="number">15</span>)];</span><br><span class="line">dsolve(eqn, cond)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例4</span></span><br><span class="line">syms x(t) y(t) z(t)</span><br><span class="line">eqn1 = (diff(x,t)  == <span class="number">2</span>*x<span class="number">-3</span>*y+<span class="number">3</span>*z+t); <span class="comment">% 标准型</span></span><br><span class="line">eqn2 = (diff(y,t)  == <span class="number">4</span>*x<span class="number">-5</span>*y+<span class="number">3</span>*z+t); </span><br><span class="line">eqn3 = (diff(z,t)  == <span class="number">4</span>*x<span class="number">-4</span>*y+<span class="number">2</span>*z+t); </span><br><span class="line">eqns = [eqn1 eqn2 eqn3];</span><br><span class="line">[x,y,z] = dsolve(eqns)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 帮助 y 显示 mupad simplify(y) latex(y)</span></span><br></pre></td></tr></table></figure>
<h2 id="数值解">数值解</h2>
<p>不是所有的微分方程都可以求解析解。</p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210430165830666.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430170109426.png" /></p>
<p>一般使用 ode45 求解非刚性问题，obe15s 求解刚性问题。非刚性问题：未知函数随自变量的变化而缓慢，刚性问题：未知函数在某些时间段发送剧烈的变化。</p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210430170428211.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 例1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dy</span> = <span class="title">df1</span><span class="params">(x,y)</span></span></span><br><span class="line">    <span class="comment">% 微分方程：y-y&#x27;=2x（函数名称可以任意取）</span></span><br><span class="line">    <span class="comment">% 注意函数的返回值一定是因变量y的一阶导数</span></span><br><span class="line">    <span class="comment">% 函数的输入有两个，分别是自变量x和因变量y</span></span><br><span class="line">    dy = y - <span class="number">2</span>*x;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%%  设定相对误差和绝对误差，这样可以提高微分方程数值解的精度</span></span><br><span class="line">options = odeset(<span class="string">&#x27;reltol&#x27;</span>,<span class="number">1e-4</span>,<span class="string">&#x27;abstol&#x27;</span>,<span class="number">1e-8</span>);</span><br><span class="line">[x,y] = ode45(<span class="string">&#x27;df1&#x27;</span>, [<span class="number">0</span> <span class="number">2</span>], <span class="number">3</span>, options);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dy</span> = <span class="title">df2</span><span class="params">(x,y)</span> </span></span><br><span class="line">    <span class="comment">% 初始化用来储存因变量一阶导数的列向量</span></span><br><span class="line">    dy = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);  </span><br><span class="line">    dy(<span class="number">1</span>) = y(<span class="number">2</span>) * y(<span class="number">3</span>);</span><br><span class="line">    dy(<span class="number">2</span>) = -y(<span class="number">1</span>) * y(<span class="number">3</span>);</span><br><span class="line">    dy(<span class="number">3</span>) = <span class="number">-0.51</span> * y(<span class="number">1</span>) * y(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">[x, y] = ode45(<span class="string">&#x27;df2&#x27;</span>, [<span class="number">0</span> <span class="number">4</span>*<span class="built_in">pi</span>], [<span class="number">0</span> <span class="number">1</span> <span class="number">1</span>]) <span class="comment">% 因变量初始值</span></span><br><span class="line"><span class="built_in">plot</span>(x, y(:,<span class="number">1</span>), <span class="string">&#x27;o&#x27;</span>, x, y(:,<span class="number">2</span>), <span class="string">&#x27;*&#x27;</span>, x, y(:,<span class="number">3</span>), <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;y1&#x27;</span>,<span class="string">&#x27;y2&#x27;</span>,<span class="string">&#x27;y3&#x27;</span>)</span><br><span class="line">axis([<span class="number">0</span> <span class="number">4</span>*<span class="built_in">pi</span> -<span class="built_in">inf</span> +<span class="built_in">inf</span>])</span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210430171353632.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 例3</span></span><br><span class="line"><span class="comment">% 有解析解了可以不用求数值解，只是做对比</span></span><br><span class="line">dsolve(<span class="string">&#x27;(1+x*x)*D2y=2*x*Dy&#x27;</span>,<span class="string">&#x27;y(-2)=3, Dy(-2)=4&#x27;</span>,<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = <span class="number">-2</span>:<span class="number">0.01</span>:<span class="number">2</span>;</span><br><span class="line">y = (<span class="number">4</span>*x.*(x.^<span class="number">2</span> + <span class="number">3</span>))/<span class="number">15</span> + <span class="number">101</span>/<span class="number">15</span>;</span><br><span class="line"><span class="built_in">plot</span>(x, y, <span class="string">&#x27;b-&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dy</span>=<span class="title">df3</span><span class="params">(x,y)</span> </span></span><br><span class="line">    dy=<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    dy(<span class="number">1</span>)=y(<span class="number">2</span>);</span><br><span class="line">    dy(<span class="number">2</span>)=(<span class="number">2</span>*x)/(<span class="number">1</span>+x*x)*y(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">[x,y] = ode45(<span class="string">&#x27;df3&#x27;</span>,[<span class="number">-2</span> <span class="number">2</span>], [<span class="number">3</span> <span class="number">4</span>]); <span class="comment">% 在自变量 2 2 上求解，在 2 上的初值条件</span></span><br><span class="line"><span class="built_in">plot</span>(x,y(:,<span class="number">1</span>), <span class="string">&#x27;r*&#x27;</span>) <span class="comment">% 注意，y变量有两列，第一列是y1(我们要求的y)，第二列是y2(y的一阶导数) </span></span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210430172254417.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dy</span>=<span class="title">df4</span><span class="params">(x,y)</span></span></span><br><span class="line">    dy = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    dy(<span class="number">1</span>) = y(<span class="number">2</span>);</span><br><span class="line">    dy(<span class="number">2</span>) = <span class="number">1000</span>*(<span class="number">1</span>-y(<span class="number">1</span>)^<span class="number">2</span>)*y(<span class="number">2</span>)-y(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">[x,y] = ode15s(<span class="string">&#x27;df4&#x27;</span>,[<span class="number">0</span> <span class="number">3000</span>], [<span class="number">2</span> <span class="number">0</span>]);  <span class="comment">% 求出这个微分方程的数值解</span></span><br><span class="line"><span class="built_in">plot</span>(x,y(:,<span class="number">1</span>),<span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="例题">例题</h2>
<h3 id="导弹追击">1. 导弹追击</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210430182230353.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dy</span>=<span class="title">df5</span><span class="params">(t,y)</span> % <span class="title">x</span> 和 <span class="title">y</span> 是要观察的因变量，<span class="title">t</span> 是自变量</span></span><br><span class="line">    v = <span class="number">200</span>; </span><br><span class="line">    dy=<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    dy(<span class="number">1</span>)=<span class="number">3</span>*v*(<span class="number">20</span>+<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">1</span>))/<span class="built_in">sqrt</span>((<span class="number">20</span>+<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">1</span>))^<span class="number">2</span>+(<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">2</span>))^<span class="number">2</span>);</span><br><span class="line">    dy(<span class="number">2</span>)=<span class="number">3</span>*v*(<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">2</span>))/<span class="built_in">sqrt</span>((<span class="number">20</span>+<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">1</span>))^<span class="number">2</span>+(<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t-y(<span class="number">2</span>))^<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">options = odeset(<span class="string">&#x27;reltol&#x27;</span>,<span class="number">1e-4</span>,<span class="string">&#x27;abstol&#x27;</span>,<span class="number">1e-8</span>); </span><br><span class="line">[t, y] = ode45(<span class="string">&#x27;df5&#x27;</span> ,[<span class="number">0</span> <span class="number">0.1</span>], [<span class="number">0</span> <span class="number">0</span>], options); <span class="comment">% 导弹速度为 200 自变量时间区间跟这个相关</span></span><br><span class="line">x = y(:,<span class="number">1</span>);  </span><br><span class="line">y = y(:,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(x, y, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;MarkerSize&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>([<span class="number">20</span> <span class="number">30</span>], [<span class="number">0</span> <span class="number">10</span>]) <span class="comment">% 船的轨迹</span></span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"></span><br><span class="line"><span class="comment">% 找到导弹与B船相撞的点</span></span><br><span class="line">n = <span class="built_in">length</span>(t);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    d = t(<span class="built_in">i</span>) * v * <span class="number">3</span>;</span><br><span class="line">    dd = <span class="built_in">sqrt</span>((x(<span class="built_in">i</span>)-(<span class="number">20</span>+<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t(<span class="built_in">i</span>)))^<span class="number">2</span>+(y(<span class="built_in">i</span>)-<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>*v*t(<span class="built_in">i</span>))^<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> dd &lt; <span class="number">0.01</span> <span class="comment">% 成功相撞</span></span><br><span class="line">    	<span class="keyword">if</span> d &lt;= <span class="number">50</span></span><br><span class="line">    		<span class="built_in">disp</span>([<span class="string">&#x27;导弹飞行&#x27;</span> num2str(d) <span class="string">&#x27;单位后击中B船&#x27;</span>])</span><br><span class="line">    		<span class="built_in">disp</span>([<span class="string">&#x27;导弹飞行的时间为&#x27;</span> num2str(t(<span class="built_in">i</span>)*<span class="number">60</span>) <span class="string">&#x27;分钟&#x27;</span>])</span><br><span class="line">    		<span class="built_in">disp</span>(<span class="string">&#x27;击中点的坐标：&#x27;</span>);  </span><br><span class="line">    		<span class="built_in">disp</span>([x(<span class="built_in">i</span>) y(<span class="built_in">i</span>)])</span><br><span class="line">    		<span class="built_in">plot</span>(x(<span class="built_in">i</span>), y(<span class="built_in">i</span>), <span class="string">&#x27;r*&#x27;</span>);</span><br><span class="line">    		text(x(<span class="built_in">i</span>)+<span class="number">0.5</span>, y(<span class="built_in">i</span>)+<span class="number">0.1</span>, <span class="string">&#x27;击中点&#x27;</span>)</span><br><span class="line">    	<span class="keyword">end</span></span><br><span class="line">    	<span class="keyword">break</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> d &gt;<span class="number">50</span> || dd &gt;= <span class="number">0.01</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;导弹没有击中B船&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="人口预测模型">2. 人口预测模型</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506135804719.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506140146056.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% Malthus模型（马尔萨斯模型）</span></span><br><span class="line">x = dsolve(<span class="string">&#x27;Dx=r*x&#x27;</span>, <span class="string">&#x27;x(0)=x0&#x27;</span>, <span class="string">&#x27;t&#x27;</span>) </span><br><span class="line"><span class="comment">% 把上面这个式子中的 x0 和 r 替换成确定的值</span></span><br><span class="line">x0 = <span class="number">100</span>; </span><br><span class="line">r = <span class="number">0.1</span>;</span><br><span class="line">subs(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 初始人口为1000，画出50年且增长率分别为0.5%，1%，1.5% 一直到5%的人口变化曲线</span></span><br><span class="line">x0 = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">10</span></span><br><span class="line">    r = <span class="number">0.005</span> * <span class="built_in">i</span>;</span><br><span class="line">    xx = subs(x);</span><br><span class="line">    fplot(xx,[<span class="number">0</span>,<span class="number">50</span>])   <span class="comment">% fplot函数可以绘制表达式的图形</span></span><br><span class="line">    <span class="built_in">hold</span> on</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 阻滞增长模型（logistic模型）</span></span><br><span class="line">x = dsolve(<span class="string">&#x27;Dx=r*(1-x/xm)*x&#x27;</span>,<span class="string">&#x27;x(t0)=x0&#x27;</span>,<span class="string">&#x27;t&#x27;</span>)   <span class="comment">% 化简后和书上的结果一样</span></span><br><span class="line"><span class="comment">% mupad</span></span><br><span class="line">t0 = <span class="number">0</span>;</span><br><span class="line">x0 = <span class="number">1000</span>;</span><br><span class="line">xm = <span class="number">10000</span>;</span><br><span class="line">r = <span class="number">0.05</span>;</span><br><span class="line">xx = subs(x);    <span class="comment">%  10000/(exp(log(9) - t/20) + 1)</span></span><br><span class="line">fplot(xx,[<span class="number">0</span>,<span class="number">200</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题拟合解答</span></span><br><span class="line">cftool</span><br><span class="line"><span class="comment">% 拟合方式选择：Custom Equation (自定义方程)</span></span><br><span class="line"><span class="comment">% 修改下方的方框为：x = f(t) = xm/(1+(xm/3.9-1)*exp(-r*(t-1790)))</span></span><br><span class="line">[fitresult, gof] = createFit(year, population) </span><br><span class="line">t = <span class="number">2001</span>:<span class="number">2030</span>;</span><br><span class="line">xm = <span class="number">342.4</span>;</span><br><span class="line">r =  <span class="number">0.02735</span>;</span><br><span class="line">predictions = xm./(<span class="number">1</span>+(xm./<span class="number">3.9</span><span class="number">-1</span>).*<span class="built_in">exp</span>(-r.*(t<span class="number">-1790</span>)));  <span class="comment">% 计算预测值（注意这里要写成点乘和点除）</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(year,population,<span class="string">&#x27;o&#x27;</span>,t,predictions,<span class="string">&#x27;.&#x27;</span>)  <span class="comment">% 绘制预测结果图</span></span><br><span class="line"><span class="built_in">disp</span>(predictions)  <span class="comment">% 预测的数值</span></span><br></pre></td></tr></table></figure>
<h3 id="捕食者猎物模型">3. 捕食者猎物模型</h3>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506141512463.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">pre_war</span><span class="params">(t,x)</span></span></span><br><span class="line">    dx=<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>); </span><br><span class="line">    dx(<span class="number">1</span>)=x(<span class="number">1</span>)*(<span class="number">0.7</span><span class="number">-0.1</span>*x(<span class="number">2</span>));</span><br><span class="line">    dx(<span class="number">2</span>)=x(<span class="number">2</span>)*(<span class="number">-0.8</span>+<span class="number">0.02</span>*x(<span class="number">1</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">post_war</span><span class="params">(t,x)</span></span></span><br><span class="line">    dx=<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>); </span><br><span class="line">    dx(<span class="number">1</span>)=x(<span class="number">1</span>)*(<span class="number">0.9</span><span class="number">-0.1</span>*x(<span class="number">2</span>));</span><br><span class="line">    dx(<span class="number">2</span>)=x(<span class="number">2</span>)*(<span class="number">-0.6</span>+<span class="number">0.02</span>*x(<span class="number">1</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">[t1,x1]=ode45(<span class="string">&#x27;pre_war&#x27;</span>,[<span class="number">0</span> <span class="number">15</span>],[<span class="number">25</span> <span class="number">2</span>]);</span><br><span class="line">[t2,x2]=ode45(<span class="string">&#x27;post_war&#x27;</span>,[<span class="number">0</span> <span class="number">15</span>],[<span class="number">25</span> <span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">pre_prey=x1(:,<span class="number">1</span>); pre_shark=x1(:,<span class="number">2</span>); </span><br><span class="line">post_prey=x2(:,<span class="number">1</span>); post_shark=x2(:,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(pre_prey,pre_shark,<span class="string">&#x27;--r&#x27;</span>,post_prey,post_shark,<span class="string">&#x27;-b&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;战前&#x27;</span>,<span class="string">&#x27;战后&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;鲨鱼和食饵数量变化的相轨线图&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;食饵数量&#x27;</span>)   </span><br><span class="line">ylabel(<span class="string">&#x27;鲨鱼数量&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(t1,pre_prey,<span class="string">&#x27;--r&#x27;</span>,t1,pre_shark,<span class="string">&#x27;-r&#x27;</span>,t2,post_prey,<span class="string">&#x27;--b&#x27;</span>,t2,post_shark,<span class="string">&#x27;-b&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;战前食饵数量&#x27;</span>,<span class="string">&#x27;战前鲨鱼数量&#x27;</span>,<span class="string">&#x27;战后食饵数量&#x27;</span>,<span class="string">&#x27;战后鲨鱼数量&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;数量&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pre_rate=pre_shark./(pre_prey+pre_shark);  <span class="comment">% 战前的鲨鱼比例    </span></span><br><span class="line">post_rate=post_shark./(post_prey+post_shark);   <span class="comment">% 战后的鲨鱼比例</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(t1,pre_rate,<span class="string">&#x27;--r&#x27;</span>,t2,post_rate,<span class="string">&#x27;-b&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;战前的鲨鱼比例&#x27;</span>,<span class="string">&#x27;战后的鲨鱼比例&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506142901253.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506142919719.png" /></p>
<h3 id="种族竞争模型">4. 种族竞争模型</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506144305893.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506144333355.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506144505663.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun</span><span class="params">(t,x)</span> </span></span><br><span class="line">    r1=<span class="number">0.5</span>;  r2=<span class="number">0.5</span>; <span class="comment">% 甲乙的增长率</span></span><br><span class="line">    N1=<span class="number">300</span>;   N2=<span class="number">500</span>;   <span class="comment">% 甲乙的最大数量</span></span><br><span class="line">    sigma1=<span class="number">0.5</span>;  sigma2=<span class="number">2</span>;   </span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = r1*x(<span class="number">1</span>)*(<span class="number">1</span>-x(<span class="number">1</span>)/N1-sigma1*x(<span class="number">2</span>)/N2);</span><br><span class="line">    dx(<span class="number">2</span>) = r2*x(<span class="number">2</span>)*(<span class="number">1</span>-x(<span class="number">2</span>)/N2-sigma2*x(<span class="number">1</span>)/N1);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun&#x27;</span>,[<span class="number">0</span> <span class="number">30</span>],[<span class="number">80</span> <span class="number">100</span>]); </span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>)  <span class="comment">% x的第一列是甲种群数量，x的第二列是乙种群数量</span></span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;种群甲&#x27;</span>,<span class="string">&#x27;种群乙&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="传染病模型">传染病模型</h2>
<h3 id="si-模型">SI 模型</h3>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506183004501.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506183218046.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184008150.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506184126070.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506184423765.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506184742654.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% SI 模型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun1</span><span class="params">(t,x)</span>   % 大家可以修改里面的参数，来看结果的变化</span></span><br><span class="line">    <span class="keyword">global</span> TOTAL_N   <span class="comment">% 定义总人数为全局变量</span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;  <span class="comment">% 易感染者与已感染者接触且被传染的强度</span></span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);  <span class="comment">% x(1)表示S  x(2)表示I</span></span><br><span class="line">    dx(<span class="number">1</span>) = -<span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun2</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="keyword">global</span> TOTAL_N</span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">60</span></span><br><span class="line">        <span class="built_in">beta</span> = <span class="built_in">beta</span>/<span class="number">10</span>; <span class="comment">% 第60期后禁止大规模聚会，使得传染强度beta缩小为原来的10倍</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);  </span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun3</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>; </span><br><span class="line">    u = <span class="number">0.002</span>;  <span class="comment">% 人口出生率</span></span><br><span class="line">    v = <span class="number">0.001</span>;  <span class="comment">% 自然死亡率</span></span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);  <span class="comment">% x(3)表示自然死亡人数ND</span></span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>)) +u*(x(<span class="number">1</span>)+x(<span class="number">2</span>)) - v*x(<span class="number">1</span>);  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>)) - v*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = v*x(<span class="number">1</span>) + v*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun4</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    d = <span class="number">0.01</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>); </span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>)) ;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>)) -d*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = d*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun5</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    d = <span class="number">0.01</span>;</span><br><span class="line">    u = <span class="number">0.002</span>;</span><br><span class="line">    v = <span class="number">0.001</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">4</span>,<span class="number">1</span>);  </span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>))+u*(x(<span class="number">1</span>)+x(<span class="number">2</span>)) - v*x(<span class="number">1</span>) ;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/(x(<span class="number">1</span>)+x(<span class="number">2</span>)) -d*x(<span class="number">2</span>)- v*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = d*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">4</span>) = v*x(<span class="number">1</span>) + v*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> TOTAL_N   <span class="comment">% 定义总人数为全局变量（可以在子函数中使用）</span></span><br><span class="line">TOTAL_N = <span class="number">1000</span>;  <span class="comment">% 总人数</span></span><br><span class="line">i0 = <span class="number">1</span>; <span class="comment">% 初始时刻患者（已感染者）的人数</span></span><br><span class="line">[t, x] = ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">200</span>],[TOTAL_N-i0 i0]);</span><br><span class="line">x = <span class="built_in">round</span>(x); <span class="comment">% 四舍五入整数</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>)</span><br><span class="line"></span><br><span class="line">[t,x1]=ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0]);   <span class="comment">% 原来调用fun1，返回x1</span></span><br><span class="line">[t,x2]=ode45(<span class="string">&#x27;fun2&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0]);   <span class="comment">% 禁止大规模聚会后调用fun2，返回x2</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x1(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x1(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)  </span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(t,x2(:,<span class="number">1</span>),<span class="string">&#x27;r--&#x27;</span>,t,x2(:,<span class="number">2</span>),<span class="string">&#x27;b--&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>) </span><br><span class="line">axis([<span class="number">0</span> <span class="number">500</span> <span class="number">0</span> <span class="number">1000</span>])</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;原来S&#x27;</span>,<span class="string">&#x27;原来I&#x27;</span>,<span class="string">&#x27;现在S&#x27;</span>,<span class="string">&#x27;现在I&#x27;</span>)</span><br><span class="line"></span><br><span class="line">TOTAL_N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun3&#x27;</span>,[<span class="number">1</span>:<span class="number">200</span>],[TOTAL_N-i0 i0 <span class="number">0</span>]);  <span class="comment">% 别忘了给ND初始值0</span></span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)   </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;自然死亡人数ND&#x27;</span>)</span><br><span class="line"></span><br><span class="line">TOTAL_N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun4&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0 <span class="number">0</span>]);</span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)   </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;患病死亡人数ID&#x27;</span>)</span><br><span class="line"></span><br><span class="line">TOTAL_N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun5&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0 <span class="number">0</span> <span class="number">0</span>]);</span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">7</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;k-&#x27;</span>,t,x(:,<span class="number">4</span>),<span class="string">&#x27;g-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;患病死亡人数ID&#x27;</span>,<span class="string">&#x27;自然死亡人数ND&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sis-模型">SIS 模型</h3>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506190155264.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun1</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="keyword">global</span> TOTAL_N</span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>; </span><br><span class="line">    alpha = <span class="number">0.06</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = alpha*x(<span class="number">2</span>) - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N - alpha*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> TOTAL_N </span><br><span class="line">TOTAL_N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0]); </span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sir-模型">SIR 模型</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190559107.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506190656006.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506190715078.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun1</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.02</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - <span class="built_in">gamma</span>*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">newfun2</span><span class="params">(t,x,GAMMA)</span>   % 把<span class="title">GAMMA</span>当成参数传入进来</span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - GAMMA*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = GAMMA*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun4</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.02</span>;</span><br><span class="line">    d = <span class="number">0.005</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - <span class="built_in">gamma</span>*x(<span class="number">2</span>) -d*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">4</span>) = d*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = <span class="number">1000</span>; </span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[N-i0 i0 <span class="number">0</span>]);</span><br><span class="line">x = <span class="built_in">round</span>(x); </span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)  </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;康复者R&#x27;</span>)</span><br><span class="line"></span><br><span class="line">clc;clear</span><br><span class="line">N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">c = jet(<span class="number">5</span>);  </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">5</span></span><br><span class="line">    GAMMA = <span class="number">0.01</span>*<span class="built_in">i</span>;   <span class="comment">% 在循环中来改变康复率GAMMA的值</span></span><br><span class="line">    [t,x]=ode45(@(t,x) newfun2(t,x,GAMMA),[<span class="number">1</span>:<span class="number">500</span>],[N-i0 i0 <span class="number">0</span>]);  </span><br><span class="line">    x = <span class="built_in">round</span>(x);</span><br><span class="line">    <span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">plot</span>(t, x(:,<span class="number">2</span>), <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;color&#x27;</span>, c(<span class="built_in">i</span>,:),<span class="string">&#x27;DisplayName&#x27;</span>,num2str(GAMMA),<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>) </span><br><span class="line">    <span class="built_in">hold</span> on</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">legend</span> show</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 考虑疾病的死亡率的SIR模型</span></span><br><span class="line">clc;clear</span><br><span class="line">N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun4&#x27;</span>,[<span class="number">1</span>:<span class="number">400</span>],[N-i0 i0 <span class="number">0</span> <span class="number">0</span>]);</span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,t,x(:,<span class="number">4</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)   </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;康复者R&#x27;</span>,<span class="string">&#x27;患病死亡人数ID&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sirs-模型">SIRS 模型</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191229891.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191341235.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210506191459687.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun1</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="keyword">global</span> TOTAL_N </span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>; </span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.03</span>;</span><br><span class="line">    alpha = <span class="number">0.01</span>; </span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N + alpha*x(<span class="number">3</span>) ;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/TOTAL_N - <span class="built_in">gamma</span>*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>) - alpha*x(<span class="number">3</span>) ;  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun2</span><span class="params">(t,x)</span> </span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>; </span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.03</span>;</span><br><span class="line">    alpha = <span class="number">0.01</span>; </span><br><span class="line">    d = <span class="number">0.005</span>; </span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>)+x(<span class="number">3</span>); </span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C + alpha*x(<span class="number">3</span>) ;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - <span class="built_in">gamma</span>*x(<span class="number">2</span>)-d*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>) - alpha*x(<span class="number">3</span>) ;  </span><br><span class="line">    dx(<span class="number">4</span>) = d*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun3</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    gamma1 = <span class="number">0.01</span>;</span><br><span class="line">    gamma2 = <span class="number">0.01</span>;</span><br><span class="line">    alpha = <span class="number">0.01</span>;</span><br><span class="line">    d = <span class="number">0.005</span>;</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>)+x(<span class="number">4</span>);  <span class="comment">% 传染病系统中的有效人群,也就是课件中的N&#x27; = S+I+R2</span></span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">1</span>);  <span class="comment">% x(1)表示S  x(2)表示I x(3)表示R1 x(4)表示R2 x(5)表示ID</span></span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C + alpha*x(<span class="number">4</span>) ;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - gamma1*x(<span class="number">2</span>)-gamma2*x(<span class="number">2</span>)-d*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = gamma1*x(<span class="number">2</span>) ;  </span><br><span class="line">    dx(<span class="number">4</span>) = gamma2*x(<span class="number">2</span>) - alpha*x(<span class="number">4</span>) ;  </span><br><span class="line">    dx(<span class="number">5</span>) = d*x(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% SIRS模型</span></span><br><span class="line">clc;clear</span><br><span class="line"><span class="keyword">global</span> TOTAL_N </span><br><span class="line">TOTAL_N = <span class="number">1000</span>; </span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[TOTAL_N-i0 i0 <span class="number">0</span>]); </span><br><span class="line">x = <span class="built_in">round</span>(x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)     </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;康复者R&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%%  引入疾病的死亡率d后的SIRS模型</span></span><br><span class="line">clc;clear</span><br><span class="line">N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line">[t,x1]=ode45(<span class="string">&#x27;fun2&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[N-i0 i0 <span class="number">0</span> <span class="number">0</span>]);</span><br><span class="line">x1 = <span class="built_in">round</span>(x1); </span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x1(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x1(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x1(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,t,x1(:,<span class="number">4</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)   </span><br><span class="line">title(<span class="string">&#x27;500期&#x27;</span>)</span><br><span class="line">[t,x2]=ode45(<span class="string">&#x27;fun2&#x27;</span>,[<span class="number">1</span>:<span class="number">2000</span>],[N-i0 i0 <span class="number">0</span> <span class="number">0</span>]);  </span><br><span class="line">x2 = <span class="built_in">round</span>(x2);  </span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x2(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x2(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x2(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,t,x2(:,<span class="number">4</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)    </span><br><span class="line">title(<span class="string">&#x27;2000期&#x27;</span>)</span><br><span class="line">[t,x3]=ode45(<span class="string">&#x27;fun2&#x27;</span>,[<span class="number">1</span>:<span class="number">8000</span>],[N-i0 i0 <span class="number">0</span> <span class="number">0</span>]);  </span><br><span class="line">x3 = <span class="built_in">round</span>(x3);  </span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,[<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">plot</span>(t,x3(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x3(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x3(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,t,x3(:,<span class="number">4</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)    </span><br><span class="line">title(<span class="string">&#x27;8000期&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;康复者R&#x27;</span>,<span class="string">&#x27;患病死亡人数ID&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%%  引入完全康复者和暂时康复者的模型</span></span><br><span class="line">clc;clear</span><br><span class="line">N = <span class="number">1000</span>;</span><br><span class="line">i0 = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line">[t,x]=ode45(<span class="string">&#x27;fun3&#x27;</span>,[<span class="number">1</span>:<span class="number">1000</span>],[N-i0 i0 <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]);</span><br><span class="line">x = <span class="built_in">round</span>(x); </span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;b-&#x27;</span>,t,x(:,<span class="number">3</span>),<span class="string">&#x27;g-&#x27;</span>,t,x(:,<span class="number">4</span>),<span class="string">&#x27;m-&#x27;</span>,t,x(:,<span class="number">5</span>),<span class="string">&#x27;k-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)     </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;完全康复者R1&#x27;</span>,<span class="string">&#x27;暂时康复者R2&#x27;</span>,<span class="string">&#x27;患病死亡人数ID&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="seir-模型">SEIR 模型</h3>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506191921766.png" /></p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210506192001574.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun1</span><span class="params">(t,x)</span></span></span><br><span class="line">    <span class="built_in">beta</span> = <span class="number">0.1</span>;</span><br><span class="line">    sigma = <span class="number">0.2</span>;</span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.02</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>)+x(<span class="number">3</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">3</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">3</span>)/C - sigma*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = sigma*x(<span class="number">2</span>) - <span class="built_in">gamma</span>*x(<span class="number">3</span>);</span><br><span class="line">    dx(<span class="number">4</span>) = <span class="built_in">gamma</span>*x(<span class="number">3</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">fun2</span><span class="params">(t,x)</span></span></span><br><span class="line">    beta1 = <span class="number">0.1</span>;</span><br><span class="line">    beta2 = <span class="number">0.05</span>;</span><br><span class="line">    sigma = <span class="number">0.2</span>;</span><br><span class="line">    <span class="built_in">gamma</span> = <span class="number">0.02</span>;</span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>)+x(<span class="number">3</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - beta1*x(<span class="number">1</span>)*x(<span class="number">3</span>)/C  -  beta2*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = beta1*x(<span class="number">1</span>)*x(<span class="number">3</span>)/C + beta2*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - sigma*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = sigma*x(<span class="number">2</span>) - <span class="built_in">gamma</span>*x(<span class="number">3</span>);</span><br><span class="line">    dx(<span class="number">4</span>) = <span class="built_in">gamma</span>*x(<span class="number">3</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 把两个图放到一起看看区别</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line">[t,x1]=ode45(<span class="string">&#x27;fun1&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[N-i0 <span class="number">0</span> i0 <span class="number">0</span>]);  </span><br><span class="line"><span class="built_in">plot</span>(t,x1(:,<span class="number">1</span>),<span class="string">&#x27;r-&#x27;</span>,t,x1(:,<span class="number">2</span>),<span class="string">&#x27;m-&#x27;</span>,t,x1(:,<span class="number">3</span>),<span class="string">&#x27;b-&#x27;</span>,t,x1(:,<span class="number">4</span>),<span class="string">&#x27;g-&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)    </span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">[t,x2]=ode45(<span class="string">&#x27;fun2&#x27;</span>,[<span class="number">1</span>:<span class="number">500</span>],[N-i0 <span class="number">0</span> i0 <span class="number">0</span>]);  </span><br><span class="line"><span class="built_in">plot</span>(t,x2(:,<span class="number">1</span>),<span class="string">&#x27;r--&#x27;</span>,t,x2(:,<span class="number">2</span>),<span class="string">&#x27;m--&#x27;</span>,t,x2(:,<span class="number">3</span>),<span class="string">&#x27;b--&#x27;</span>,t,x2(:,<span class="number">4</span>),<span class="string">&#x27;g--&#x27;</span>,<span class="string">&#x27;Linewidth&#x27;</span>,<span class="number">1.5</span>)    </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;易感染者S&#x27;</span>,<span class="string">&#x27;潜伏者E&#x27;</span>,<span class="string">&#x27;患者I&#x27;</span>,<span class="string">&#x27;康复者R&#x27;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/6/">6</a><a class="extend next" rel="next" href="/blog/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hauk</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



</body>
</html>
