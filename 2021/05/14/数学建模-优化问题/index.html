<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"stabunkow.github.io","root":"/blog/","images":"/blog/images","scheme":"Muse","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>
<meta name="description" content="数学规划  线性规划 如果目标函数和和约束条件均是决策变量的线性表达式,那么此时的数学规划问题就属于线性规划。   1234567891011121314151617181920212223242526272829303132333435363738%% 例题1c &#x3D; [-5 -4 -6]&amp;#x27;; % 写成行向量也是可以的A &#x3D; [    1 -1 1;    3 2 4;    3 2 0">
<meta property="og:type" content="article">
<meta property="og:title" content="数学建模-优化问题">
<meta property="og:url" content="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98/index.html">
<meta property="og:site_name" content="Hauk&#39;s Blog">
<meta property="og:description" content="数学规划  线性规划 如果目标函数和和约束条件均是决策变量的线性表达式,那么此时的数学规划问题就属于线性规划。   1234567891011121314151617181920212223242526272829303132333435363738%% 例题1c &#x3D; [-5 -4 -6]&amp;#x27;; % 写成行向量也是可以的A &#x3D; [    1 -1 1;    3 2 4;    3 2 0">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425185835489.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190223927.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190250407.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190532041.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425192628046.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425193423794.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425193802171.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogblogimage-20210425200206123.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201539702.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201628772.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201719783.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201809371.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425203536218.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425203851291.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425204232967.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425204631254.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425205318579.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425210947064.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507165801029.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170357350.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170644228.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170720440.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170902046.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183714036.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183831944.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512194910668.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507184434122.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507185005010.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507185516251.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507190056144.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507171252968.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507171421720.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183011706.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183034830.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507191129731.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507191200603.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192036403.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192447225.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192510192.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507193816758.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507194051903.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200152554.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200250193.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200306931.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512170256977.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512170513793.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512171433178.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512181751107.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512171650540.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512182034071.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512181413884.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512183822688.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512183859684.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185127265.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185226456.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185320870.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185348249.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512191154391.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512191125701.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192158999.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192230493.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192440424.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192614752.png">
<meta property="og:image" content="c:/Users/admin/AppData/Roaming/Typora/typora-user-images/image-20210511185624354.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426210952593-927305408.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426211028991-1719003432.png">
<meta property="og:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426211101818-1132986484.png">
<meta property="article:published_time" content="2021-05-14T04:24:41.000Z">
<meta property="article:modified_time" content="2021-05-14T13:33:49.329Z">
<meta property="article:author" content="Hauk">
<meta property="article:tag" content="数学建模">
<meta property="article:tag" content="优化问题">
<meta property="article:tag" content="启发式算法">
<meta property="article:tag" content="数学规划">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425185835489.png">


<link rel="canonical" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>数学建模-优化问题 | Hauk's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hauk's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">~ o ha yo ~</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E8%A7%84%E5%88%92"><span class="nav-number">1.</span> <span class="nav-text">数学规划</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="nav-number">1.1.</span> <span class="nav-text">线性规划</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981%E7%94%9F%E4%BA%A7%E5%86%B3%E7%AD%96"><span class="nav-number">1.1.1.</span> <span class="nav-text">例题1：生产决策</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%982%E6%8A%95%E6%96%99%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.2.</span> <span class="nav-text">例题2：投料问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="nav-number">1.2.</span> <span class="nav-text">非线性规划</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981%E9%80%89%E5%9D%80%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.1.</span> <span class="nav-text">例题1：选址问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%982%E9%A3%9E%E8%A1%8C%E7%AE%A1%E7%90%86%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.2.</span> <span class="nav-text">例题2：飞行管理问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E6%95%B0%E8%A7%84%E5%88%92"><span class="nav-number">1.3.</span> <span class="nav-text">整数规划</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.1.</span> <span class="nav-text">例题1：背包问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%982%E6%8C%87%E6%B4%BE%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.2.</span> <span class="nav-text">例题2：指派问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%983%E9%92%A2%E7%AE%A1%E5%88%87%E5%89%B2%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.3.</span> <span class="nav-text">例题3：钢管切割问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.4.</span> <span class="nav-text">最大最小化模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E7%9B%AE%E6%A0%87%E8%A7%84%E5%88%92%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.5.</span> <span class="nav-text">多目标规划模型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%AF%E5%8F%91%E5%BC%8F%E7%AE%97%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">启发式算法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B2%92%E5%AD%90%E7%BE%A4%E7%AE%97%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">粒子群算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">3.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E6%AD%A5%E9%AA%A4"><span class="nav-number">3.2.</span> <span class="nav-text">关键步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%87%8D%E6%94%B9%E8%BF%9B"><span class="nav-number">3.2.1.</span> <span class="nav-text">权重改进</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E5%9B%A0%E5%AD%90%E6%94%B9%E8%BF%9B"><span class="nav-number">3.2.2.</span> <span class="nav-text">学习因子改进</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E7%BB%88%E6%AD%A2%E6%9D%A1%E4%BB%B6"><span class="nav-number">3.2.3.</span> <span class="nav-text">搜索终止条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="nav-number">3.3.</span> <span class="nav-text">例题解决</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#matlab-%E5%B7%A5%E5%85%B7%E7%AE%B1"><span class="nav-number">3.4.</span> <span class="nav-text">Matlab 工具箱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6"><span class="nav-number">3.5.</span> <span class="nav-text">进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E7%A8%8B%E7%BB%84%E6%B1%82%E8%A7%A3"><span class="nav-number">3.5.1.</span> <span class="nav-text">方程组求解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%83%E5%87%BD%E6%95%B0%E6%8B%9F%E5%90%88"><span class="nav-number">3.5.2.</span> <span class="nav-text">多元函数拟合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%8B%9F%E5%90%88%E5%8F%82%E6%95%B0%E9%80%89%E5%8F%96"><span class="nav-number">3.5.3.</span> <span class="nav-text">微分方程拟合参数选取</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E7%AE%97%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">模拟退火算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8E%E7%B2%92%E5%AD%90%E7%BE%A4%E7%AE%97%E6%B3%95%E5%AF%B9%E6%AF%94"><span class="nav-number">4.1.</span> <span class="nav-text">与粒子群算法对比</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E5%85%A5"><span class="nav-number">4.2.</span> <span class="nav-text">引入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E6%AD%A5%E9%AA%A4-1"><span class="nav-number">4.3.</span> <span class="nav-text">关键步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E7%8E%87%E8%AE%BE%E7%BD%AE"><span class="nav-number">4.3.1.</span> <span class="nav-text">概率设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E7%BB%88%E6%AD%A2%E6%9D%A1%E4%BB%B6-1"><span class="nav-number">4.3.2.</span> <span class="nav-text">搜索终止条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98%E8%A7%A3%E5%86%B3-1"><span class="nav-number">4.4.</span> <span class="nav-text">例题解决</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B1-%E6%B1%82%E7%BB%99%E5%AE%9A%E5%87%BD%E6%95%B0%E6%9C%80%E5%80%BC"><span class="nav-number">4.4.1.</span> <span class="nav-text">例1 求给定函数最值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B2-%E6%97%85%E8%A1%8C%E5%95%86%E9%97%AE%E9%A2%98"><span class="nav-number">4.4.2.</span> <span class="nav-text">例2 旅行商问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B3-%E4%B9%B0%E4%B9%A6%E9%97%AE%E9%A2%98"><span class="nav-number">4.4.3.</span> <span class="nav-text">例3 买书问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#matlab-%E5%B7%A5%E5%85%B7%E7%AE%B1-1"><span class="nav-number">4.5.</span> <span class="nav-text">Matlab 工具箱</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95"><span class="nav-number">5.</span> <span class="nav-text">遗传算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="nav-number">5.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E6%AD%A5%E9%AA%A4-2"><span class="nav-number">5.2.</span> <span class="nav-text">关键步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81"><span class="nav-number">5.2.1.</span> <span class="nav-text">编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%82%E5%BA%94%E5%BA%A6%E5%87%BD%E6%95%B0"><span class="nav-number">5.2.2.</span> <span class="nav-text">适应度函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9"><span class="nav-number">5.2.3.</span> <span class="nav-text">选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E5%8F%89"><span class="nav-number">5.2.4.</span> <span class="nav-text">交叉</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E5%BC%82"><span class="nav-number">5.2.5.</span> <span class="nav-text">变异</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E9%80%82%E5%BA%94"><span class="nav-number">5.2.6.</span> <span class="nav-text">自适应</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C"><span class="nav-number">5.2.7.</span> <span class="nav-text">运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#matlab-%E5%B7%A5%E5%85%B7%E7%AE%B1-2"><span class="nav-number">5.3.</span> <span class="nav-text">Matlab 工具箱</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Hauk</p>
  <div class="site-description" itemprop="description">Try to write something.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives">
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://stabunkow.github.io/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Hauk">
      <meta itemprop="description" content="Try to write something.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hauk's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数学建模-优化问题
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-05-14 12:24:41 / 修改时间：21:33:49" itemprop="dateCreated datePublished" datetime="2021-05-14T12:24:41+08:00">2021-05-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="数学规划">数学规划</h1>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425185835489.png" /></p>
<h2 id="线性规划">线性规划</h2>
<p>如果目标函数和和约束条件均是决策变量的线性表达式,那么此时的数学规划问题就属于线性规划。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190223927.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190250407.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 例题1</span></span><br><span class="line">c = [<span class="number">-5</span> <span class="number">-4</span> <span class="number">-6</span>]&#x27;; <span class="comment">% 写成行向量也是可以的</span></span><br><span class="line">A = [</span><br><span class="line">    <span class="number">1</span> <span class="number">-1</span> <span class="number">1</span>;</span><br><span class="line">    <span class="number">3</span> <span class="number">2</span> <span class="number">4</span>;</span><br><span class="line">    <span class="number">3</span> <span class="number">2</span> <span class="number">0</span></span><br><span class="line">];</span><br><span class="line">b = [<span class="number">20</span> <span class="number">42</span> <span class="number">30</span>]&#x27;;</span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line">[x fval] = linprog(c, A, b, [], [], lb)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题2</span></span><br><span class="line"><span class="comment">%% 本题存在多解，matlab 只会给出其中一个解值</span></span><br><span class="line">c = [<span class="number">0.04</span> <span class="number">0.15</span> <span class="number">0.1</span> <span class="number">0.125</span>]&#x27;;</span><br><span class="line">A = [</span><br><span class="line">    <span class="number">-0.03</span> <span class="number">-0.3</span> <span class="number">0</span> <span class="number">-0.15</span>;</span><br><span class="line">    <span class="number">0.14</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0.07</span></span><br><span class="line">];</span><br><span class="line">b = [<span class="number">-32</span> <span class="number">42</span>]&#x27;;</span><br><span class="line">Aeq = [<span class="number">0.05</span> <span class="number">0</span> <span class="number">0.2</span> <span class="number">0.1</span>];</span><br><span class="line">beq = <span class="number">24</span>;</span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]&#x27;;</span><br><span class="line">[x fval] = linprog(c, A, b, Aeq, beq, lb)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例题3</span></span><br><span class="line">c = [<span class="number">-2</span> <span class="number">-3</span> <span class="number">5</span>]&#x27;;</span><br><span class="line">A = [</span><br><span class="line">    <span class="number">-2</span> <span class="number">5</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="number">1</span> <span class="number">3</span> <span class="number">1</span></span><br><span class="line">];</span><br><span class="line">b = [<span class="number">-10</span> <span class="number">12</span>]&#x27;;</span><br><span class="line">Aeq = <span class="built_in">ones</span>(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">beq = <span class="number">7</span>;</span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">[x fval] = linprog(c, A, b, Aeq, beq, lb)</span><br><span class="line">fval = -fval <span class="comment">% 最大值取负号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%　没有解会提示报错</span></span><br></pre></td></tr></table></figure>
<p>线性规划在数学上可以严格证明是可解的，用单纯形法，不用给定起始点。</p>
<h3 id="例题1生产决策">例题1：生产决策</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425190532041.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">format long g  <span class="comment">%　将Matlab的计算结果显示为一般的长数字格式</span></span><br><span class="line"><span class="comment">% (1) 系数向量</span></span><br><span class="line">c = <span class="built_in">zeros</span>(<span class="number">9</span>, <span class="number">1</span>);</span><br><span class="line">c(<span class="number">1</span>) = <span class="number">1.25</span> - <span class="number">0.25</span> - <span class="number">300</span> / <span class="number">6000</span> * <span class="number">5</span>;</span><br><span class="line">c(<span class="number">2</span>) = <span class="number">1.25</span> - <span class="number">0.25</span> - <span class="number">321</span> / <span class="number">10000</span> * <span class="number">7</span>;</span><br><span class="line">c(<span class="number">3</span>) = <span class="number">-250</span> / <span class="number">4000</span> * <span class="number">6</span>;</span><br><span class="line">c(<span class="number">4</span>) = <span class="number">-783</span> / <span class="number">7000</span> * <span class="number">4</span>;</span><br><span class="line">c(<span class="number">5</span>) = <span class="number">-200</span> / <span class="number">4000</span> * <span class="number">7</span>;</span><br><span class="line">c(<span class="number">6</span>) = <span class="number">-300</span> / <span class="number">6000</span> * <span class="number">10</span>;</span><br><span class="line">c(<span class="number">7</span>) = <span class="number">-321</span> / <span class="number">10000</span> * <span class="number">9</span>;</span><br><span class="line">c(<span class="number">8</span>) = <span class="number">2</span> - <span class="number">0.35</span> - <span class="number">250</span> / <span class="number">4000</span> * <span class="number">8</span>;</span><br><span class="line">c(<span class="number">9</span>) = <span class="number">2.8</span> - <span class="number">0.5</span> <span class="number">-321</span> / <span class="number">10000</span> * <span class="number">12</span> - <span class="number">783</span> / <span class="number">7000</span> * <span class="number">11</span>;</span><br><span class="line">c = -c; <span class="comment">% 求的是最大值</span></span><br><span class="line"><span class="comment">% (2) 不等式约束</span></span><br><span class="line">A = <span class="built_in">zeros</span>(<span class="number">5</span>, <span class="number">9</span>);</span><br><span class="line">A(<span class="number">1</span>,<span class="number">1</span>) = <span class="number">5</span>;  A(<span class="number">1</span>,<span class="number">6</span>) = <span class="number">10</span>;</span><br><span class="line">A(<span class="number">2</span>,<span class="number">2</span>) = <span class="number">7</span>;  A(<span class="number">2</span>,<span class="number">7</span>) = <span class="number">9</span>; A(<span class="number">2</span>,<span class="number">9</span>) = <span class="number">12</span>;</span><br><span class="line">A(<span class="number">3</span>,<span class="number">3</span>) = <span class="number">6</span>;  A(<span class="number">3</span>,<span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">A(<span class="number">4</span>,<span class="number">4</span>) = <span class="number">4</span>;  A(<span class="number">4</span>,<span class="number">9</span>) = <span class="number">11</span>;</span><br><span class="line">A(<span class="number">5</span>,<span class="number">5</span>) = <span class="number">7</span>;  </span><br><span class="line">b = [<span class="number">6000</span> <span class="number">10000</span> <span class="number">4000</span> <span class="number">7000</span> <span class="number">4000</span>]&#x27;;</span><br><span class="line"><span class="comment">% (3) 等式约束</span></span><br><span class="line">Aeq = [</span><br><span class="line">    <span class="number">1</span> <span class="number">1</span> <span class="number">-1</span> <span class="number">-1</span> <span class="number">-1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">-1</span> <span class="number">0</span></span><br><span class="line">];</span><br><span class="line">beq = [<span class="number">0</span> <span class="number">0</span>]&#x27;;</span><br><span class="line"><span class="comment">% (4) 上下界</span></span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">9</span>, <span class="number">1</span>);</span><br><span class="line">[x fval] = linprog(c, A, b, Aeq, beq, lb)</span><br><span class="line">fval = -fval <span class="comment">% 求最大值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 实际上本题应该是一个整数规划</span></span><br><span class="line">intcon = <span class="number">1</span>:<span class="number">9</span>;</span><br><span class="line">[x,fval] = intlinprog(c,intcon,A,b,Aeq,beq,lb)</span><br><span class="line">fval = -fval</span><br></pre></td></tr></table></figure>
<h3 id="例题2投料问题">例题2：投料问题</h3>
<figure>
<img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425192628046.png" alt="image-20210425192628046" /><figcaption>image-20210425192628046</figcaption>
</figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">format long g</span><br><span class="line">a = [<span class="number">1.25</span>  <span class="number">8.75</span>  <span class="number">0.5</span>  <span class="number">5.75</span>  <span class="number">3</span>  <span class="number">7.25</span>];  <span class="comment">% 工地的横坐标</span></span><br><span class="line">b = [<span class="number">1.25</span>  <span class="number">0.75</span>  <span class="number">4.75</span>  <span class="number">5</span>  <span class="number">6.5</span>  <span class="number">7.25</span>];   <span class="comment">% 工地的纵坐标</span></span><br><span class="line">x = [<span class="number">5</span>  <span class="number">2</span>];  <span class="comment">% 料场的横坐标</span></span><br><span class="line">y = [<span class="number">1</span>  <span class="number">7</span>];  <span class="comment">% 料场的纵坐标</span></span><br><span class="line"><span class="comment">% 多维度料场问题化为一维问题</span></span><br><span class="line"><span class="comment">% (1) 工地 1-6 到料场1、2的距离</span></span><br><span class="line">c = [];  <span class="comment">% 初始化用来保存工地和料场距离的向量 (这个向量就是我们的系数向量）</span></span><br><span class="line"><span class="keyword">for</span>  <span class="built_in">j</span> =<span class="number">1</span>:<span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">6</span></span><br><span class="line">        c = [c; <span class="built_in">sqrt</span>((a(<span class="built_in">i</span>) - x(<span class="built_in">j</span>)) ^ <span class="number">2</span> + (b(<span class="built_in">i</span>) - y(<span class="built_in">j</span>)) ^ <span class="number">2</span>)];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% (2) 不等式约束</span></span><br><span class="line">A = <span class="built_in">zeros</span>(<span class="number">2</span>, <span class="number">12</span>);</span><br><span class="line">A(<span class="number">1</span>, <span class="number">1</span>:<span class="number">6</span>) = <span class="number">1</span>;</span><br><span class="line">A(<span class="number">2</span>, <span class="number">7</span>:<span class="number">12</span>) = <span class="number">1</span>;</span><br><span class="line">b = [<span class="number">20</span>, <span class="number">20</span>]&#x27;;</span><br><span class="line"><span class="comment">% (3) 等式约束</span></span><br><span class="line">Aeq = [<span class="built_in">eye</span>(<span class="number">6</span>) <span class="built_in">eye</span>(<span class="number">6</span>)]; <span class="comment">% 两个单位矩阵横着拼起来</span></span><br><span class="line">beq = [<span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">7</span> <span class="number">6</span> <span class="number">11</span>]&#x27;;</span><br><span class="line"><span class="comment">% (4) 上下界</span></span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">12</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">[x fval] = linprog(c, A, b, Aeq, beq, lb)</span><br><span class="line">x = <span class="built_in">reshape</span>(x, <span class="number">6</span>, <span class="number">2</span>) <span class="comment">% 将x变为6行2列便于观察</span></span><br></pre></td></tr></table></figure>
<h2 id="非线性规划">非线性规划</h2>
<p>当目标函数和或者约束条件中有一个是决策变量 x 的非线性表达式，那么此时的数学规划问题就属于非线性规划。</p>
<p>解决非线性规划要比线性规划困难得多，目前没有通用算法，大多数算法都是在选定决策变量的初始值后，通过一定的搜索方法寻求最优的决策变量。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425193423794.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425193802171.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 例1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">fun1</span><span class="params">(x)</span></span></span><br><span class="line">    f = -x(<span class="number">1</span>) ^ <span class="number">2</span> - x(<span class="number">2</span>) ^ <span class="number">2</span> + x(<span class="number">1</span>) * x(<span class="number">2</span>) + <span class="number">2</span> * x(<span class="number">1</span>) + <span class="number">5</span> * x(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[c, ceq]</span> = <span class="title">nonlfun1</span><span class="params">(x)</span></span></span><br><span class="line">   c = [(x(<span class="number">1</span>) - <span class="number">1</span>) ^ <span class="number">2</span> - x(<span class="number">2</span>)];</span><br><span class="line">   ceq = [];  <span class="comment">% 不存在非线性等式约束，所以用[]表示</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">x0 = [<span class="number">0</span> <span class="number">0</span>]; <span class="comment">% 任意给定一个初始值搜索</span></span><br><span class="line">A = [<span class="number">-2</span> <span class="number">3</span>]; b = <span class="number">6</span>;</span><br><span class="line">[x, fval] = fmincon(@fun1, x0, A, b, [], [], [], [], @nonlfun1)</span><br><span class="line"></span><br><span class="line"><span class="comment">% Matlab2017a默认使用的算法是&#x27;interior-point&#x27; 内点法</span></span><br><span class="line"><span class="comment">% 使用interior point算法 （内点法）</span></span><br><span class="line">option = optimoptions(<span class="string">&#x27;fmincon&#x27;</span>,<span class="string">&#x27;Algorithm&#x27;</span>,<span class="string">&#x27;interior-point&#x27;</span>)</span><br><span class="line">[x, fval] = fmincon(@fun1, x0, A, b, [], [], [], [], @nonlfun1, option)  </span><br><span class="line"><span class="comment">%% 可以尝试使用多种算法</span></span><br><span class="line"><span class="comment">%% 选取初始值得到的结果可能会不满足限定条件，会有 bug，或者到达不了最优点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 用蒙特卡罗方法找到最优初始点x0然后求解效果好</span></span><br><span class="line">n = <span class="number">10000000</span>;</span><br><span class="line">x1 = unifrnd(<span class="number">-100</span>, <span class="number">100</span>, n, <span class="number">1</span>); <span class="comment">% 生成在-100-100之间均匀分布的随机数组成的列向量</span></span><br><span class="line">x2 = unifrnd(<span class="number">-100</span>, <span class="number">100</span>, n, <span class="number">1</span>); </span><br><span class="line">fmin = +<span class="built_in">inf</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">    x = [x1(<span class="built_in">i</span>), x2(<span class="built_in">i</span>)];</span><br><span class="line">    <span class="keyword">if</span> ((x(<span class="number">1</span>) - <span class="number">1</span>) ^ <span class="number">2</span> - x(<span class="number">2</span>) &lt;= <span class="number">0</span>) &amp; (<span class="number">-2</span> * x1(<span class="built_in">i</span>) + <span class="number">3</span> * x2(<span class="built_in">i</span>) <span class="number">-6</span> &lt;= <span class="number">0</span>)</span><br><span class="line">        result = -x(<span class="number">1</span>) ^ <span class="number">2</span> - x(<span class="number">2</span>) ^ <span class="number">2</span> + x(<span class="number">1</span>) * x(<span class="number">2</span>) + <span class="number">2</span> * x(<span class="number">1</span>) + <span class="number">5</span> * x(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> result &lt; fmin</span><br><span class="line">            fmin = result;</span><br><span class="line">            x0 = x;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">fun2</span><span class="params">(x)</span></span></span><br><span class="line">    f = sum(x .* x) + <span class="number">8</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[c, ceq]</span> = <span class="title">nonlfun2</span><span class="params">(x)</span></span></span><br><span class="line">    c = [</span><br><span class="line">    	-x(<span class="number">1</span>) ^ <span class="number">2</span> + x(<span class="number">2</span>) - x(<span class="number">3</span>) ^ <span class="number">2</span>;</span><br><span class="line">        x(<span class="number">1</span>) + x(<span class="number">2</span>) ^ <span class="number">2</span> + x(<span class="number">3</span>) ^ <span class="number">2</span> - <span class="number">20</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">% 非线性等式约束 == 0</span></span><br><span class="line">    ceq = [</span><br><span class="line">    	- x(<span class="number">1</span>) - x(<span class="number">2</span>) ^ <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">        x(<span class="number">2</span>) + <span class="number">2</span> * x(<span class="number">3</span>) ^ <span class="number">2</span> - <span class="number">3</span></span><br><span class="line">    ]; </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">x0 = [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>];</span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line">[x, fval] = fmincon(@fun2, x0, [], [], [], [], lb, [], @nonlfun2)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 用蒙特卡罗方法找到最优初始点x0然后求解效果好</span></span><br><span class="line">n = <span class="number">1000000</span>;</span><br><span class="line">x1 = unifrnd(<span class="number">0</span>, <span class="number">2</span>, n, <span class="number">1</span>);</span><br><span class="line">x2 = <span class="built_in">sqrt</span>(<span class="number">2</span> - x1); <span class="comment">% 根据非线性等式约束计算出</span></span><br><span class="line">x3 = <span class="built_in">sqrt</span>((<span class="number">3</span> - x2) / <span class="number">2</span>);</span><br><span class="line">fmin = +<span class="built_in">inf</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">    x = [x1(<span class="built_in">i</span>), x2(<span class="built_in">i</span>), x3(<span class="built_in">i</span>)];</span><br><span class="line">    <span class="keyword">if</span> (-x(<span class="number">1</span>)^<span class="number">2</span>+x(<span class="number">2</span>)-x(<span class="number">3</span>)^<span class="number">2</span> &lt;= <span class="number">0</span>) &amp; (x(<span class="number">1</span>)+x(<span class="number">2</span>)^<span class="number">2</span>+x(<span class="number">3</span>)^<span class="number">2</span><span class="number">-20</span> &lt;= <span class="number">0</span>)</span><br><span class="line">    	result = sum(x.*x) + <span class="number">8</span>;</span><br><span class="line">    	<span class="keyword">if</span> result &lt; fmin</span><br><span class="line">    		fmin = result;</span><br><span class="line">    		x0 = x;</span><br><span class="line">    	<span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 例3</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">fun3</span><span class="params">(x)</span></span></span><br><span class="line">    f = -prod(x);  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">A = [</span><br><span class="line">    <span class="number">1</span> <span class="number">-2</span> <span class="number">-2</span>;</span><br><span class="line">    <span class="number">1</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line">];  </span><br><span class="line">b = [<span class="number">0</span> <span class="number">72</span>]’;</span><br><span class="line">x0 = [<span class="number">22.58</span> <span class="number">12.58</span> <span class="number">12.13</span>];</span><br><span class="line">Aeq = [<span class="number">1</span> <span class="number">-1</span> <span class="number">0</span>]; beq = <span class="number">10</span>;</span><br><span class="line">lb = [-<span class="built_in">inf</span> <span class="number">10</span> -<span class="built_in">inf</span>];  ub = [<span class="built_in">inf</span> <span class="number">20</span> <span class="built_in">inf</span>]; </span><br><span class="line">[x, fval] = fmincon(@fun3, x0, A, b, Aeq, beq, lb, ub, [])</span><br><span class="line">fval = -fval</span><br></pre></td></tr></table></figure>
<h3 id="例题1选址问题">例题1：选址问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogblogimage-20210425200206123.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">format long g</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">fun5</span><span class="params">(xx)</span></span></span><br><span class="line">    a=[<span class="number">1.25</span>  <span class="number">8.75</span>  <span class="number">0.5</span>  <span class="number">5.75</span>  <span class="number">3</span>  <span class="number">7.25</span>];  <span class="comment">% 工地的横坐标</span></span><br><span class="line">    b=[<span class="number">1.25</span>  <span class="number">0.75</span>  <span class="number">4.75</span>	<span class="number">5</span>  <span class="number">6.5</span>  <span class="number">7.25</span>];   <span class="comment">% 工地的纵坐标</span></span><br><span class="line">    x = [xx(<span class="number">13</span>)  xx(<span class="number">15</span>)];  <span class="comment">% 新料场的横坐标</span></span><br><span class="line">    y = [xx(<span class="number">14</span>)  xx(<span class="number">16</span>)];  <span class="comment">% 新料场的纵坐标</span></span><br><span class="line">    c = [];  <span class="comment">% 用来保存工地和料场距离的向量 (系数向量）</span></span><br><span class="line">    <span class="comment">% 工地需求和料场坐标都为未知量</span></span><br><span class="line">    <span class="keyword">for</span>  <span class="built_in">j</span> =<span class="number">1</span>:<span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">6</span></span><br><span class="line">            c = [c;  <span class="built_in">sqrt</span>((a(<span class="built_in">i</span>)-x(<span class="built_in">j</span>))^<span class="number">2</span> + (b(<span class="built_in">i</span>)-y(<span class="built_in">j</span>))^<span class="number">2</span>)];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">% 要求吨千米数，注意c是列向量，计算非线性规划时给定的初始值x0是行向量</span></span><br><span class="line">    f = xx(<span class="number">1</span>:<span class="number">12</span>) * c;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% (2) 不等式约束</span></span><br><span class="line">A = <span class="built_in">zeros</span>(<span class="number">2</span>, <span class="number">16</span>);</span><br><span class="line">A(<span class="number">1</span>, <span class="number">1</span>:<span class="number">6</span>) = <span class="number">1</span>;</span><br><span class="line">A(<span class="number">2</span>, <span class="number">7</span>:<span class="number">12</span>) = <span class="number">1</span>;</span><br><span class="line">b = [<span class="number">20</span>,<span class="number">20</span>]&#x27;;</span><br><span class="line"><span class="comment">% (3) 等式约束</span></span><br><span class="line">Aeq = <span class="built_in">zeros</span>(<span class="number">6</span>, <span class="number">16</span>); <span class="comment">% 注意这里要改成16</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">6</span></span><br><span class="line">    Aeq(<span class="built_in">i</span>,<span class="built_in">i</span>) = <span class="number">1</span>; Aeq(<span class="built_in">i</span>,<span class="built_in">i</span>+<span class="number">6</span>) = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">beq = [<span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">7</span> <span class="number">6</span> <span class="number">11</span>]&#x27;;  <span class="comment">% 每个工地的日需求量</span></span><br><span class="line"><span class="comment">% (4) 上下界</span></span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">16</span>, <span class="number">1</span>);</span><br><span class="line">x0 = [<span class="number">3</span> <span class="number">5</span> <span class="number">0</span> <span class="number">7</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">4</span> <span class="number">0</span> <span class="number">6</span> <span class="number">10</span> <span class="number">5</span> <span class="number">1</span> <span class="number">2</span> <span class="number">7</span>]; <span class="comment">% 用第一问的结果作为初始值</span></span><br><span class="line">[x, fval] = fmincon(@fun5,x0,A,b,Aeq,beq,lb)</span><br><span class="line"><span class="built_in">reshape</span>(x(<span class="number">1</span>:<span class="number">12</span>), <span class="number">6</span>, <span class="number">2</span>) <span class="comment">% 6个工地对各原料的需求值 x(13-16) 为工地坐标</span></span><br></pre></td></tr></table></figure>
<h3 id="例题2飞行管理问题">例题2：飞行管理问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201539702.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201628772.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201719783.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425201809371.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">fun6</span><span class="params">(delta)</span>   % 决策变量<span class="title">delta</span>为六架飞机调整的角度</span></span><br><span class="line">    <span class="comment">% 目标函数：平方和（弧度转换为度数）</span></span><br><span class="line">  	f = sum(delta .* delta) * (<span class="number">180</span> /  <span class="built_in">pi</span>) ^ <span class="number">2</span>;  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[c, ceq]</span> = <span class="title">nonlfun6</span><span class="params">(delta)</span>   % 决策变量<span class="title">delta</span>为六架飞机调整的角度</span></span><br><span class="line">     x = [<span class="number">150</span> <span class="number">85</span> <span class="number">150</span> <span class="number">145</span> <span class="number">130</span>  <span class="number">0</span>]; <span class="comment">% 飞机初始位置的横坐标</span></span><br><span class="line">     y = [<span class="number">140</span> <span class="number">85</span> <span class="number">155</span>  <span class="number">50</span> <span class="number">150</span>  <span class="number">0</span>];</span><br><span class="line">     theta = [<span class="number">243</span> <span class="number">236</span> <span class="number">220.5</span> <span class="number">159</span> <span class="number">230</span> <span class="number">52</span>] * <span class="built_in">pi</span> / <span class="number">180</span>; <span class="comment">% 飞机初始的飞行方向角 </span></span><br><span class="line">     v = <span class="number">800</span>;  <span class="comment">% 飞机速度</span></span><br><span class="line">     co = <span class="built_in">cos</span>(theta + delta);  <span class="comment">% 包含6个元素的向量</span></span><br><span class="line">     si = <span class="built_in">sin</span>(theta + delta);  <span class="comment">% 包含6个元素的向量</span></span><br><span class="line">     <span class="comment">% 计算飞机i和j之间的最短距离（只需要计算矩阵的一半即可）</span></span><br><span class="line">     d = <span class="built_in">zeros</span>(<span class="number">6</span>);  <span class="comment">% 初始化飞机两两之间的最短距离矩阵</span></span><br><span class="line">     <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>:<span class="number">6</span></span><br><span class="line">         <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">i</span><span class="number">-1</span></span><br><span class="line">             <span class="comment">% 套用我们推导出来的公式计算飞机i和飞机j相距最近的时间</span></span><br><span class="line">             fenzi = ((y(<span class="built_in">j</span>)-y(<span class="built_in">i</span>))*(si(<span class="built_in">j</span>)-si(<span class="built_in">i</span>)) + (x(<span class="built_in">j</span>)-x(<span class="built_in">i</span>))*(co(<span class="built_in">j</span>)-co(<span class="built_in">i</span>))); <span class="comment">% 分子</span></span><br><span class="line">             fenmu = v * ((co(<span class="built_in">j</span>)-co(<span class="built_in">i</span>))^<span class="number">2</span> + (si(<span class="built_in">j</span>)-si(<span class="built_in">i</span>))^<span class="number">2</span>); <span class="comment">% 分母</span></span><br><span class="line">             t(<span class="built_in">i</span>,<span class="built_in">j</span>) = -fenzi / fenmu;</span><br><span class="line">             <span class="keyword">if</span> t(<span class="built_in">i</span>,<span class="built_in">j</span>) &lt;<span class="number">0</span>  </span><br><span class="line">                d(<span class="built_in">i</span>, <span class="built_in">j</span>) = <span class="number">1000</span>; <span class="comment">% 此时最初的位置就是相距最近的点，最初距离就大于8</span></span><br><span class="line">             <span class="keyword">else</span></span><br><span class="line">             	<span class="comment">% 套用公式</span></span><br><span class="line">             	d(<span class="built_in">i</span>, <span class="built_in">j</span>) = <span class="built_in">sqrt</span>((x(<span class="built_in">j</span>)-x(<span class="built_in">i</span>)+v*t(<span class="built_in">i</span>,<span class="built_in">j</span>)*(co(<span class="built_in">j</span>)-co(<span class="built_in">i</span>)))^<span class="number">2</span>+(y(<span class="built_in">j</span>)-y(<span class="built_in">i</span>)+v*t(<span class="built_in">i</span>,<span class="built_in">j</span>)*(si(<span class="built_in">j</span>)-si(<span class="built_in">i</span>)))^<span class="number">2</span>);</span><br><span class="line">             <span class="keyword">end</span> </span><br><span class="line">         <span class="keyword">end</span></span><br><span class="line">     <span class="keyword">end</span></span><br><span class="line">     <span class="comment">% 非线性不等式约束 &lt;= 0</span></span><br><span class="line">     <span class="comment">% 12个非线性不等式约束: “最短距离&gt;8” 等价于 “8 - 最短距离&lt;0”</span></span><br><span class="line">     <span class="comment">% 注意： 由于Matlab标准型中取的是小于等于号，因此这里取一个比8略大的数：8.000001-最短距离&lt;=0</span></span><br><span class="line">     c = <span class="built_in">ones</span>(<span class="number">15</span>,<span class="number">1</span>) * <span class="number">8.000001</span> - [d(<span class="number">2</span>,<span class="number">1</span>); d(<span class="number">3</span>,<span class="number">1</span>:<span class="number">2</span>)&#x27;; d(<span class="number">4</span>,<span class="number">1</span>:<span class="number">3</span>)&#x27;; d(<span class="number">5</span>,<span class="number">1</span>:<span class="number">4</span>)&#x27;; d(<span class="number">6</span>,<span class="number">1</span>:<span class="number">5</span>)&#x27;];   </span><br><span class="line">     ceq = [];  <span class="comment">% 没有非线性等式约束</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line">box on</span><br><span class="line">data = [</span><br><span class="line">    <span class="number">150</span>	<span class="number">140</span>	<span class="number">243</span>;</span><br><span class="line">    <span class="number">85</span>	<span class="number">85</span>	<span class="number">236</span>;</span><br><span class="line">    <span class="number">150</span>	<span class="number">155</span>	<span class="number">220.5</span>;</span><br><span class="line">    <span class="number">145</span>	<span class="number">50</span>	<span class="number">159</span>;</span><br><span class="line">    <span class="number">130</span>	<span class="number">150</span>	<span class="number">230</span>;</span><br><span class="line">    <span class="number">0</span>	<span class="number">0</span>	<span class="number">52</span></span><br><span class="line">];</span><br><span class="line"><span class="built_in">plot</span>(data(:,<span class="number">1</span>), data(:,<span class="number">2</span>), <span class="string">&#x27;.r&#x27;</span>)</span><br><span class="line">axis([<span class="number">0</span> <span class="number">160</span> <span class="number">0</span> <span class="number">160</span>])</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">6</span></span><br><span class="line">    txt = [<span class="string">&#x27;飞机&#x27;</span> num2str(<span class="built_in">i</span>)];</span><br><span class="line">    text(data(<span class="built_in">i</span>,<span class="number">1</span>) + <span class="number">2</span>, data(<span class="built_in">i</span>,<span class="number">2</span>) + <span class="number">2</span>,txt, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">x0 = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line">lb = -<span class="built_in">pi</span> / <span class="number">6</span> * <span class="built_in">ones</span>(<span class="number">6</span>, <span class="number">1</span>);</span><br><span class="line">ub = <span class="built_in">pi</span> / <span class="number">6</span> * <span class="built_in">ones</span>(<span class="number">6</span>,<span class="number">1</span>);</span><br><span class="line">[x, fval] = fmincon(@fun6,x0,[],[],[],[],lb,ub,@nonlfun6)</span><br><span class="line">x = x * <span class="number">180</span> / <span class="built_in">pi</span> <span class="comment">% 对调整弧度转换为度数</span></span><br></pre></td></tr></table></figure>
<h2 id="整数规划">整数规划</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425203536218.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 例1</span></span><br><span class="line">c=[<span class="number">-20</span>,<span class="number">-10</span>]&#x27;;</span><br><span class="line">intcon=[<span class="number">1</span>, <span class="number">2</span>];  <span class="comment">% x1和x2限定为整数</span></span><br><span class="line">A=[</span><br><span class="line">    <span class="number">5</span> <span class="number">4</span>;</span><br><span class="line">    <span class="number">2</span> <span class="number">5</span></span><br><span class="line">];</span><br><span class="line">b=[<span class="number">24</span> <span class="number">13</span>]&#x27;;</span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">[x,fval] = intlinprog(c,intcon,A,b,[],[],lb)</span><br><span class="line">fval = -fval</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 例3</span></span><br><span class="line">c=[<span class="number">-3</span> <span class="number">-2</span> <span class="number">-1</span>]&#x27;; </span><br><span class="line">intcon=<span class="number">3</span>; <span class="comment">% x3限定为整数</span></span><br><span class="line">A=<span class="built_in">ones</span>(<span class="number">1</span>,<span class="number">3</span>); b=<span class="number">7</span>;</span><br><span class="line">Aeq=[<span class="number">4</span> <span class="number">2</span> <span class="number">1</span>]; beq=<span class="number">12</span>;</span><br><span class="line">lb= <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>); ub=[+<span class="built_in">inf</span> +<span class="built_in">inf</span> <span class="number">1</span>]&#x27;; <span class="comment">%x(3)为0-1变量</span></span><br><span class="line">[x,fval] = intlinprog(c,intcon,A,b,Aeq,beq,lb,ub)</span><br></pre></td></tr></table></figure>
<h3 id="例题1背包问题">例题1：背包问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425203851291.png" /></p>
<p>计算机算法上还可以对背包问题用动态规划求解。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c = -[<span class="number">540</span> <span class="number">200</span> <span class="number">180</span> <span class="number">350</span> <span class="number">60</span> <span class="number">150</span> <span class="number">280</span> <span class="number">450</span> <span class="number">320</span> <span class="number">120</span>]&#x27;; <span class="comment">% 最大化问题加符号</span></span><br><span class="line">intcon = [<span class="number">1</span>:<span class="number">10</span>];</span><br><span class="line">A = [<span class="number">6</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">2</span>];  b = <span class="number">30</span>;</span><br><span class="line">Aeq = []; beq =[];</span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">ub = <span class="built_in">ones</span>(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">[x,fval] = intlinprog(c,intcon,A,b,Aeq,beq,lb,ub)</span><br><span class="line">fval = -fval</span><br></pre></td></tr></table></figure>
<h3 id="例题2指派问题">例题2：指派问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425204232967.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">66.8</span> <span class="number">75.6</span> <span class="number">87</span> <span class="number">58.6</span> <span class="number">57.2</span> <span class="number">66</span> <span class="number">66.4</span> <span class="number">53</span> <span class="number">78</span> <span class="number">67.8</span> <span class="number">84.6</span> <span class="number">59.4</span> <span class="number">70</span> <span class="number">74.2</span> <span class="number">69.6</span> <span class="number">57.2</span> <span class="number">67.4</span> <span class="number">71</span> <span class="number">83.8</span> <span class="number">62.4</span>]&#x27;;</span><br><span class="line">intcon = [<span class="number">1</span>:<span class="number">20</span>];</span><br><span class="line">A = <span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">5</span></span><br><span class="line">    A(<span class="built_in">i</span>, (<span class="number">4</span>*<span class="built_in">i</span><span class="number">-3</span>): <span class="number">4</span>*<span class="built_in">i</span>) = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">b = [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]&#x27;;</span><br><span class="line"><span class="comment">% 线性等式约束的系数矩阵和常数项向量 （每种泳姿有且仅有一人参加，一共四个约束）</span></span><br><span class="line">Aeq = [<span class="built_in">eye</span>(<span class="number">4</span>) <span class="built_in">eye</span>(<span class="number">4</span>) <span class="built_in">eye</span>(<span class="number">4</span>) <span class="built_in">eye</span>(<span class="number">4</span>) <span class="built_in">eye</span>(<span class="number">4</span>)];</span><br><span class="line">beq = [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]&#x27;;</span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line">ub = <span class="built_in">ones</span>(<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line">[x, fval] = intlinprog(c,intcon,A,b,Aeq,beq,lb,ub)</span><br><span class="line"><span class="built_in">reshape</span>(x, <span class="number">4</span>, <span class="number">5</span>) <span class="comment">% 方便查看结果</span></span><br></pre></td></tr></table></figure>
<h3 id="例题3钢管切割问题">例题3：钢管切割问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425204631254.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% (1) 枚举法找出同一个原材料上所有的切割方法</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">0</span>:<span class="number">2</span>  <span class="comment">% 2.9m长的圆钢的数量</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">0</span>:<span class="number">3</span>  <span class="comment">% 2.1m长的圆钢的数量</span></span><br><span class="line">        <span class="keyword">for</span> k = <span class="number">0</span>:<span class="number">6</span>  <span class="comment">% 1m长的圆钢的数量</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">2.9</span>*<span class="built_in">i</span>+<span class="number">2.1</span>*<span class="built_in">j</span>+<span class="number">1</span>*k &gt;= <span class="number">6</span> &amp;&amp; <span class="number">2.9</span>*<span class="built_in">i</span>+<span class="number">2.1</span>*<span class="built_in">j</span>+<span class="number">1</span>*k &lt;= <span class="number">6.9</span></span><br><span class="line">                <span class="built_in">disp</span>([<span class="built_in">i</span>, <span class="built_in">j</span>, k])</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% (2) 线性整数规划问题的求解</span></span><br><span class="line">c = <span class="built_in">ones</span>(<span class="number">7</span>, <span class="number">1</span>);</span><br><span class="line">intcon = [<span class="number">1</span>:<span class="number">7</span>];</span><br><span class="line">A = -[</span><br><span class="line">    <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>;  </span><br><span class="line">    <span class="number">0</span> <span class="number">0</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span>;</span><br><span class="line">    <span class="number">4</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span> <span class="number">1</span></span><br><span class="line">];</span><br><span class="line">b = -[<span class="number">100</span> <span class="number">100</span> <span class="number">100</span>]&#x27;; <span class="comment">% 负号大于等于转为小于等于</span></span><br><span class="line">lb = <span class="built_in">zeros</span>(<span class="number">7</span>,<span class="number">1</span>);</span><br><span class="line">[x, fval]= intlinprog(c,intcon,A,b,[],[],lb)</span><br></pre></td></tr></table></figure>
<h2 id="最大最小化模型">最大最小化模型</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425205318579.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Fun</span><span class="params">(x)</span></span></span><br><span class="line">    a=[<span class="number">1</span> <span class="number">4</span> <span class="number">3</span> <span class="number">5</span> <span class="number">9</span> <span class="number">12</span> <span class="number">6</span> <span class="number">20</span> <span class="number">17</span> <span class="number">8</span>];</span><br><span class="line">    b=[<span class="number">2</span> <span class="number">10</span> <span class="number">8</span> <span class="number">18</span> <span class="number">1</span> <span class="number">4</span> <span class="number">5</span> <span class="number">10</span> <span class="number">8</span> <span class="number">9</span>];</span><br><span class="line">    f = <span class="built_in">zeros</span>(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">10</span></span><br><span class="line">        f(<span class="built_in">i</span>) = <span class="built_in">abs</span>(x(<span class="number">1</span>)-a(<span class="built_in">i</span>)) + <span class="built_in">abs</span>(x(<span class="number">2</span>)-b(<span class="built_in">i</span>));  </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">x0 = [<span class="number">6</span>, <span class="number">6</span>];</span><br><span class="line">lb = [<span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">ub = [<span class="number">8</span>, <span class="number">10</span>];</span><br><span class="line">[x, feval] = fminimax(@Fun,x0,[],[],[],[],lb,ub)</span><br><span class="line"><span class="built_in">max</span>(feval)</span><br></pre></td></tr></table></figure>
<h2 id="多目标规划模型">多目标规划模型</h2>
<p>若一个规划问题中有多个目标，例如企业在保证利润最大时也要保证生产时产生的污染最少这种情况下我们可以对多目标函数进行 <strong>加权组合</strong>，使问题变为单目标规划，然后再利用之前学的知识进行求解。</p>
<p>注意要先将多个目标函数统一为最大化或最小化问题后才可以进行加权组合。</p>
<p>如果目标函数的量纲不相同，则需要对其进行 <strong>标准化</strong> 后再进行加权，标准化的方法一般是用目标函数除以某一个常量，该常量是这个目标函数的某个取值，具体取何值可根据 <strong>经验</strong> （题目描述）确定。</p>
<p>对多目标函数进行加权求和时，权重需要由该问题领域的专家给定，在实际建模比赛中，若无特殊说明，我们使得权重相同。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210425210947064.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">w1 = <span class="number">0.4</span>;  w2 = <span class="number">0.6</span>;  <span class="comment">% 两个目标函数的权重</span></span><br><span class="line">w1 = <span class="number">0.5</span>;  w2 = <span class="number">0.5</span>;</span><br><span class="line">w1 = <span class="number">0.3</span>;  w2 = <span class="number">0.7</span>;</span><br><span class="line">c = [w1/<span class="number">30</span>*<span class="number">2</span>+w2/<span class="number">2</span>*<span class="number">0.4</span> w1/<span class="number">30</span>*<span class="number">5</span>+w2/<span class="number">2</span>*<span class="number">0.3</span>]&#x27;;  <span class="comment">% 线性规划目标函数的系数</span></span><br><span class="line">A = [<span class="number">-1</span> <span class="number">-1</span>];  b = <span class="number">-7</span>;</span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span>]&#x27;; ub = [<span class="number">5</span> <span class="number">6</span>]&#x27;;</span><br><span class="line">[x, fval] = linprog(c,A,b,[],[],lb,ub)</span><br><span class="line">f1 = <span class="number">2</span>*x(<span class="number">1</span>) + <span class="number">5</span>*x(<span class="number">2</span>)</span><br><span class="line">f2 = <span class="number">0.4</span>*x(<span class="number">1</span>) + <span class="number">0.3</span>*x(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 敏感性分析</span></span><br><span class="line">W1 = <span class="number">0.1</span>:<span class="number">0.001</span>:<span class="number">0.5</span>;  W2 = <span class="number">1</span> - W1;  </span><br><span class="line">n = <span class="built_in">length</span>(W1);</span><br><span class="line">F1 = <span class="built_in">zeros</span>(n,<span class="number">1</span>);  F2 = <span class="built_in">zeros</span>(n,<span class="number">1</span>);   X1 = <span class="built_in">zeros</span>(n,<span class="number">1</span>);  X2 = <span class="built_in">zeros</span>(n,<span class="number">1</span>);   FVAL = <span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line">A = [<span class="number">-1</span> <span class="number">-1</span>];  b = <span class="number">-7</span>;</span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span>]; ub = [<span class="number">5</span> <span class="number">6</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    w1 = W1(<span class="built_in">i</span>);  w2 = W2(<span class="built_in">i</span>);</span><br><span class="line">    c = [w1/<span class="number">30</span>*<span class="number">2</span>+w2/<span class="number">2</span>*<span class="number">0.4</span> w1/<span class="number">30</span>*<span class="number">5</span>+w2/<span class="number">2</span>*<span class="number">0.3</span>]&#x27;;</span><br><span class="line">    [x,fval] = linprog(c,A,b,[],[],lb,ub);</span><br><span class="line">    F1(<span class="built_in">i</span>) = <span class="number">2</span>*x(<span class="number">1</span>)+<span class="number">5</span>*x(<span class="number">2</span>);</span><br><span class="line">    F2(<span class="built_in">i</span>) = <span class="number">0.4</span>*x(<span class="number">1</span>) + <span class="number">0.3</span>*x(<span class="number">2</span>);</span><br><span class="line">    X1(<span class="built_in">i</span>) = x(<span class="number">1</span>);</span><br><span class="line">    X2(<span class="built_in">i</span>) = x(<span class="number">2</span>);</span><br><span class="line">    FVAL(<span class="built_in">i</span>) = fval;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>) </span><br><span class="line"><span class="built_in">plot</span>(W1,F1,W1,F2)</span><br><span class="line">xlabel(<span class="string">&#x27;f_&#123;1&#125;的权重&#x27;</span>) </span><br><span class="line">ylabel(<span class="string">&#x27;f_&#123;1&#125;和f_&#123;2&#125;的取值&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;f_&#123;1&#125;&#x27;</span>,<span class="string">&#x27;f_&#123;2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(W1,X1,W1,X2)</span><br><span class="line">xlabel(<span class="string">&#x27;f_&#123;1&#125;的权重&#x27;</span>) </span><br><span class="line">ylabel(<span class="string">&#x27;x_&#123;1&#125;和x_&#123;2&#125;的取值&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x_&#123;1&#125;&#x27;</span>,<span class="string">&#x27;x_&#123;2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(W1,FVAL)  <span class="comment">% 看起来是两个直线组合起来的下半部分</span></span><br><span class="line">xlabel(<span class="string">&#x27;f_&#123;1&#125;的权重&#x27;</span>) </span><br><span class="line">ylabel(<span class="string">&#x27;综合指标的值&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="启发式算法">启发式算法</h1>
<p>优化问题特别复杂的话，启发式算法就是我们求解问题的一大法宝。</p>
<p>一个基于 <strong>直观或经验构造</strong> 的算法，在 <strong>可接受的花费</strong> 下给出待解决 <strong>优化问题</strong> 的一个 <strong>可行解</strong>。</p>
<ul>
<li>可接受的花费：计算时间和空间能接受</li>
<li>优化问题：一定约束条件下,求解一个目标函数的最大值（或最小值）问题。</li>
<li>可行解：得到的结果能用于工程实践（不一定非要是最优解）</li>
</ul>
<p>常见的启发式算法：粒子群算法、模拟退火算法、遗传算法、蚁群算法、禁忌搜索算法。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507165801029.png" /></p>
<p>盲目搜索：枚举法、蒙特卡洛模拟。</p>
<p>如果现在要求最值的函数是一个多变量的函数，例如是一个10个变量的函数，要考虑的情况随着变量数呈指数增长。</p>
<p>如果利用了 <strong>中间信息</strong> 来改进搜索策略则称为启发式搜索，任何有助于找到问题的最优解，但不能保证。</p>
<p>启发式算法常见解决问题：TSP(旅行商问题)这类组合优化问题、非线性整数规划问题等，也可以解决。</p>
<h1 id="粒子群算法">粒子群算法</h1>
<p>又称 PSO 算法，通过模拟鸟群觅食行为而发展起来的一种基于 <strong>群体协作</strong> 的搜索算法。</p>
<p>例子主要侧重学习其思想，并将其用于求解连续函数的 <strong>最值问题</strong>，（默认数学规划还带一些 Matlab 求解的函数）。</p>
<p>它的核心思想是利用群体中的 <strong>个体对信息的共享</strong> 使整个群体的运动在问题求解空间中产生从无序到有序的演化过程，从而获得问题的可行解。</p>
<h2 id="概念">概念</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170357350.png" /></p>
<p>gbest 可以为全体的信息，也可以为邻近的信息。</p>
<ul>
<li>粒子：优化问题的候选解</li>
<li>位置：候选解所在的位置</li>
<li>速度：候选解移动的速度</li>
<li>适应度：评价粒子优劣的值，一般设置为目标函数值</li>
<li>个体最佳位置：单个粒子迄今为止找到的最佳位置</li>
<li>群体最佳位置：所有粒子迄今为止找到的最佳位置</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170644228.png" /></p>
<h2 id="关键步骤">关键步骤</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170720440.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507170902046.png" /></p>
<p>第 d 步的速度 = 上一步速度 * 惯性 + 自我认知部分 + 社会认知部分</p>
<p>r1、r2 是 [0, 1] 上的随机数，c1、c2 学习因子取 2，w 惯性权重一般取 0.9。</p>
<h3 id="权重改进">权重改进</h3>
<ul>
<li>线性递减惯性权重</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183714036.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">w_start = <span class="number">0.9</span>;</span><br><span class="line">w_end = <span class="number">0.4</span>;</span><br><span class="line">...</span><br><span class="line">w = w_start - (w_start - w_end) * d / K;</span><br></pre></td></tr></table></figure>
<ul>
<li>自适应关系权重</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183831944.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512194910668.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">w_max = <span class="number">0.9</span>;</span><br><span class="line">w_min = <span class="number">0.4</span>;</span><br><span class="line">...</span><br><span class="line">f_i = fit(<span class="built_in">i</span>);  <span class="comment">% 取出第i个粒子的适应度</span></span><br><span class="line">f_avg = sum(fit)/n;  <span class="comment">% 计算此时适应度的平均值</span></span><br><span class="line">f_min = <span class="built_in">min</span>(fit); <span class="comment">% 计算此时适应度的最小值</span></span><br><span class="line"><span class="keyword">if</span> f_i &lt;= f_avg  </span><br><span class="line">    <span class="keyword">if</span> f_avg ~= f_min  <span class="comment">% 如果分母为0，我们就干脆令w=w_min</span></span><br><span class="line">        w = w_min + (w_max - w_min)*(f_i - f_min)/(f_avg - f_min);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        w = w_min;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    w = w_max;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>随机惯性权重</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507184434122.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">w_max = <span class="number">0.9</span>;</span><br><span class="line">w_min = <span class="number">0.4</span>;</span><br><span class="line">sigma = <span class="number">0.3</span>; <span class="comment">% 正态分布的随机扰动项的标准差（一般取0.2-0.5之间）</span></span><br><span class="line">...</span><br><span class="line">w = w_min + (w_max - w_min)*<span class="built_in">rand</span>(<span class="number">1</span>) + sigma*<span class="built_in">randn</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h3 id="学习因子改进">学习因子改进</h3>
<p>个体学习因子 c1 和社会(群体)学习因子 c2 决定了粒子本身经验信息和其他粒子的经验信息对粒子运行轨迹的影响，其反映了粒子群之间的信息交流。设置 c1 较大的值，会使粒子过多地在自身的局部范围内搜索，而较大的 c2 的值，则又会促使粒子过早收敛到局部最优值。</p>
<ul>
<li>压缩因子法</li>
</ul>
<p>为了有效地控制粒子的飞行速度，使算法达到全局搜索与局部搜索两者间的有效平衡，Clerc 构造了引入收缩因子的 PSO 模型，采用了压缩因子，这种调整方法通过合适选取参数，可确保PSO算法的收敛性，并可取消对速度的边界限制。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507185005010.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c1 = <span class="number">2.05</span>;  <span class="comment">% 每个粒子的个体学习因子，也称为个体加速常数</span></span><br><span class="line">c2 = <span class="number">2.05</span>;  <span class="comment">% 每个粒子的社会学习因子，也称为社会加速常数</span></span><br><span class="line">C = c1 + c2; </span><br><span class="line">fai = <span class="number">2</span>/<span class="built_in">abs</span>((<span class="number">2</span>-C-<span class="built_in">sqrt</span>(C^<span class="number">2</span><span class="number">-4</span>*C))); <span class="comment">% 收缩因子</span></span><br><span class="line">...</span><br><span class="line">v(<span class="built_in">i</span>,:) = fai * (w*v(<span class="built_in">i</span>,:) + c1*<span class="built_in">rand</span>(<span class="number">1</span>)*(pbest(<span class="built_in">i</span>,:) - x(<span class="built_in">i</span>,:)) + c2*<span class="built_in">rand</span>(<span class="number">1</span>)*(gbest - x(<span class="built_in">i</span>,:))); </span><br></pre></td></tr></table></figure>
<ul>
<li>非对称学习因子</li>
</ul>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507185516251.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c1_ini = <span class="number">2.5</span>;  <span class="comment">% 个体学习因子的初始值</span></span><br><span class="line">c1_fin = <span class="number">0.5</span>;  <span class="comment">% 个体学习因子的最终值</span></span><br><span class="line">c2_ini = <span class="number">1</span>;  <span class="comment">% 社会学习因子的初始值</span></span><br><span class="line">c2_fin = <span class="number">2.25</span>;  <span class="comment">% 社会学习因子的最终值</span></span><br><span class="line">...</span><br><span class="line">c1 = c1_ini + (c1_fin - c1_ini)*d/K;</span><br><span class="line">c2 = c2_ini + (c2_fin - c2_ini)*d/K;</span><br></pre></td></tr></table></figure>
<h3 id="搜索终止条件">搜索终止条件</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507190056144.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 改进：自动退出迭代循环</span></span><br><span class="line">Count = <span class="number">0</span>; <span class="comment">% 计数器初始化为0</span></span><br><span class="line">max_Count = <span class="number">30</span>;  <span class="comment">% 最大计数值初始化为30</span></span><br><span class="line">tolerance = <span class="number">1e-6</span>;  <span class="comment">% 函数变化量容忍度，取10^(-6)</span></span><br><span class="line">...</span><br><span class="line">delta_fit = <span class="built_in">abs</span>(Obj_fun3(gbest) - Obj_fun3(tem));   <span class="comment">% 计算相邻两次迭代适应度的变化量</span></span><br><span class="line"><span class="keyword">if</span> delta_fit &lt; tolerance  <span class="comment">% 判断这个变化量和“函数变化量容忍度”的相对大小，如果前者小，则计数器加1</span></span><br><span class="line">    Count = Count + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    Count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">end</span>   </span><br><span class="line"><span class="keyword">if</span> Count &gt; max_Count  <span class="comment">% 如果计数器的值达到了最大计数值</span></span><br><span class="line">    <span class="keyword">break</span>;  <span class="comment">% 跳出循环</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="例题解决">例题解决</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507171252968.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507171421720.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span> = <span class="title">fun1</span><span class="params">(x)</span></span></span><br><span class="line">    y = -(<span class="number">11</span>*<span class="built_in">sin</span>(x) + <span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">5</span>*x));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%% Matlab 自带函数求解非线性函数最值问题</span></span><br><span class="line">x0 = <span class="number">0</span>;</span><br><span class="line">A = [];</span><br><span class="line">b = [];</span><br><span class="line">Aeq = [];</span><br><span class="line">beq = [];</span><br><span class="line">x_lb = <span class="number">-3</span>;</span><br><span class="line">x_ub = <span class="number">3</span>;</span><br><span class="line">[x, fval] = fmincon(@fun1, x0, A, b, Aeq, beq, x_lb, x_ub)</span><br><span class="line">fval = -fval</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 粒子群法解</span></span><br><span class="line"><span class="comment">% 绘制图形</span></span><br><span class="line">x = <span class="number">-3</span>:<span class="number">0.01</span>:<span class="number">3</span>;</span><br><span class="line">y = <span class="number">11</span>*<span class="built_in">sin</span>(x) + <span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">5</span>*x);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&#x27;b-&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;y = 11*sin(x) + 7*cos(5*x)&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 粒子群算法中的预设参数</span></span><br><span class="line">n = <span class="number">10</span>; <span class="comment">% 粒子数量</span></span><br><span class="line">narvs = <span class="number">1</span>; <span class="comment">% 变量个数</span></span><br><span class="line">c1 = <span class="number">2</span>;  <span class="comment">% 每个粒子的个体学习因子，也称为个体加速常数</span></span><br><span class="line">c2 = <span class="number">2</span>;  <span class="comment">% 每个粒子的社会学习因子，也称为社会加速常数</span></span><br><span class="line">w = <span class="number">0.9</span>;  <span class="comment">% 惯性权重</span></span><br><span class="line">K = <span class="number">50</span>;  <span class="comment">% 迭代的次数</span></span><br><span class="line">vmax = <span class="number">1.2</span>; <span class="comment">% 粒子的最大速度 (6/5)</span></span><br><span class="line">x_lb = <span class="number">-3</span>; <span class="comment">% x的下界</span></span><br><span class="line">x_ub = <span class="number">3</span>; <span class="comment">% x的上界</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 初始化粒子的位置和速度</span></span><br><span class="line">x = <span class="built_in">zeros</span>(n,narvs);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: narvs</span><br><span class="line">    x(:,<span class="built_in">i</span>) = x_lb(<span class="built_in">i</span>) + (x_ub(<span class="built_in">i</span>)-x_lb(<span class="built_in">i</span>))*<span class="built_in">rand</span>(n,<span class="number">1</span>);    <span class="comment">% 随机初始化粒子所在的位置在定义域内</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">v = -vmax + <span class="number">2</span>*vmax .* <span class="built_in">rand</span>(n,narvs);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 计算适应度</span></span><br><span class="line">fit = <span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    fit(<span class="built_in">i</span>) = Obj_fun1(x(<span class="built_in">i</span>,:));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">pbest = x; <span class="comment">% 初始化这n个粒子迄今为止找到的最佳位置</span></span><br><span class="line">ind = <span class="built_in">find</span>(fit == <span class="built_in">max</span>(fit), <span class="number">1</span>);</span><br><span class="line">gbest = x(ind,:); <span class="comment">% 定义所有粒子迄今为止找到的最佳位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 在图上标上这n个粒子的位置用于演示</span></span><br><span class="line">h = <span class="built_in">scatter</span>(x, fit, <span class="number">80</span>, <span class="string">&#x27;*r&#x27;</span>);</span><br><span class="line">fitnessbest = <span class="built_in">ones</span>(K,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> d = <span class="number">1</span>:K</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="comment">% 更新第i个粒子的速度</span></span><br><span class="line">        v(<span class="built_in">i</span>,:) = w*v(<span class="built_in">i</span>,:) + c1*<span class="built_in">rand</span>(<span class="number">1</span>)*(pbest(<span class="built_in">i</span>,:) - x(<span class="built_in">i</span>,:)) + c2*<span class="built_in">rand</span>(<span class="number">1</span>)*(gbest - x(<span class="built_in">i</span>,:));</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> v(<span class="built_in">i</span>,<span class="built_in">j</span>) &lt; -vmax(<span class="built_in">j</span>)</span><br><span class="line">                v(<span class="built_in">i</span>,<span class="built_in">j</span>) = -vmax(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> v(<span class="built_in">i</span>,<span class="built_in">j</span>) &gt; vmax(<span class="built_in">j</span>)</span><br><span class="line">                v(<span class="built_in">i</span>,<span class="built_in">j</span>) = vmax(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% 更新第i个粒子的位置</span></span><br><span class="line">        x(<span class="built_in">i</span>,:) = x(<span class="built_in">i</span>,:) + v(<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> x(<span class="built_in">i</span>,<span class="built_in">j</span>) &lt; x_lb(<span class="built_in">j</span>)</span><br><span class="line">                x(<span class="built_in">i</span>,<span class="built_in">j</span>) = x_lb(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> x(<span class="built_in">i</span>,<span class="built_in">j</span>) &gt; x_ub(<span class="built_in">j</span>)</span><br><span class="line">                x(<span class="built_in">i</span>,<span class="built_in">j</span>) = x_ub(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% 重新计算第i个粒子的适应度</span></span><br><span class="line">        fit(<span class="built_in">i</span>) = Obj_fun1(x(<span class="built_in">i</span>,:));</span><br><span class="line">        <span class="keyword">if</span> fit(<span class="built_in">i</span>) &gt; Obj_fun1(pbest(<span class="built_in">i</span>,:))</span><br><span class="line">            pbest(<span class="built_in">i</span>,:) = x(<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span>  fit(<span class="built_in">i</span>) &gt; Obj_fun1(gbest)</span><br><span class="line">        	gbest = pbest(<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 更新第d次迭代得到的最佳的适应度</span></span><br><span class="line">    fitnessbest(d) = Obj_fun1(gbest);</span><br><span class="line">    pause(<span class="number">0.1</span>)</span><br><span class="line">    h.XData = x;</span><br><span class="line">    h.YData = fit;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 绘制出每次迭代最佳适应度的变化图</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(fitnessbest)  </span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的位置是：&#x27;</span>); <span class="built_in">disp</span>(gbest)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(Obj_fun1(gbest))</span><br></pre></td></tr></table></figure>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183011706.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507183034830.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span> = <span class="title">Obj_fun2</span><span class="params">(x)</span>  </span></span><br><span class="line">    y = x(<span class="number">1</span>)^<span class="number">2</span> + x(<span class="number">2</span>)^<span class="number">2</span> - x(<span class="number">1</span>)*x(<span class="number">2</span>) - <span class="number">10</span>*x(<span class="number">1</span>) - <span class="number">4</span>*x(<span class="number">2</span>) + <span class="number">60</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%% Matlab 自带函数求解非线性函数</span></span><br><span class="line">x0 = [<span class="number">0</span> <span class="number">0</span>];  </span><br><span class="line">A=[]; b=[];</span><br><span class="line">Aeq=[]; beq=[];</span><br><span class="line">x_lb = [<span class="number">-15</span> <span class="number">-15</span>];</span><br><span class="line">x_ub = [<span class="number">15</span> <span class="number">15</span>];</span><br><span class="line">[x,fval] = fmincon(@Obj_fun2,x0,A,b,Aeq,beq,x_lb,x_ub)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 绘制函数的图形</span></span><br><span class="line">x1 = <span class="number">-15</span>:<span class="number">1</span>:<span class="number">15</span>;</span><br><span class="line">x2 = <span class="number">-15</span>:<span class="number">1</span>:<span class="number">15</span>;</span><br><span class="line">[x1, x2] = <span class="built_in">meshgrid</span>(x1,x2);</span><br><span class="line">y = x1.^<span class="number">2</span> + x2.^<span class="number">2</span> - x1.*x2 - <span class="number">10</span>*x1 - <span class="number">4</span>*x2 + <span class="number">60</span>;</span><br><span class="line">mesh(x1, x2, y)</span><br><span class="line">xlabel(<span class="string">&#x27;x1&#x27;</span>);  ylabel(<span class="string">&#x27;x2&#x27;</span>);  zlabel(<span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">axis vis3d <span class="comment">% 冻结屏幕高宽比，使得一个三维对象的旋转不会改变坐标轴的刻度显示</span></span><br><span class="line"><span class="built_in">hold</span> on </span><br><span class="line"></span><br><span class="line"><span class="comment">%% 粒子群算法中的预设参数</span></span><br><span class="line">n = <span class="number">30</span>;</span><br><span class="line">narvs = <span class="number">2</span>;</span><br><span class="line">c1 = <span class="number">2</span>;</span><br><span class="line">c2 = <span class="number">2</span>;</span><br><span class="line">w = <span class="number">0.9</span>;</span><br><span class="line">K = <span class="number">100</span>;</span><br><span class="line">vmax = [<span class="number">6</span> <span class="number">6</span>];</span><br><span class="line">x_lb = [<span class="number">-15</span> <span class="number">-15</span>];</span><br><span class="line">x_ub = [<span class="number">15</span> <span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 初始化粒子的位置和速度</span></span><br><span class="line">x = <span class="built_in">zeros</span>(n,narvs);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: narvs</span><br><span class="line">    x(:,<span class="built_in">i</span>) = x_lb(<span class="built_in">i</span>) + (x_ub(<span class="built_in">i</span>)-x_lb(<span class="built_in">i</span>))*<span class="built_in">rand</span>(n,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">v = -vmax + <span class="number">2</span>*vmax .* <span class="built_in">rand</span>(n,narvs);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 计算适应度(注意，因为是最小化问题，所以适应度越小越好)</span></span><br><span class="line">fit = <span class="built_in">zeros</span>(n,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    fit(<span class="built_in">i</span>) = Obj_fun2(x(<span class="built_in">i</span>,:));</span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line">pbest = x;</span><br><span class="line">ind = <span class="built_in">find</span>(fit == <span class="built_in">min</span>(fit), <span class="number">1</span>);</span><br><span class="line">gbest = x(ind,:)</span><br><span class="line"></span><br><span class="line">h = <span class="built_in">scatter3</span>(x(:,<span class="number">1</span>),x(:,<span class="number">2</span>),fit,<span class="string">&#x27;*r&#x27;</span>);</span><br><span class="line"><span class="comment">%% 迭代K次来更新速度与位置</span></span><br><span class="line">fitnessbest = <span class="built_in">ones</span>(K,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> d = <span class="number">1</span>:K</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n </span><br><span class="line">    	<span class="comment">% 更新第i个粒子的速度</span></span><br><span class="line">        v(<span class="built_in">i</span>,:) = w*v(<span class="built_in">i</span>,:) + c1*<span class="built_in">rand</span>(<span class="number">1</span>)*(pbest(<span class="built_in">i</span>,:) - x(<span class="built_in">i</span>,:)) + c2*<span class="built_in">rand</span>(<span class="number">1</span>)*(gbest - x(<span class="built_in">i</span>,:));  </span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> v(<span class="built_in">i</span>,<span class="built_in">j</span>) &lt; -vmax(<span class="built_in">j</span>)</span><br><span class="line">                v(<span class="built_in">i</span>,<span class="built_in">j</span>) = -vmax(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> v(<span class="built_in">i</span>,<span class="built_in">j</span>) &gt; vmax(<span class="built_in">j</span>)</span><br><span class="line">                v(<span class="built_in">i</span>,<span class="built_in">j</span>) = vmax(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% 更新第i个粒子的位置</span></span><br><span class="line">        x(<span class="built_in">i</span>,:) = x(<span class="built_in">i</span>,:) + v(<span class="built_in">i</span>,:); </span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> x(<span class="built_in">i</span>,<span class="built_in">j</span>) &lt; x_lb(<span class="built_in">j</span>)</span><br><span class="line">                x(<span class="built_in">i</span>,<span class="built_in">j</span>) = x_lb(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> x(<span class="built_in">i</span>,<span class="built_in">j</span>) &gt; x_ub(<span class="built_in">j</span>)</span><br><span class="line">                x(<span class="built_in">i</span>,<span class="built_in">j</span>) = x_ub(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% 重新计算第i个粒子的适应度</span></span><br><span class="line">        fit(<span class="built_in">i</span>) = Obj_fun2(x(<span class="built_in">i</span>,:));</span><br><span class="line">        <span class="keyword">if</span> fit(<span class="built_in">i</span>) &lt; Obj_fun2(pbest(<span class="built_in">i</span>,:))</span><br><span class="line">           pbest(<span class="built_in">i</span>,:) = x(<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> fit(<span class="built_in">i</span>) &lt; Obj_fun2(gbest)</span><br><span class="line">            gbest = pbest(<span class="built_in">i</span>,:);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    fitnessbest(d) = Obj_fun2(gbest);</span><br><span class="line">    pause(<span class="number">0.1</span>)</span><br><span class="line">    h.XData = x(:,<span class="number">1</span>);</span><br><span class="line">    h.YData = x(:,<span class="number">2</span>);</span><br><span class="line">    h.ZData = fit;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 绘制出每次迭代最佳适应度的变化图</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>) </span><br><span class="line"><span class="built_in">plot</span>(fitnessbest)  </span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的位置是：&#x27;</span>); <span class="built_in">disp</span>(gbest)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(Obj_fun2(gbest))</span><br></pre></td></tr></table></figure>
<h2 id="matlab-工具箱">Matlab 工具箱</h2>
<p>Matlab 中 <code>particleswarm</code> 函数采用的是自适应的邻域模式，只将周围部分粒子视为领域粒子，这种模式使得粒子群可以被分割为多个不同的子群体，有利于在多个区域进行搜索，避免陷入局部最优。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507191129731.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507191200603.png" /></p>
<h2 id="进阶">进阶</h2>
<p>粒子群可以解决 非线性约束 问题，在适应度函数上构造 <strong>惩罚项</strong> , 对违反约束的情况进行惩罚, 将有约束的优化问题转化为无约束的优化问题。</p>
<p>粒子群算法最初提出来用于连续空间的优化，从核心运动公式上看，定义的都是连续的变量，对于组合优化问题，不适于求解，需要重新定义粒子群算法的运动公式和符号，或者采用其他启发式算法（比如：模拟退火算法）。</p>
<p>粒子群算法不需要给初始值，只需要给一个搜索的范围。</p>
<h3 id="方程组求解">方程组求解</h3>
<p>对于方程组求解，可以合并构造求最小值为 0。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192036403.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span> = <span class="title">my_fun</span><span class="params">(x)</span></span></span><br><span class="line">    F(<span class="number">1</span>) = <span class="built_in">abs</span>(x(<span class="number">1</span>)+x(<span class="number">2</span>))-<span class="built_in">abs</span>(x(<span class="number">3</span>));</span><br><span class="line">    F(<span class="number">2</span>) = x(<span class="number">1</span>) * x(<span class="number">2</span>) * x(<span class="number">3</span>) + <span class="number">18</span>;</span><br><span class="line">    F(<span class="number">3</span>) = x(<span class="number">1</span>)^<span class="number">2</span>*x(<span class="number">2</span>)+<span class="number">3</span>*x(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%% vpasolve函数</span></span><br><span class="line">syms x1 x2 x3</span><br><span class="line">eqn =  [<span class="built_in">abs</span>(x1+x2)-<span class="built_in">abs</span>(x3)  == <span class="number">0</span>, x1*x2*x3+<span class="number">18</span> == <span class="number">0</span>, x1^<span class="number">2</span>*x2+<span class="number">3</span>*x3 == <span class="number">0</span>]</span><br><span class="line">[x1, x2, x3] = vpasolve(eqn, [x1, x2, x3], [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>])  </span><br><span class="line">[x1, x2, x3] = vpasolve(eqn, [x1, x2, x3], [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>])  <span class="comment">% 换一个初始值试试</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% fsolve函数</span></span><br><span class="line">x0 = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>];  <span class="comment">% 初始值</span></span><br><span class="line">x = fsolve(@my_fun, x0)</span><br><span class="line">x0 = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>];  <span class="comment">% 初始值</span></span><br><span class="line">format long g</span><br><span class="line">x = fsolve(@my_fun,x0)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Obj_fun</span><span class="params">(x)</span></span></span><br><span class="line">    f1= <span class="built_in">abs</span>(x(<span class="number">1</span>)+x(<span class="number">2</span>))-<span class="built_in">abs</span>(x(<span class="number">3</span>)) ;</span><br><span class="line">    f2= x(<span class="number">1</span>) * x(<span class="number">2</span>) * x(<span class="number">3</span>) + <span class="number">18</span>;</span><br><span class="line">    f3= x(<span class="number">1</span>)^<span class="number">2</span> * x(<span class="number">2</span>) + <span class="number">3</span>*x(<span class="number">3</span>);</span><br><span class="line">    f = <span class="built_in">abs</span>(f1) + <span class="built_in">abs</span>(f2) + <span class="built_in">abs</span>(f3);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">%% 粒子群算法，求最小值到0</span></span><br><span class="line">narvs = <span class="number">3</span>;</span><br><span class="line"><span class="comment">% 使用粒子群算法，不需要指定初始值，只需要给定一个搜索的范围</span></span><br><span class="line">lb = <span class="number">-10</span>*<span class="built_in">ones</span>(<span class="number">1</span>,<span class="number">3</span>);  ub = <span class="number">10</span>*<span class="built_in">ones</span>(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">options = optimoptions(<span class="string">&#x27;particleswarm&#x27;</span>,<span class="string">&#x27;FunctionTolerance&#x27;</span>,<span class="number">1e-12</span>, <span class="string">&#x27;MaxStallIterations&#x27;</span>,<span class="number">100</span>,<span class="string">&#x27;MaxIterations&#x27;</span>,<span class="number">20000</span>, <span class="string">&#x27;SwarmSize&#x27;</span>,<span class="number">100</span>);</span><br><span class="line">[x, fval] = particleswarm(@Obj_fun, narvs, lb, ub, options)</span><br></pre></td></tr></table></figure>
<h3 id="多元函数拟合">多元函数拟合</h3>
<p>cftool 拟合工具箱只能对一元函数和二元函数进行拟合。</p>
<p>最小二乘法拟合的本质，求最小值问题。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192447225.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507192510192.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Obj_fun</span><span class="params">(k)</span></span></span><br><span class="line">    <span class="keyword">global</span> x y;</span><br><span class="line">    y_hat = <span class="built_in">exp</span>(-k(<span class="number">1</span>)*x(:,<span class="number">1</span>)) .* <span class="built_in">sin</span>(k(<span class="number">2</span>)*x(:,<span class="number">2</span>)) + x(:,<span class="number">3</span>).^<span class="number">2</span>;  <span class="comment">% 拟合值</span></span><br><span class="line">    f = sum((y - y_hat) .^ <span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> x y;  <span class="comment">% 将x和y定义为全局变量（方便在子函数中直接调用，要先声明）</span></span><br><span class="line">load data_x_y  <span class="comment">% 数据集内里面有x和y两个变量</span></span><br><span class="line">k0 = [<span class="number">0</span> <span class="number">0</span>];  <span class="comment">% 这个初始值的选取需要尝试</span></span><br><span class="line">lb = []; ub = [];</span><br><span class="line">[k, fval] = fmincon(@Obj_fun,k0,[],[],[],[],lb,ub)  </span><br><span class="line"></span><br><span class="line"><span class="comment">%% 求解无约束非线性函数的最小值的两个函数</span></span><br><span class="line">[k, fval] = fminsearch(@Obj_fun,k0)   <span class="comment">% Nelder-Mead单纯形法求解最小值，适用于解决不可导或求导复杂的函数优化问题</span></span><br><span class="line">[k, fval] = fminunc(@Obj_fun,k0)  <span class="comment">% 拟牛顿法求解无约束最小值，适用于解决求导容易的函数优化问题</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 计算拟合值和实际值的相对误差</span></span><br><span class="line">y_hat = <span class="built_in">exp</span>(-k(<span class="number">1</span>)*x(:,<span class="number">1</span>)) .* <span class="built_in">sin</span>(k(<span class="number">2</span>)*x(:,<span class="number">2</span>)) + x(:,<span class="number">3</span>).^<span class="number">2</span>;  <span class="comment">% 计算拟合值</span></span><br><span class="line">res_rate = <span class="built_in">abs</span>(y - y_hat) ./ y;  <span class="comment">%  相对误差</span></span><br><span class="line"><span class="built_in">plot</span>(res_rate) <span class="comment">% 每个样本对应的相对误差</span></span><br><span class="line"><span class="built_in">mean</span>(res_rate) <span class="comment">% 平均相对误差</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 非线性最小二乘拟合函数lsqcurvefit</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y_hat</span> = <span class="title">fit_fun</span><span class="params">(k,x)</span></span></span><br><span class="line">    y_hat = <span class="built_in">exp</span>(-k(<span class="number">1</span>)*x(:,<span class="number">1</span>)) .* <span class="built_in">sin</span>(k(<span class="number">2</span>)*x(:,<span class="number">2</span>)) + x(:,<span class="number">3</span>).^<span class="number">2</span>;  <span class="comment">% 返回的函数就是我们的拟合值</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">k0 = [<span class="number">0</span> <span class="number">0</span>]; <span class="comment">% 初始值</span></span><br><span class="line">lb = []; ub = [];</span><br><span class="line">[k, fval] = lsqcurvefit(@fit_fun,k0,x,y,lb,ub)</span><br><span class="line"><span class="comment">% Choose between &#x27;trust-region-reflective&#x27; (default) and &#x27;levenberg-marquardt&#x27;.</span></span><br><span class="line">options= optimoptions(<span class="string">&#x27;lsqcurvefit&#x27;</span>,<span class="string">&#x27;Algorithm&#x27;</span>,<span class="string">&#x27;levenberg-marquardt&#x27;</span>);</span><br><span class="line">[k, fval] = lsqcurvefit(@fit_fun,k0,x,y,lb,ub,options)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 粒子群法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Obj_fun</span><span class="params">(k)</span></span></span><br><span class="line">    <span class="keyword">global</span> x y;  <span class="comment">% 在子函数中使用全局变量前也需要声明下</span></span><br><span class="line">    y_hat = <span class="built_in">exp</span>(-k(<span class="number">1</span>)*x(:,<span class="number">1</span>)) .* <span class="built_in">sin</span>(k(<span class="number">2</span>)*x(:,<span class="number">2</span>)) + x(:,<span class="number">3</span>).^<span class="number">2</span>;</span><br><span class="line">    f = sum((y - y_hat) .^ <span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">narvs = <span class="number">2</span>;</span><br><span class="line">lb = [<span class="number">-10</span> <span class="number">-10</span>];  ub = [<span class="number">10</span> <span class="number">10</span>];  </span><br><span class="line">[k, fval] = particleswarm(@Obj_fun,narvs,lb,ub) </span><br><span class="line"><span class="comment">% 使用粒子群算法后再利用fmincon函数混合求解</span></span><br><span class="line">options = optimoptions(<span class="string">&#x27;particleswarm&#x27;</span>,<span class="string">&#x27;HybridFcn&#x27;</span>,@fmincon);</span><br><span class="line">[k,fval] = particleswarm(@Obj_fun,narvs,lb,ub,options)</span><br></pre></td></tr></table></figure>
<h3 id="微分方程拟合参数选取">微分方程拟合参数选取</h3>
<p>为微分方程选取最好的拟合参数，粒子群作为最外层搜索框架来寻找参数。</p>
<p>网格搜索，确定范围，枚举参数，逐步缩小，如果我们有多个要搜索的变量，网格搜索法就很难办了，多重循环会大大增加搜索时间。</p>
<p>粒子群算法计算的结果具有随机性，结果可能会变换，可以多次运行取一个最好的结果。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507193816758.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507194051903.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200152554.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">SIR_fun</span><span class="params">(t,x,beta,gamma)</span>   </span></span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - <span class="built_in">gamma</span>*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">load mydata.mat  <span class="comment">% 导入数据（共三列，分别是S,I,R的数量）</span></span><br><span class="line">n = <span class="built_in">size</span>(mydata,<span class="number">1</span>);  <span class="comment">% 一共有多少行数据</span></span><br><span class="line"><span class="built_in">true</span>_s = mydata(:,<span class="number">1</span>);   </span><br><span class="line"><span class="built_in">true</span>_i = mydata(:,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">true</span>_r = mydata(:,<span class="number">3</span>);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:n,<span class="built_in">true</span>_i,<span class="string">&#x27;b-&#x27;</span>,<span class="number">1</span>:n,<span class="built_in">true</span>_r,<span class="string">&#x27;g-&#x27;</span>) <span class="comment">% 单独画出真实的I和R的数量</span></span><br><span class="line"><span class="built_in">hold</span> on  <span class="comment">% 等会接着在这个图形上面画图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 网格法搜索（枚举法） 地毯式搜索</span></span><br><span class="line">BETA = <span class="number">0.1</span>:<span class="number">0.01</span>:<span class="number">0.3</span>;  <span class="comment">% 估计一个BETA所在的范围</span></span><br><span class="line">GAMMA = <span class="number">0.01</span>:<span class="number">0.001</span>:<span class="number">0.1</span>;  <span class="comment">% 估计一个GAMMA所在的范围</span></span><br><span class="line">n1 = <span class="built_in">length</span>(BETA);</span><br><span class="line">n2 = <span class="built_in">length</span>(GAMMA);</span><br><span class="line">SSE = <span class="built_in">zeros</span>(n1,n2);  <span class="comment">% 初始化残差平方和矩阵</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n1</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:n2</span><br><span class="line">        <span class="built_in">beta</span> = BETA(<span class="built_in">i</span>);</span><br><span class="line">        <span class="built_in">gamma</span> = GAMMA(<span class="built_in">j</span>);</span><br><span class="line">        [t,p]=ode45(@(t,x) SIR_fun(t,x,<span class="built_in">beta</span>,<span class="built_in">gamma</span>), [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);</span><br><span class="line">        p = <span class="built_in">round</span>(p);</span><br><span class="line">        sse = sum((<span class="built_in">true</span>_s - p(:,<span class="number">1</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_i -  p(:,<span class="number">2</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_r - p(:,<span class="number">3</span>)).^<span class="number">2</span>);</span><br><span class="line">        SSE(<span class="built_in">i</span>,<span class="built_in">j</span>) = sse;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% 画出SSE这个矩阵的热力图</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>) </span><br><span class="line">pcolor(GAMMA,BETA,SSE)  <span class="comment">% 注意，这里GAMMA和BETA的顺序不能反了（类似于更新13里面的mesh函数的用法）</span></span><br><span class="line">colorbar</span><br><span class="line">min_sse = <span class="built_in">min</span>(<span class="built_in">min</span>(SSE));</span><br><span class="line">[r,c] = <span class="built_in">find</span>(SSE == min_sse,<span class="number">1</span>);  <span class="comment">% find后面加了一个1，表示返回第一个最小值所在的行和列的序号</span></span><br><span class="line"><span class="built_in">beta</span> = BETA(r)</span><br><span class="line"><span class="built_in">gamma</span> = GAMMA(c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:n,<span class="built_in">true</span>_i,<span class="string">&#x27;b-&#x27;</span>,<span class="number">1</span>:n,<span class="built_in">true</span>_r,<span class="string">&#x27;g-&#x27;</span>) <span class="comment">% 单独画出真实的I和R的数量</span></span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">[t,p]=ode45(@(t,x) SIR_fun(t,x,<span class="built_in">beta</span>,<span class="built_in">gamma</span>), [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);</span><br><span class="line">p = <span class="built_in">round</span>(p);</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:n,p(:,<span class="number">2</span>),<span class="string">&#x27;b--&#x27;</span>,<span class="number">1</span>:n,p(:,<span class="number">3</span>),<span class="string">&#x27;g--&#x27;</span>) </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;拟合的I&#x27;</span>,<span class="string">&#x27;拟合的R&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Obj_fun</span><span class="params">(h)</span>  </span></span><br><span class="line">    <span class="keyword">global</span> <span class="built_in">true</span>_s <span class="built_in">true</span>_i <span class="built_in">true</span>_r n</span><br><span class="line">    <span class="built_in">beta</span> = h(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">gamma</span> = h(<span class="number">2</span>);</span><br><span class="line">    [t,p]=ode45(@(t,x) SIR_fun(t,x,<span class="built_in">beta</span>,<span class="built_in">gamma</span>), [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">    p = <span class="built_in">round</span>(p);</span><br><span class="line">    f = sum((<span class="built_in">true</span>_s - p(:,<span class="number">1</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_i -  p(:,<span class="number">2</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_r - p(:,<span class="number">3</span>)).^<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 粒子群算法来求解</span></span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span>]; </span><br><span class="line">ub = [<span class="number">1</span> <span class="number">1</span>];  </span><br><span class="line">nvars = <span class="number">2</span>;</span><br><span class="line">options = optimoptions(<span class="string">&#x27;particleswarm&#x27;</span>,<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;iter&#x27;</span>,<span class="string">&#x27;SwarmSize&#x27;</span>,<span class="number">100</span>,<span class="string">&#x27;PlotFcn&#x27;</span>,<span class="string">&#x27;pswplotbestf&#x27;</span>);</span><br><span class="line">[h, fval] = particleswarm(@Obj_fun,nvars,lb,ub,options)  <span class="comment">% h就是要优化的参数，fval是目标函数值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">beta</span> = h(<span class="number">1</span>);  <span class="comment">% 易感染者与已感染者接触且被传染的强度</span></span><br><span class="line"><span class="built_in">gamma</span> = h(<span class="number">2</span>);  <span class="comment">% 康复率</span></span><br><span class="line">[t,p]=ode45(@(t,x) SIR_fun(t,x,<span class="built_in">beta</span>,<span class="built_in">gamma</span>), [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">p = <span class="built_in">round</span>(p);  <span class="comment">% 对p进行四舍五入(人数为整数)</span></span><br><span class="line">sse = sum((<span class="built_in">true</span>_s - p(:,<span class="number">1</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_i -  p(:,<span class="number">2</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_r - p(:,<span class="number">3</span>)).^<span class="number">2</span>)  <span class="comment">% 计算残差平方和</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 真实的人数和拟合的人数放到一起看看</span></span><br><span class="line">N = <span class="number">27</span>; <span class="comment">% 计算N天</span></span><br><span class="line">[t,p]=ode45(@(t,x) SIR_fun(t,x,<span class="built_in">beta</span>,<span class="built_in">gamma</span>), [<span class="number">1</span>:N],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">p = <span class="built_in">round</span>(p);  <span class="comment">% 对p进行四舍五入(人数为整数)</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:n,<span class="built_in">true</span>_i,<span class="string">&#x27;b-&#x27;</span>,<span class="number">1</span>:n,<span class="built_in">true</span>_r,<span class="string">&#x27;g-&#x27;</span>) </span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:N,p(:,<span class="number">2</span>),<span class="string">&#x27;b--&#x27;</span>,<span class="number">1</span>:N,p(:,<span class="number">3</span>),<span class="string">&#x27;g--&#x27;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;拟合的I&#x27;</span>,<span class="string">&#x27;拟合的R&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>参数进一步假设参数为线性变化过程：</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200250193.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210507200306931.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span>=<span class="title">SIR_fun</span><span class="params">(t,x,beta1,beta2,a,b)</span>  </span></span><br><span class="line">    <span class="comment">% beta1 : t&lt;=15时，易感染者与已感染者接触且被传染的强度</span></span><br><span class="line">    <span class="comment">% beta2 : t&gt;15时，易感染者与已感染者接触且被传染的强度</span></span><br><span class="line">    <span class="comment">% a : 康复率gamma = a+bt</span></span><br><span class="line">    <span class="comment">% b : 康复率gamma = a+bt</span></span><br><span class="line">    <span class="keyword">if</span> t &lt;=<span class="number">15</span></span><br><span class="line">        <span class="built_in">beta</span> = beta1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">beta</span> = beta2;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">gamma</span> = a + b * t;  </span><br><span class="line">    dx = <span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">    C = x(<span class="number">1</span>)+x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">1</span>) = - <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C;  </span><br><span class="line">    dx(<span class="number">2</span>) = <span class="built_in">beta</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)/C - <span class="built_in">gamma</span>*x(<span class="number">2</span>);</span><br><span class="line">    dx(<span class="number">3</span>) = <span class="built_in">gamma</span>*x(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> = <span class="title">Obj_fun</span><span class="params">(h)</span>  </span></span><br><span class="line">    <span class="keyword">global</span> <span class="built_in">true</span>_s  <span class="built_in">true</span>_i  <span class="built_in">true</span>_r n </span><br><span class="line">    beta1 = h(<span class="number">1</span>);</span><br><span class="line">    beta2 = h(<span class="number">2</span>);</span><br><span class="line">    a = h(<span class="number">3</span>);</span><br><span class="line">    b = h(<span class="number">4</span>);</span><br><span class="line">    [t,p]=ode45(@(t,x) SIR_fun(t,x,beta1,beta2,a,b) , [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">    p = <span class="built_in">round</span>(p);</span><br><span class="line">    f = sum((<span class="built_in">true</span>_s - p(:,<span class="number">1</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_i -  p(:,<span class="number">2</span>)).^<span class="number">2</span>  + (<span class="built_in">true</span>_r - p(:,<span class="number">3</span>)).^<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 粒子群算法来求解</span></span><br><span class="line"><span class="comment">% beta1,beta2,a,b</span></span><br><span class="line"><span class="comment">% 给定参数的搜索范围（根据题目来给），后期可缩小范围</span></span><br><span class="line">lb = [<span class="number">0</span> <span class="number">0</span> <span class="number">-1</span> <span class="number">-1</span>]; </span><br><span class="line">ub = [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span>];  </span><br><span class="line">options = optimoptions(<span class="string">&#x27;particleswarm&#x27;</span>,<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;iter&#x27;</span>,<span class="string">&#x27;SwarmSize&#x27;</span>,<span class="number">200</span>);</span><br><span class="line">[h, fval] = particleswarm(@Obj_fun, <span class="number">4</span>, lb, ub, options)</span><br><span class="line">beta1 = h(<span class="number">1</span>);  <span class="comment">% t&lt;=15时，易感染者与已感染者接触且被传染的强度</span></span><br><span class="line">beta2 = h(<span class="number">2</span>);  <span class="comment">% t&gt;15时，易感染者与已感染者接触且被传染的强度</span></span><br><span class="line">a = h(<span class="number">3</span>); <span class="comment">% 康复率gamma = a+bt</span></span><br><span class="line">b = h(<span class="number">4</span>);  <span class="comment">% 康复率gamma = a+bt</span></span><br><span class="line">[t,p]=ode45(@(t,x) SIR_fun(t,x,beta1,beta2,a,b), [<span class="number">1</span>:n],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">p = <span class="built_in">round</span>(p);</span><br><span class="line">N = <span class="number">27</span>; <span class="comment">% 计算N天</span></span><br><span class="line">[t,p]=ode45(@(t,x) SIR_fun(t,x,beta1,beta2,a,b), [<span class="number">1</span>:N],[<span class="built_in">true</span>_s(<span class="number">1</span>) <span class="built_in">true</span>_i(<span class="number">1</span>) <span class="built_in">true</span>_r(<span class="number">1</span>)]);   </span><br><span class="line">p = <span class="built_in">round</span>(p);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:n,<span class="built_in">true</span>_i,<span class="string">&#x27;b-&#x27;</span>,<span class="number">1</span>:n,<span class="built_in">true</span>_r,<span class="string">&#x27;g-&#x27;</span>) </span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:N,p(:,<span class="number">2</span>),<span class="string">&#x27;b--&#x27;</span>,<span class="number">1</span>:N,p(:,<span class="number">3</span>),<span class="string">&#x27;g--&#x27;</span>) </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;拟合的I&#x27;</span>,<span class="string">&#x27;拟合的R&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="模拟退火算法">模拟退火算法</h1>
<p>又称 SA 算法，基于金属模拟退火机理，能够以随机搜索技术从概率意义上找到目标函数的全局最值点。</p>
<h2 id="与粒子群算法对比">与粒子群算法对比</h2>
<p>不仅能够处理连续优化问题，也能方便的处理组合优化问题。</p>
<p>对参数的选取至关重要。</p>
<p>面对不同的问题，需要设计不同的退火过程，不同过程得到的准确度和效率可能有较大差别。</p>
<h2 id="引入">引入</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512170256977.png" /></p>
<p>爬山法的局限是特别容易找到局部最优解，模拟退火算法能以一定的概率接受一个比当前解要差的解，跳出局部区域。</p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512170513793.png" /></p>
<h2 id="关键步骤-1">关键步骤</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512171433178.png" /></p>
<h3 id="概率设置">概率设置</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512181751107.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512171650540.png" /></p>
<h3 id="搜索终止条件-1">搜索终止条件</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512182034071.png" /></p>
<h2 id="例题解决-1">例题解决</h2>
<p>新解的设置随着具体问题具体分析：</p>
<h3 id="例1-求给定函数最值">例1 求给定函数最值</h3>
<figure>
<img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512181413884.png" alt="image-20210512181413884" /><figcaption>image-20210512181413884</figcaption>
</figure>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512183822688.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span> = <span class="title">Obj_fun1</span><span class="params">(x)</span></span></span><br><span class="line">    y = <span class="number">11</span>*<span class="built_in">sin</span>(x) + <span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">5</span>*x);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">f = @(x) <span class="number">11</span>*<span class="built_in">sin</span>(x) + <span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">5</span>*x);</span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line">fplot(f, [<span class="number">-3</span> <span class="number">3</span>])</span><br><span class="line"><span class="built_in">hold</span> on  <span class="comment">% 不关闭图形，继续在上面画图</span></span><br><span class="line"></span><br><span class="line">narvs = <span class="number">1</span>; <span class="comment">% 变量个数</span></span><br><span class="line">T0 = <span class="number">100</span>; <span class="comment">% 初始温度</span></span><br><span class="line">T = T0; </span><br><span class="line">maxgen = <span class="number">200</span>;  <span class="comment">% 最大迭代次数</span></span><br><span class="line">Lk = <span class="number">100</span>;  <span class="comment">% 每个温度下的迭代次数</span></span><br><span class="line">alfa = <span class="number">0.95</span>;  <span class="comment">% 温度衰减系数</span></span><br><span class="line">x_lb = <span class="number">-3</span>; <span class="comment">% x的下界</span></span><br><span class="line">x_ub = <span class="number">3</span>; <span class="comment">% x的上界</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%  随机生成一个初始解</span></span><br><span class="line">x0 = <span class="built_in">zeros</span>(<span class="number">1</span>,narvs);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: narvs</span><br><span class="line">    x0(<span class="built_in">i</span>) = x_lb(<span class="built_in">i</span>) + (x_ub(<span class="built_in">i</span>) - x_lb(<span class="built_in">i</span>)) * <span class="built_in">rand</span>(<span class="number">1</span>);    </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">y0 = Obj_fun1(x0);</span><br><span class="line">h = <span class="built_in">scatter</span>(x0, y0, <span class="string">&#x27;*r&#x27;</span>);</span><br><span class="line"></span><br><span class="line">max_y = y0; <span class="comment">% 初始化找到的最佳的解对应的函数值为y0</span></span><br><span class="line">MAXY = <span class="built_in">zeros</span>(maxgen,<span class="number">1</span>); <span class="comment">% 记录每一次外层循环结束后找到的max_y</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span>:maxgen</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:Lk  <span class="comment">% 内循环，在每个温度下开始迭代</span></span><br><span class="line">        y = <span class="built_in">randn</span>(<span class="number">1</span>, narvs); <span class="comment">% 生成 1 行 narvs 列的 N(0,1) 随机数</span></span><br><span class="line">        z = y / <span class="built_in">sqrt</span>(sum(y.^<span class="number">2</span>));</span><br><span class="line">        x_new = x0 + z * T;</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> x_new(<span class="built_in">j</span>) &lt; x_lb(<span class="built_in">j</span>)</span><br><span class="line">                r = <span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">                x_new(<span class="built_in">j</span>) = r * x_lb(<span class="built_in">j</span>) + (<span class="number">1</span>-r) * x0(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> x_new(<span class="built_in">j</span>) &gt; x_ub(<span class="built_in">j</span>)</span><br><span class="line">                r = <span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">                x_new(<span class="built_in">j</span>) = r * x_ub(<span class="built_in">j</span>) + (<span class="number">1</span>-r) * x0(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        x1 = x_new;</span><br><span class="line">        y1 = Obj_fun1(x1);</span><br><span class="line">        <span class="keyword">if</span> y1 &gt; y0</span><br><span class="line">            x0 = x1;</span><br><span class="line">            y0 = y1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p = <span class="built_in">exp</span>(-(y0 - y1)/T);</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">rand</span>(<span class="number">1</span>) &lt; p</span><br><span class="line">                x0 = x1;</span><br><span class="line">                y0 = y1;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> y0 &gt; max_y</span><br><span class="line">            max_y = y0;</span><br><span class="line">            best_x = x0;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    MAXY(iter) = max_y;</span><br><span class="line">    T = alfa * T;</span><br><span class="line">    pause(<span class="number">0.01</span>)</span><br><span class="line">    h.XData = x0;</span><br><span class="line">    h.YData = Obj_fun1(x0);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的位置是：&#x27;</span>); <span class="built_in">disp</span>(best_x)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(max_y)</span><br><span class="line">pause(<span class="number">0.5</span>)</span><br><span class="line">h.XData = [];  h.YData = [];</span><br><span class="line"><span class="built_in">scatter</span>(best_x,max_y,<span class="string">&#x27;*r&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:maxgen, MAXY, <span class="string">&#x27;b-&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;y的值&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512183859684.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span> = <span class="title">Obj_fun2</span><span class="params">(x)</span></span></span><br><span class="line">    y = x(<span class="number">1</span>)^<span class="number">2</span> + x(<span class="number">2</span>)^<span class="number">2</span> - x(<span class="number">1</span>)*x(<span class="number">2</span>) - <span class="number">10</span>*x(<span class="number">1</span>) - <span class="number">4</span>*x(<span class="number">2</span>) + <span class="number">60</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span> </span><br><span class="line">x1 = <span class="number">-15</span>:<span class="number">1</span>:<span class="number">15</span>;</span><br><span class="line">x2 = <span class="number">-15</span>:<span class="number">1</span>:<span class="number">15</span>;</span><br><span class="line">[x1,x2] = <span class="built_in">meshgrid</span>(x1,x2);</span><br><span class="line">y = x1.^<span class="number">2</span> + x2.^<span class="number">2</span> - x1.*x2 - <span class="number">10</span>*x1 - <span class="number">4</span>*x2 + <span class="number">60</span>;</span><br><span class="line">mesh(x1,x2,y)</span><br><span class="line">xlabel(<span class="string">&#x27;x1&#x27;</span>);  ylabel(<span class="string">&#x27;x2&#x27;</span>);  zlabel(<span class="string">&#x27;y&#x27;</span>); </span><br><span class="line">axis vis3d </span><br><span class="line"><span class="built_in">hold</span> on </span><br><span class="line"></span><br><span class="line">narvs = <span class="number">2</span>; </span><br><span class="line">T0 = <span class="number">100</span>; </span><br><span class="line">T = T0; </span><br><span class="line">maxgen = <span class="number">200</span>; </span><br><span class="line">Lk = <span class="number">100</span>; </span><br><span class="line">alfa = <span class="number">0.95</span>; </span><br><span class="line">x_lb = [<span class="number">-15</span> <span class="number">-15</span>]; </span><br><span class="line">x_ub = [<span class="number">15</span> <span class="number">15</span>]; </span><br><span class="line"></span><br><span class="line">x0 = <span class="built_in">zeros</span>(<span class="number">1</span>,narvs);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>: narvs</span><br><span class="line">    x0(<span class="built_in">i</span>) = x_lb(<span class="built_in">i</span>) + (x_ub(<span class="built_in">i</span>)-x_lb(<span class="built_in">i</span>))*<span class="built_in">rand</span>(<span class="number">1</span>);    </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">y0 = Obj_fun2(x0);</span><br><span class="line">h = <span class="built_in">scatter3</span>(x0(<span class="number">1</span>),x0(<span class="number">2</span>),y0,<span class="string">&#x27;*r&#x27;</span>); </span><br><span class="line"></span><br><span class="line">min_y = y0; </span><br><span class="line">MINY = <span class="built_in">zeros</span>(maxgen,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span> : maxgen </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : Lk </span><br><span class="line">        y = <span class="built_in">randn</span>(<span class="number">1</span>,narvs); </span><br><span class="line">        z = y / <span class="built_in">sqrt</span>(sum(y.^<span class="number">2</span>));</span><br><span class="line">        x_new = x0 + z*T; </span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>: narvs</span><br><span class="line">            <span class="keyword">if</span> x_new(<span class="built_in">j</span>) &lt; x_lb(<span class="built_in">j</span>)</span><br><span class="line">                r = <span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">                x_new(<span class="built_in">j</span>) = r*x_lb(<span class="built_in">j</span>)+(<span class="number">1</span>-r)*x0(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">elseif</span> x_new(<span class="built_in">j</span>) &gt; x_ub(<span class="built_in">j</span>)</span><br><span class="line">                r = <span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">                x_new(<span class="built_in">j</span>) = r*x_ub(<span class="built_in">j</span>)+(<span class="number">1</span>-r)*x0(<span class="built_in">j</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        x1 = x_new; </span><br><span class="line">        y1 = Obj_fun2(x1);</span><br><span class="line">        <span class="keyword">if</span> y1 &lt; y0</span><br><span class="line">            x0 = x1; </span><br><span class="line">            y0 = y1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p = <span class="built_in">exp</span>(-(y1 - y0)/T);</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">rand</span>(<span class="number">1</span>) &lt; p </span><br><span class="line">                x0 = x1;  </span><br><span class="line">                y0 = y1;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> y0 &lt; min_y </span><br><span class="line">            min_y = y0; </span><br><span class="line">            best_x = x0; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    MINY(iter) = min_y; <span class="comment">%</span></span><br><span class="line">    T = alfa*T;</span><br><span class="line">    pause(<span class="number">0.02</span>)</span><br><span class="line">    h.XData = x0(<span class="number">1</span>);</span><br><span class="line">    h.YData = x0(<span class="number">2</span>);</span><br><span class="line">    h.ZData = Obj_fun2(x0);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的位置是：&#x27;</span>); <span class="built_in">disp</span>(best_x)</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(min_y)</span><br><span class="line"></span><br><span class="line">pause(<span class="number">0.5</span>) </span><br><span class="line">h.XData = [];  h.YData = [];  h.ZData = [];  <span class="comment">% 将原来的散点删除</span></span><br><span class="line"><span class="built_in">scatter3</span>(best_x(<span class="number">1</span>), best_x(<span class="number">2</span>), min_y,<span class="string">&#x27;*r&#x27;</span>);  <span class="comment">% 在最小值处重新标上散点</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:maxgen,MINY,<span class="string">&#x27;b-&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;y的值&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="例2-旅行商问题">例2 旅行商问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185127265.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185226456.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185320870.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512185348249.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">result</span> =  <span class="title">calculate_tsp_d</span><span class="params">(path,d)</span></span></span><br><span class="line">    n = <span class="built_in">length</span>(path);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n<span class="number">-1</span>  </span><br><span class="line">        result = d(path(<span class="built_in">i</span>),path(<span class="built_in">i</span>+<span class="number">1</span>)) + result;</span><br><span class="line">    <span class="keyword">end</span>   </span><br><span class="line">    result = d(path(<span class="number">1</span>), path(n)) + result;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">path1</span> = <span class="title">gen_new_path</span><span class="params">(path0)</span></span></span><br><span class="line">    <span class="comment">% path0: 原来的路径</span></span><br><span class="line">    n = <span class="built_in">length</span>(path0);</span><br><span class="line">    <span class="comment">% 随机选择两种产生新路径的方法</span></span><br><span class="line">    p1 = <span class="number">0.33</span>;  </span><br><span class="line">    p2 = <span class="number">0.33</span>;</span><br><span class="line">    r = <span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>  r &lt; p1 <span class="comment">% 使用交换法产生新路径的概率</span></span><br><span class="line">        c1 = randi(n); </span><br><span class="line">        c2 = randi(n);</span><br><span class="line">        path1 = path0;</span><br><span class="line">        path1(c1) = path0(c2);</span><br><span class="line">        path1(c2) = path0(c1);</span><br><span class="line">    <span class="keyword">elseif</span> r &lt; p1 + p2 <span class="comment">% 使用移位法产生新路径</span></span><br><span class="line">        c1 = randi(n); </span><br><span class="line">        c2 = randi(n);</span><br><span class="line">        c3 = randi(n);</span><br><span class="line">        sort_c = <span class="built_in">sort</span>([c1 c2 c3]);  <span class="comment">% 对c1 c2 c3从小到大排序</span></span><br><span class="line">        c1 = sort_c(<span class="number">1</span>);  c2 = sort_c(<span class="number">2</span>);  c3 = sort_c(<span class="number">3</span>);</span><br><span class="line">        tem1 = path0(<span class="number">1</span>:c1<span class="number">-1</span>);</span><br><span class="line">        tem2 = path0(c1:c2);</span><br><span class="line">        tem3 = path0(c2+<span class="number">1</span>:c3);</span><br><span class="line">        tem4 = path0(c3+<span class="number">1</span>:<span class="keyword">end</span>);</span><br><span class="line">        path1 = [tem1 tem3 tem2 tem4];</span><br><span class="line">    <span class="keyword">else</span>  <span class="comment">% 使用倒置法产生新路径</span></span><br><span class="line">        c1 = randi(n);</span><br><span class="line">        c2 = randi(n);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> c1 &gt; c2</span><br><span class="line">            tem = c2;</span><br><span class="line">            c2 = c1;</span><br><span class="line">            c1 = tem;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        tem1 = path0(<span class="number">1</span>:c1<span class="number">-1</span>);</span><br><span class="line">        tem2 = path0(c1:c2);</span><br><span class="line">        tem3 = path0(c2+<span class="number">1</span>:<span class="keyword">end</span>);</span><br><span class="line">        path1 = [tem1 <span class="built_in">fliplr</span>(tem2) tem3];   <span class="comment">% 矩阵的左右对称翻转 fliplr，上下对称翻转 flipud</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">rng(<span class="string">&#x27;shuffle&#x27;</span>)  <span class="comment">% 控制随机数的生成，否则每次打开matlab得到的结果都一样</span></span><br><span class="line"><span class="comment">% 38个城市，TSP数据集网站(http://www.tsp.gatech.edu/world/djtour.html) 上公测的最优结果6656。</span></span><br><span class="line">coord = [<span class="number">11003.611100</span>,<span class="number">42102.500000</span>;<span class="number">11108.611100</span>,<span class="number">42373.888900</span>;<span class="number">11133.333300</span>,<span class="number">42885.833300</span>;<span class="number">11155.833300</span>,<span class="number">42712.500000</span>;<span class="number">11183.333300</span>,<span class="number">42933.333300</span>;<span class="number">11297.500000</span>,<span class="number">42853.333300</span>;<span class="number">11310.277800</span>,<span class="number">42929.444400</span>;<span class="number">11416.666700</span>,<span class="number">42983.333300</span>;<span class="number">11423.888900</span>,<span class="number">43000.277800</span>;<span class="number">11438.333300</span>,<span class="number">42057.222200</span>;<span class="number">11461.111100</span>,<span class="number">43252.777800</span>;<span class="number">11485.555600</span>,<span class="number">43187.222200</span>;<span class="number">11503.055600</span>,<span class="number">42855.277800</span>;<span class="number">11511.388900</span>,<span class="number">42106.388900</span>;<span class="number">11522.222200</span>,<span class="number">42841.944400</span>;<span class="number">11569.444400</span>,<span class="number">43136.666700</span>;<span class="number">11583.333300</span>,<span class="number">43150.000000</span>;<span class="number">11595.000000</span>,<span class="number">43148.055600</span>;<span class="number">11600.000000</span>,<span class="number">43150.000000</span>;<span class="number">11690.555600</span>,<span class="number">42686.666700</span>;<span class="number">11715.833300</span>,<span class="number">41836.111100</span>;<span class="number">11751.111100</span>,<span class="number">42814.444400</span>;<span class="number">11770.277800</span>,<span class="number">42651.944400</span>;<span class="number">11785.277800</span>,<span class="number">42884.444400</span>;<span class="number">11822.777800</span>,<span class="number">42673.611100</span>;<span class="number">11846.944400</span>,<span class="number">42660.555600</span>;<span class="number">11963.055600</span>,<span class="number">43290.555600</span>;<span class="number">11973.055600</span>,<span class="number">43026.111100</span>;<span class="number">12058.333300</span>,<span class="number">42195.555600</span>;<span class="number">12149.444400</span>,<span class="number">42477.500000</span>;<span class="number">12286.944400</span>,<span class="number">43355.555600</span>;<span class="number">12300.000000</span>,<span class="number">42433.333300</span>;<span class="number">12355.833300</span>,<span class="number">43156.388900</span>;<span class="number">12363.333300</span>,<span class="number">43189.166700</span>;<span class="number">12372.777800</span>,<span class="number">42711.388900</span>;<span class="number">12386.666700</span>,<span class="number">43334.722200</span>;<span class="number">12421.666700</span>,<span class="number">42895.555600</span>;<span class="number">12645.000000</span>,<span class="number">42973.333300</span>];</span><br><span class="line">n = <span class="built_in">size</span>(coord, <span class="number">1</span>);  <span class="comment">% 城市的数目</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span> </span><br><span class="line"><span class="built_in">plot</span>(coord(:,<span class="number">1</span>), coord(:,<span class="number">2</span>), <span class="string">&#x27;o&#x27;</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">zeros</span>(n);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>:n  </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">i</span>  </span><br><span class="line">        coord_i = coord(<span class="built_in">i</span>,:);   x_i = coord_i(<span class="number">1</span>);     y_i = coord_i(<span class="number">2</span>);  <span class="comment">% 城市i的横坐标为x_i，纵坐标为y_i</span></span><br><span class="line">        coord_j = coord(<span class="built_in">j</span>,:);   x_j = coord_j(<span class="number">1</span>);     y_j = coord_j(<span class="number">2</span>);  <span class="comment">% 城市j的横坐标为x_j，纵坐标为y_j</span></span><br><span class="line">        d(<span class="built_in">i</span>,<span class="built_in">j</span>) = <span class="built_in">sqrt</span>((x_i-x_j)^<span class="number">2</span> + (y_i-y_j)^<span class="number">2</span>);   <span class="comment">% 计算城市i和j的距离</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">d = d+d&#x27;; <span class="comment">% 生成距离矩阵的对称的一面</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">T0 = <span class="number">1000</span>;</span><br><span class="line">T = T0;</span><br><span class="line">maxgen = <span class="number">1000</span>;</span><br><span class="line">Lk = <span class="number">500</span>;</span><br><span class="line">alpfa = <span class="number">0.95</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%%  随机生成初始解</span></span><br><span class="line">path0 = randperm(n);  <span class="comment">% 生成一个 1-n 的随机打乱的序列作为初始的路径</span></span><br><span class="line">result0 = calculate_tsp_d(path0, d);</span><br><span class="line"></span><br><span class="line">min_result = result0;</span><br><span class="line">RESULT = <span class="built_in">zeros</span>(maxgen,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span>:maxgen </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:Lk</span><br><span class="line">        path1 = gen_new_path(path0);  <span class="comment">% 生成新的路径</span></span><br><span class="line">        result1 = calculate_tsp_d(path1,d); <span class="comment">% 计算新路径的距离</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result1 &lt; result0    </span><br><span class="line">            path0 = path1;</span><br><span class="line">            result0 = result1; </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p = <span class="built_in">exp</span>(-(result1 - result0)/T);</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">rand</span>(<span class="number">1</span>) &lt; p</span><br><span class="line">                path0 = path1;</span><br><span class="line">                result0 = result1; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result0 &lt; min_result</span><br><span class="line">            min_result = result0; </span><br><span class="line">            best_path = path0;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    RESULT(iter) = min_result;</span><br><span class="line">    T = alpfa*T;      </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的方案是：&#x27;</span>); <span class="built_in">disp</span>(mat2str(best_path))</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(min_result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">best_path = [best_path,best_path(<span class="number">1</span>)];   <span class="comment">% 生成一个封闭的图形</span></span><br><span class="line">n = n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n<span class="number">-1</span> </span><br><span class="line">    <span class="built_in">j</span> = <span class="built_in">i</span>+<span class="number">1</span>;</span><br><span class="line">    coord_i = coord(best_path(<span class="built_in">i</span>),:);   x_i = coord_i(<span class="number">1</span>);     y_i = coord_i(<span class="number">2</span>); </span><br><span class="line">    coord_j = coord(best_path(<span class="built_in">j</span>),:);   x_j = coord_j(<span class="number">1</span>);     y_j = coord_j(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">plot</span>([x_i,x_j],[y_i,y_j],<span class="string">&#x27;-b&#x27;</span>) </span><br><span class="line">    <span class="built_in">hold</span> on</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:maxgen,RESULT,<span class="string">&#x27;b-&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;最短路径&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="例3-买书问题">例3 买书问题</h3>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512191154391.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512191125701.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">way1</span> = <span class="title">gen_new_way</span><span class="params">(way0, s, b)</span></span></span><br><span class="line">    index =  randi([<span class="number">1</span>, b],<span class="number">1</span>) ;  <span class="comment">% 看哪一本书要更换书店购买</span></span><br><span class="line">    way1 = way0;</span><br><span class="line">    way1(index) = randi([<span class="number">1</span>, s],<span class="number">1</span>);  <span class="comment">% 第index本书换一个书店购买   </span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">money</span> =  <span class="title">calculate_money</span><span class="params">(way,freight,M,b)</span></span></span><br><span class="line">    index = unique(way); </span><br><span class="line">    money = sum(freight(index)); <span class="comment">% 计算买书花费的运费</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:b </span><br><span class="line">        money = money + M(way(<span class="built_in">i</span>), <span class="built_in">i</span>);  </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">rng(<span class="string">&#x27;shuffle&#x27;</span>)</span><br><span class="line">load book_data</span><br><span class="line">[s, b] = <span class="built_in">size</span>(M);  <span class="comment">% s是书店的数量，b是要购买的书的数量</span></span><br><span class="line"></span><br><span class="line">T0 = <span class="number">1000</span>;  </span><br><span class="line">T = T0;</span><br><span class="line">maxgen = <span class="number">500</span>; </span><br><span class="line">Lk = <span class="number">200</span>;</span><br><span class="line">alfa = <span class="number">0.95</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%%  随机生成一个初始解</span></span><br><span class="line">way0 = randi([<span class="number">1</span>, s],<span class="number">1</span>,b); <span class="comment">% 在1-s 这些整数中随机抽取一个1*b的向量，表示这b本书分别在哪家书店购买</span></span><br><span class="line">money0 = calculate_money(way0, freight, M, b); </span><br><span class="line"></span><br><span class="line">min_money = money0;</span><br><span class="line">MONEY = <span class="built_in">zeros</span>(maxgen,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span>:maxgen</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:Lk</span><br><span class="line">        way1 = gen_new_way(way0,s,b); </span><br><span class="line">        money1 = calculate_money(way1,freight,M,b);</span><br><span class="line">        <span class="keyword">if</span> money1 &lt; money0  </span><br><span class="line">            way0 = way1;</span><br><span class="line">            money0 = money1;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p = <span class="built_in">exp</span>(-(money1 - money0)/T);</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">rand</span>(<span class="number">1</span>) &lt; p   </span><br><span class="line">                way0 = way1;</span><br><span class="line">                money0 = money1;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> money0 &lt; min_money  </span><br><span class="line">            min_money = money0;  </span><br><span class="line">            best_way = way0;  </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    MONEY(iter) = min_money; </span><br><span class="line">    T = alfa*T; </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最佳的方案是：&#x27;</span>); <span class="built_in">disp</span>(mat2str(best_way))</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;此时最优值是：&#x27;</span>); <span class="built_in">disp</span>(min_money)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(<span class="number">1</span>:maxgen,MONEY,<span class="string">&#x27;b-&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;最小花费&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="matlab-工具箱-1">Matlab 工具箱</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192158999.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192230493.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192440424.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blogimage-20210512192614752.png" /></p>
<p>其他设置分别是设置模拟退火过程函数（Matlab 自实现中间还有部分升温过程，避免局部最优）、温度下降函数、初始温度。</p>
<p>跟大多数优化算法一样，用到随机数，每次运行可能会有差异，不一定到达全局最优解。</p>
<h1 id="遗传算法">遗传算法</h1>
<p>又称 GA 算法，使用软件：Matlab。</p>
<h2 id="概念-1">概念</h2>
<p>基于生物进化规律，即物竞天择，适者生存演变而来的一种优化算法。</p>
<p>基因：每个解的组成分量</p>
<p>个体（染色体）：待求解优化问题的一个解</p>
<p>种群：由很多个体组成的群体</p>
<p>交叉：从选择好的个体中两两配对，并按某种方式互换基因以产生下一代</p>
<p>选择：从当前的种群中选择比较好的个体，使之有机会将其基因遗传到下一代</p>
<p>变异：对种群中的一些个体有一定概率发生变异，产生新个体。</p>
<h2 id="关键步骤-2">关键步骤</h2>
<h3 id="编码">编码</h3>
<ul>
<li><p>二进制编码</p>
<p>二进制编码，长度 <span class="math inline">\(L\)</span> 为 <span class="math inline">\(\log_2{(\frac{b-a}{eps} +1)}\)</span>，<span class="math inline">\((a,b)\)</span> 是自变量范围，<span class="math inline">\(eps\)</span> 是要求的精度</p>
<p>二进制数据解码，<span class="math inline">\(x=a+(b-a)\times X / (2^L-1)\)</span>，<span class="math inline">\(X\)</span> 代表二进制数据的值</p>
<p>存在多个自变量时，编码长度为每个自变量编码长度之和</p></li>
<li><p>实值编码</p>
<p>个体编码长度即为决策变量个数，需要限制基因值的范围。</p>
<p>比较适合表示范围较大数，精度要求高、较大空间的遗传搜索。</p></li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">real</span> = <span class="title">decode</span><span class="params">(pop, lb, ub)</span></span></span><br><span class="line">    col = <span class="built_in">size</span>(pop, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = col:<span class="number">-1</span>:<span class="number">1</span></span><br><span class="line">        temp(<span class="built_in">j</span>) = <span class="number">2</span>^(<span class="built_in">j</span><span class="number">-1</span>) * pop(<span class="built_in">j</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    temp = sum(temp);</span><br><span class="line">    <span class="built_in">real</span> = lb + (ub - lb) * temp / (<span class="number">2</span>^col - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="适应度函数">适应度函数</h3>
<p>即对于最优化问题，求全局最大值或最小值，会 <strong>直接影响</strong> 到遗传算法的收敛速度及能否找到最优解：</p>
<ul>
<li>直接变换：</li>
</ul>
<p>对于求最大值： <span class="math display">\[
F(x)=\left\{
\begin{array}{rcl}
f(x)+Cmin, &amp; { f(x) + Cmin &gt; 0}\\
0,  &amp; {f(x) + Cmin \leq 0}\\
\end{array} \right.
\]</span> 对于求最小值： <span class="math display">\[
F(x)=\left\{
\begin{array}{rcl}
-f(x)+Cmax, &amp; { f(x) &lt; Cmax}\\
0,  &amp; {f(x) \geq Cmax}\\
\end{array} \right.
\]</span></p>
<ul>
<li>线性变换1：</li>
</ul>
<p><span class="math inline">\(F(x)=af(x)+b\)</span></p>
<p><span class="math inline">\(f_{min},f_{max}\)</span> 为当前种群中的最小值或最大值，<span class="math inline">\(\xi\)</span> 为一个较小的数，可使种群中最差的个体仍然有繁殖的机会。</p>
<p>对于求最大值：<span class="math inline">\(a=1,b=-f_{min}+\xi\)</span>，对于求最小值：<span class="math inline">\(a=-1,b=f_{max}+\xi\)</span></p>
<ul>
<li>线性变换2：</li>
</ul>
<p><span class="math inline">\(C\)</span> 为常数，常取 2 或 1.5</p>
<p>若 <span class="math inline">\(f_{min} &gt; \frac{C f_{avg}-f_{max}}{C-1}\)</span>，<span class="math inline">\(a = \frac{C-1}{f_{max}-f_{avg}}f_{avg}, b = \frac{f_{max}-Cf_{avg}}{f_{max}-f_{avg}}f_{avg}\)</span></p>
<p>否则，<span class="math inline">\(a = \frac{f_{avg}}{f_{avg}-f_{min}}, b = \frac{f_{avg}f_{min}}{f_{avg}-f_{min}}\)</span></p>
<ul>
<li>线性动态变换：</li>
</ul>
<p>对于求最大值：<span class="math inline">\(a=1,b=-f_{min}+\xi^k\)</span>，<span class="math inline">\(\xi^k=\xi^{k-1} \times r, r \in[0.9,0.99]\)</span>，随着时间变化 <span class="math inline">\(\xi\)</span> 减小。</p>
<ul>
<li>指数变换：</li>
</ul>
<p><span class="math inline">\(F(x)=e^{-\alpha f(x)}\)</span></p>
<p>保证了适应度函数非负性，若原问题求最大值，需要将目标函数乘上 -1，<span class="math inline">\(\alpha\)</span> 取值越大，变换后适应度差距越大。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fval</span> = <span class="title">objfun</span><span class="params">(x)</span></span></span><br><span class="line">    fval = <span class="number">11</span> * <span class="built_in">sin</span>(<span class="number">6</span> * x) + <span class="number">7</span> * <span class="built_in">cos</span>(<span class="number">5</span> * x);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fitvalue</span> = <span class="title">fitnessfun</span><span class="params">(x)</span></span></span><br><span class="line">    <span class="keyword">global</span> M ftype</span><br><span class="line">    fval = objfun(x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> ftype</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span> <span class="comment">% 直接转换</span></span><br><span class="line">            Cmin = <span class="number">0.01</span>;</span><br><span class="line">            r = <span class="built_in">size</span>(x, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:r</span><br><span class="line">               fval = objfun(x(<span class="built_in">i</span>,:));</span><br><span class="line">               <span class="keyword">if</span> fval + Cmin &gt; <span class="number">0</span></span><br><span class="line">                    fitvalue(<span class="built_in">i</span>) = fval + Cmin;</span><br><span class="line">               <span class="keyword">else</span></span><br><span class="line">                    fitvalue(<span class="built_in">i</span>) = <span class="number">0</span>;</span><br><span class="line">               <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span> <span class="comment">% 线性变换1</span></span><br><span class="line">            kesai = <span class="number">0.1</span>;</span><br><span class="line">            fmin = <span class="built_in">min</span>(fval);</span><br><span class="line">            fitvalue = fval - fmin + kesai;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span> <span class="comment">% 线性变换2</span></span><br><span class="line">            C = <span class="number">1.5</span>;</span><br><span class="line">            fmin = <span class="built_in">min</span>(fval);</span><br><span class="line">            fmax = <span class="built_in">max</span>(fval);</span><br><span class="line">            favg = sum(fval) / <span class="built_in">size</span>(x, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> fmin &lt; (C * favg - fmax) / (C - <span class="number">1</span>)</span><br><span class="line">                a = (C - <span class="number">1</span>) * favg / (fmax - favg);</span><br><span class="line">                b = (fmax - C * favg) * favg / (fmax - favg);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                a = favg / (favg - fmin);</span><br><span class="line">                b = favg * fmin / (favg - fmin);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            fitvalue = a * fval + b;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span> <span class="comment">% 线性动态变换</span></span><br><span class="line">            c = <span class="number">0.9</span> + (<span class="number">0.099</span>) * <span class="built_in">rand</span>;</span><br><span class="line">            M = M * c;</span><br><span class="line">            fmin = <span class="built_in">min</span>(fval);</span><br><span class="line">            fitvalue = fval - fmin + M;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span> <span class="comment">% 指数变换</span></span><br><span class="line">            alpha = <span class="number">0.5</span>;</span><br><span class="line">            fitvalue = <span class="built_in">exp</span>(alpha * fval);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="选择">选择</h3>
<ul>
<li><p>轮盘赌选择法</p>
<ol type="1">
<li>计算各个体适应度 <span class="math inline">\(f_i\)</span></li>
<li>每个个体被选中的概率 <span class="math inline">\(p_i=\frac{f_i}{\sum{f_i}}\)</span>，以及累积概率 <span class="math inline">\(P_i\)</span></li>
<li>随机产生 [0 1] 之间的一个随机数 <span class="math inline">\(r\)</span></li>
<li>依次比较累积概率与 <span class="math inline">\(r\)</span> 的值，选中第一个大于 <span class="math inline">\(r\)</span> 的值</li>
</ol></li>
<li><p>排序选择</p>
<ol type="1">
<li>计算各个体适应度 <span class="math inline">\(f_i\)</span></li>
<li>按照适应度从大到小排序</li>
<li>定义最好的个体选择概率为 <span class="math inline">\(q\)</span></li>
<li>第 <span class="math inline">\(i\)</span> 个个体被选中的概率为 <span class="math inline">\(p_i = \frac{q(1-q)^{i-1}}{1-(1-q)^n}\)</span>，<span class="math inline">\(n\)</span> 为种群大小</li>
</ol>
<p>该算法早期时，个体适应度差别较大，经过几代后特优个体数目会越来越多，冲淡群体多样性。</p></li>
<li><p>最优保存（精英保存）</p>
<p>由于遗传操作的随机性，当前种群中适应度最好的个体也可能被破坏掉，降低群体平均适应度，影响遗传算法的运行效率和收敛速度，所以将适应度最好的个体保留到下一代群体中。</p>
<p>但是，这样也会让某个局部最优个体不易被淘汰掉反而快速扩展，从而使得算法的全局搜索能力不强，需要配合其他选择操作方法使用。</p>
<ol type="1">
<li>计算各个体适应度 <span class="math inline">\(f_i\)</span></li>
<li>找出最优和最差个体</li>
<li>比较最优个体和历史最优个体，更新历史最优个体</li>
<li>用历史最优个体替换本次最差个体</li>
</ol>
<p>除了保留单个最优个体，也可以保留多个最优个体，这种方法称为 <em>稳态复制</em>。</p></li>
<li><p>锦标赛选择</p>
<p>每次先从种群中取出一定数量的个体，然后再选择其中最好的一个进入子代种群，重复该步骤直到达到原来的种群规模。</p>
<ol type="1">
<li>确定每次选择的个体数量 <span class="math inline">\(sn\)</span>, 可以是固定值也可以是百分比，一般取 2</li>
<li>从种群中等概率选取 <span class="math inline">\(sn\)</span> 个个体，选取适应度最好的一个个体</li>
<li>重复该步骤，直到新个体构成一个新的种群</li>
</ol>
<p>选择的力度取决于 <span class="math inline">\(sn\)</span> 大小, <span class="math inline">\(sn\)</span> 越大，选出优胜者的适应度一般越大。</p></li>
<li><p>确定式采样选择</p>
<p>无回放余数随机选择，其基本思想是按照一种 <strong>确定</strong> 的方式来进行选择，可保证适应度较大的一些个体能够被保留在下一代群体中。</p>
<ol type="1">
<li>确定种群中每个个体在下一代中的生存期望数目 <span class="math inline">\(N_i=n\frac{f_i}{\sum{f_i}}\)</span></li>
<li>先用 <span class="math inline">\(N_i\)</span> 的整数部分确定各个对应个体在下一代群体中的生成数目 <span class="math inline">\(\sum{[N_i]}\)</span></li>
<li>再根据 <span class="math inline">\(N_i\)</span> 的小数部分对个体进行降序排序，顺序取前 <span class="math inline">\(n - \sum{[N_i]}\)</span> 个个体加入到下一代群体中。</li>
</ol></li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[dad, mom]</span> = <span class="title">selection</span><span class="params">(pop, fitvalue, type)</span></span></span><br><span class="line">    <span class="keyword">global</span> q sn;</span><br><span class="line">    row = <span class="built_in">size</span>(pop, <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> <span class="built_in">type</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span> <span class="comment">% 普通轮盘赌</span></span><br><span class="line">            <span class="comment">% 计算累加概率</span></span><br><span class="line">            PP = cumsum(fitvalue ./ sum(fitvalue));</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                r = <span class="built_in">rand</span>;</span><br><span class="line">                <span class="comment">% 父代由轮盘赌选取，母代随机选取。如果没有母代，父代第 1 个和第 2 个进行交叉...</span></span><br><span class="line">                <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:row</span><br><span class="line">                    <span class="keyword">if</span> r &lt;= PP(<span class="built_in">j</span>)</span><br><span class="line">                        dad(<span class="built_in">i</span>, :) = pop(<span class="built_in">j</span>, :);</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                mom(<span class="built_in">i</span>, :) = pop(randi([<span class="number">1</span> row]), :);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span> <span class="comment">% 排序选择</span></span><br><span class="line">            [~, Sindex] = <span class="built_in">sort</span>(fitvalue, <span class="string">&#x27;descend&#x27;</span>);</span><br><span class="line">            pop = pop(Sindex, :); <span class="comment">% 重新排序种群</span></span><br><span class="line">            P = q * (<span class="number">1</span> - q) .^ ((<span class="number">1</span>:row) - <span class="number">1</span>) / (<span class="number">1</span> - (<span class="number">1</span>-q)^row);</span><br><span class="line">            PP = cumsum(P);</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                r = <span class="built_in">rand</span>;</span><br><span class="line">                <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:row</span><br><span class="line">                    <span class="keyword">if</span> r &lt;= PP(<span class="built_in">j</span>)</span><br><span class="line">                        dad(<span class="built_in">i</span>, :) = pop(<span class="built_in">j</span>, :);</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                mom(<span class="built_in">i</span>, :) = pop(randi([<span class="number">1</span> row]), :);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span> <span class="comment">% 锦标赛选择</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                r = randi([<span class="number">1</span> row], sn, <span class="number">1</span>);</span><br><span class="line">                [~, bestindex] = <span class="built_in">max</span>(fitvalue(r));</span><br><span class="line">                dad(<span class="built_in">i</span>, :) = pop(r(bestindex), :);</span><br><span class="line">                mom(<span class="built_in">i</span>, :) = pop(randi([<span class="number">1</span> row]), :);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span> <span class="comment">% 确定式采样选择</span></span><br><span class="line">            Ni = row * fitvalue / (sum(fitvalue));</span><br><span class="line">            Int = <span class="built_in">floor</span>(Ni);</span><br><span class="line">            [introw, ~, Nzero] = <span class="built_in">find</span>(Int); <span class="comment">% 找到非 0 个体的位置及值</span></span><br><span class="line">            Newindex = cumsum([<span class="number">0</span> ;Nzero]);</span><br><span class="line">            <span class="comment">% 整数选取</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(introw)</span><br><span class="line">                <span class="keyword">for</span> <span class="built_in">j</span> = Newindex(<span class="built_in">i</span>)+<span class="number">1</span>:Newindex(<span class="built_in">i</span>+<span class="number">1</span>)</span><br><span class="line">                    dad(<span class="built_in">j</span>,:) = pop(introw(<span class="built_in">i</span>),:);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">% 小数选取</span></span><br><span class="line">            Float = <span class="built_in">mod</span>(Ni, <span class="number">1</span>);</span><br><span class="line">            [number, index] = <span class="built_in">sort</span>(Float, <span class="string">&#x27;descend&#x27;</span>);</span><br><span class="line">            Left = row - sum(Nzero);</span><br><span class="line">            <span class="keyword">if</span> Left &gt; <span class="number">0</span></span><br><span class="line">                dad(row:<span class="number">-1</span>:row-Left+<span class="number">1</span>, :) = pop(index(<span class="number">1</span>:Left), :);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            </span><br><span class="line">            mom(<span class="number">1</span>:row, :) = pop(randi([<span class="number">1</span> row], row, <span class="number">1</span>), :);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">eselection</span><span class="params">(pop, bestfitvalue, bestx)</span></span></span><br><span class="line">    <span class="keyword">global</span> n varnum lb ub L</span><br><span class="line">    spoint = cumsum([<span class="number">0</span> L]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(pop(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">    [Gbestfitvalue, Gbestindex] = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">    [Gbadfitvalue, Gbadindex] = <span class="built_in">min</span>(fitvalue);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> Gbestfitvalue &lt; bestfitvalue</span><br><span class="line">        pop(Gbadindex(<span class="number">1</span>), :) = bestx;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    newpop = pop;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="交叉">交叉</h3>
<p>交叉：</p>
<ul>
<li>二进制编码</li>
</ul>
<p>对于二进制编码来说，存在单点、两点、多点和均匀交叉。</p>
<p>单点交叉，对于二进制编码一个交叉点，父代和母代相互交换该交叉点之后的编码。</p>
<p>两点交叉，对于二进制编码两个交叉点，父代和母代相互交换这两个交叉点之间的编码。</p>
<ul>
<li>实值编码</li>
</ul>
<p>离散交叉：父代、母代互换基因值。</p>
<p>算数交叉：<span class="math inline">\(X&#39; = rX + (1 - r)Y\)</span>，<span class="math inline">\(Y&#39; = (1-r)X+rY\)</span> ，<span class="math inline">\(r\)</span> 为随机数。</p>
<p>平均交叉：算数交叉的特例，<span class="math inline">\(r\)</span> 为 0.5。</p>
<p>启发式交叉：往适应度高的父代交叉。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">crossover</span><span class="params">(dad, mom, pc)</span></span></span><br><span class="line">    [row, col] = <span class="built_in">size</span>(dad);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pc</span><br><span class="line">            cpoint = randi([<span class="number">1</span> col - <span class="number">1</span>]);</span><br><span class="line">            newpop(<span class="built_in">i</span>, :) = [dad(<span class="built_in">i</span>, <span class="number">1</span>:cpoint) mom(<span class="built_in">i</span>, cpoint+<span class="number">1</span>:<span class="keyword">end</span>)];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">rcrossover</span><span class="params">(dad, pc)</span></span></span><br><span class="line">    [row, col] = <span class="built_in">size</span>(dad);</span><br><span class="line">    <span class="comment">% 实值交叉</span></span><br><span class="line">    <span class="keyword">global</span> ctype</span><br><span class="line">    <span class="keyword">switch</span> ctype</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span> <span class="comment">% 离散交叉</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span>:row<span class="number">-1</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pc</span><br><span class="line">                    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:col</span><br><span class="line">                        <span class="keyword">if</span> randi([<span class="number">0</span> <span class="number">1</span>]) == <span class="number">1</span></span><br><span class="line">                            newpop(<span class="built_in">i</span>, <span class="built_in">j</span>) = dad(<span class="built_in">i</span>, <span class="built_in">j</span>);</span><br><span class="line">                            newpop(<span class="built_in">i</span>+<span class="number">1</span>, <span class="built_in">j</span>) = dad(<span class="built_in">i</span>+<span class="number">1</span>, <span class="built_in">j</span>);</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            newpop(<span class="built_in">i</span>, <span class="built_in">j</span>) = dad(<span class="built_in">i</span>+<span class="number">1</span>, <span class="built_in">j</span>);</span><br><span class="line">                            newpop(<span class="built_in">i</span>+<span class="number">1</span>, <span class="built_in">j</span>) = dad(<span class="built_in">i</span>, <span class="built_in">j</span>);</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span> <span class="comment">% 算数交叉</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span>:row<span class="number">-1</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pc</span><br><span class="line">                    cpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                    r = <span class="built_in">rand</span>;</span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = r * dad(<span class="built_in">i</span>, cpoint) * (<span class="number">1</span> - r) * dad(<span class="built_in">i</span> + <span class="number">1</span>, cpoint);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = r * dad(<span class="built_in">i</span> + <span class="number">1</span>, cpoint) * (<span class="number">1</span> - r) * dad(<span class="built_in">i</span>, cpoint);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span>:row<span class="number">-1</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pc</span><br><span class="line">                    cpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                    r = <span class="number">0.5</span>;</span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = r * dad(<span class="built_in">i</span>, cpoint) * (<span class="number">1</span> - r) * dad(<span class="built_in">i</span> + <span class="number">1</span>, cpoint);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = r * dad(<span class="built_in">i</span> + <span class="number">1</span>, cpoint) * (<span class="number">1</span> - r) * dad(<span class="built_in">i</span>, cpoint);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">2</span>:row<span class="number">-1</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pc</span><br><span class="line">                    f1 = fitnessfun(dad(<span class="built_in">i</span>, :));</span><br><span class="line">                    f2 = fitnessfun(dad(<span class="built_in">i</span>+<span class="number">1</span>, :));</span><br><span class="line">                    <span class="keyword">if</span> f1 &gt; f2</span><br><span class="line">                        newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">                        newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>,:) + <span class="number">1.2</span> * (dad(<span class="built_in">i</span>,:) - dad(<span class="built_in">i</span>+<span class="number">1</span>,:));</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :) + <span class="number">1.2</span> * (dad(<span class="built_in">i</span>+<span class="number">1</span>,:) - dad(<span class="built_in">i</span>,:));</span><br><span class="line">                        newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>, :);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = dad(<span class="built_in">i</span>, :);</span><br><span class="line">                    newpop(<span class="built_in">i</span>+<span class="number">1</span>, :) = dad(<span class="built_in">i</span>+<span class="number">1</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="变异">变异</h3>
<p>二进制编码：</p>
<ul>
<li><p>简单变异</p>
<p>对于二进制编码，先选取一个从 [1 L] 上的随机点位，生成随机数小于规定变异概率，就发生变异，0 1 互变。</p></li>
<li><p>大变异</p>
<p>简单变异，会使得算法过早收敛于一个非全局最优解。当某代所有个体集中到一起时，我们以一个远大于通常变异概率的概率执行一次变异操作，具体操作过程为：</p>
<p>当某一代的最大适应度和平均适应度满足 <span class="math inline">\(\alpha F_{max} &lt; F_{avg}\)</span> 关系时，执行大变异操作。<span class="math inline">\(0.5 \lt \alpha \lt 1\)</span>， 称为密集因子。</p>
<p>为了避免最优个体被大变异破坏，最优个体不参与大变异操作。</p></li>
</ul>
<p>实值编码：</p>
<ul>
<li><p>边界变异 <span class="math display">\[
x&#39;=\left\{
\begin{array}{rcl}
x_{max}, &amp; {rand==1}\\
x_{min}, &amp; {rand==0}\\
\end{array} \right.
\]</span></p></li>
<li><p>非均匀变异，<span class="math inline">\(t\)</span> 代表当前当前迭代次数，<span class="math inline">\(T\)</span> 为总迭代次数，<span class="math inline">\(b\)</span> 为 2-5 的一个常量 <span class="math display">\[
x&#39;=\left\{
\begin{array}{rcl}
x+(x_{max}-x)(1-r^{b(1-t/T)}), &amp; {rand==1}\\
x-(x-x_{min})(1-r^{b(1-t/T)}), &amp; {rand==0}\\
\end{array} \right.
\]</span></p></li>
<li><p>均匀变异，在基因值范围内生成随机数</p></li>
<li><p>高斯变异，由符合正态分布的随机数代替基因值，均匀分布可用中心极限定理、Box-Muller 方法生成标准正态分布。</p></li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">mutation</span><span class="params">(pop, pm)</span></span></span><br><span class="line">    [row, col] = <span class="built_in">size</span>(pop);</span><br><span class="line">    newpop = pop;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">        r = <span class="built_in">rand</span></span><br><span class="line">        <span class="comment">% 单个变异点位</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pm</span><br><span class="line">            mpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">            newpop(<span class="built_in">i</span>, mpoint) = ~pop(<span class="built_in">i</span>, mpoint);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">Lmutation</span><span class="params">(pop, Lpm)</span></span></span><br><span class="line">    <span class="keyword">global</span> alpha T n varnum lb ub pm</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(pop(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">    [Fmax, Bestindex] = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">    Favg = sum(fitvalue) / n;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> alpha * Fmax &lt; Fmax &amp;&amp; iter &lt; T</span><br><span class="line">        [row, col] = <span class="built_in">size</span>(pop);</span><br><span class="line">        newpop = pop;</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">            r = <span class="built_in">rand</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">rand</span> &lt; Lpm &amp;&amp; <span class="built_in">i</span> ~= Bestindex</span><br><span class="line">                mpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                newpop(<span class="built_in">i</span>, mpoint) = ~pop(<span class="built_in">i</span>, mpoint);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        newpop = mutation(newpop, pm);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">rmutation</span><span class="params">(pop, pm)</span></span></span><br><span class="line">    <span class="keyword">global</span> rmtype lb ub t T</span><br><span class="line">    newpop = pop;</span><br><span class="line">    <span class="keyword">switch</span> rmtype</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span> <span class="comment">% 均匀变异</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                mpoint = randi([<span class="number">1</span> col])</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pm</span><br><span class="line">                    pop(<span class="built_in">i</span>, mpoint) = lb(mpoint) + (ub(mpoint) - lb(mpoint)) * <span class="built_in">rand</span>;</span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span> <span class="comment">% 边界变异</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                mpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pm</span><br><span class="line">                    <span class="keyword">if</span> randi([<span class="number">0</span> <span class="number">1</span>]) == <span class="number">0</span></span><br><span class="line">                        pop(<span class="built_in">i</span>, mpoint) = lb(mpoint);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">if</span> randi([<span class="number">0</span> <span class="number">1</span>]) == <span class="number">1</span></span><br><span class="line">                        pop(<span class="built_in">i</span>, mpoint) = ub(mpoint);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span> <span class="comment">% 非均匀变异</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                mpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                r = <span class="built_in">rand</span>;</span><br><span class="line">                a = (<span class="number">1</span> - t/T);</span><br><span class="line">                b = <span class="number">5</span>; <span class="comment">% 2 - 5</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pm</span><br><span class="line">                    <span class="keyword">if</span> randi([<span class="number">0</span> <span class="number">1</span>]) == <span class="number">0</span></span><br><span class="line">                        pop(<span class="built_in">i</span>, mpoint) = pop(<span class="built_in">i</span>, mpoint) + (ub(mpoint) - pop(<span class="built_in">i</span>, mpoint)) * (<span class="number">1</span> - r^(a * b));</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">if</span> randi([<span class="number">0</span> <span class="number">1</span>]) == <span class="number">1</span></span><br><span class="line">                        pop(<span class="built_in">i</span>, mpoint) = pop(<span class="built_in">i</span>, mpoint) + (pop(<span class="built_in">i</span>, mpoint) - lb(mpoint)) * (<span class="number">1</span> - r^(a * b));</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span> <span class="comment">% 高斯变异</span></span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:row</span><br><span class="line">                mpoint = randi([<span class="number">1</span> col]);</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">rand</span> &lt; pm</span><br><span class="line">                    mvalue = <span class="built_in">inf</span>;</span><br><span class="line">                    <span class="keyword">while</span> mvalue &lt; lb(mpoint) || mvalue &gt; ub(mpoint)</span><br><span class="line">                        mvalue = (lb(mpoint) + ub(mpoint)) / <span class="number">2</span> + (ub(mpoint) - lb(mpoint)) / <span class="number">6</span> * <span class="built_in">randn</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    pop(<span class="built_in">i</span>, mpoint) = mvalue;</span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    newpop(<span class="built_in">i</span>, :) = pop(<span class="built_in">i</span>, :);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="自适应">自适应</h3>
<p>引入自适应调整函数，使交叉概率和变异概率随个体适应度大小和群体的分散程度自动调整。</p>
<p>当群体有陷入局部最优解的趋势的时候，就相应地提高 <span class="math inline">\(P_c\)</span> <span class="math inline">\(P_m\)</span> 交叉概率和变异概率，当群体发散时就降低。</p>
<p>当个体的适应度接近当前种群的最大适应度时，就用较低的 <span class="math inline">\(P_c\)</span> <span class="math inline">\(P_m\)</span> ；当个体的适应度低于当前种群的平均适应度时，就用较大的 <span class="math inline">\(P_c\)</span> <span class="math inline">\(P_m\)</span>。<span class="math inline">\(f&#39;\)</span> 是两个待交叉个体中适应度较大的一个，<span class="math inline">\(f\)</span> 是待变异个体的适应度值。 <span class="math display">\[
P_c=\left\{
\begin{array}{rcl}
k_1\frac{f_{max}-f&#39;}{f_{max}-f_{avg}}, &amp; { f&#39; \ge f_{avg}}\\
k_2,  &amp; {f&#39; \lt f_{avg}}\\
\end{array} \right.
\]</span></p>
<p><span class="math display">\[
P_m=\left\{
\begin{array}{rcl}
k_1\frac{f_{max}-f}{f_{max}-f_{avg}}, &amp; { f \ge f_{avg}}\\
k_2,  &amp; {f \lt f_{avg}}\\
\end{array} \right.
\]</span></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">acrossover</span><span class="params">(dad, mom, pc1, pc2)</span></span></span><br><span class="line">    <span class="keyword">global</span> varnum L lb ub n</span><br><span class="line">    [row, col] = <span class="built_in">size</span>(dad);</span><br><span class="line">    spoint = cumsum([<span class="number">0</span> L]);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(dad(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">    Maxfitvalue = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">    Meanfitvalue = sum(fitvalue) / n;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            Mreal = decode(mom(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        Mfit = fitnessfun(Mreal);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">max</span>(Mfit, fitvalue(<span class="built_in">i</span>)) &gt;= Meanfitvalue</span><br><span class="line">            pc = pc1 * (Maxfitvalue - <span class="built_in">max</span>(Mfit, fitvalue(<span class="built_in">i</span>))) / (Maxfitvalue - Meanfitvalue);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pc = pc2;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    newpop = crossover(dad, mom, pc);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newpop</span> = <span class="title">amutation</span><span class="params">(pop, pm1, pm2)</span></span></span><br><span class="line">    <span class="keyword">global</span> varnum L lb ub n</span><br><span class="line">    [row, col] = <span class="built_in">size</span>(pop);</span><br><span class="line">    spoint = cumsum([<span class="number">0</span> L]);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(pop(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">    Maxfitvalue = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">    Meanfitvalue = sum(fitvalue) / n;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        f = fitvalue(<span class="built_in">i</span>);</span><br><span class="line">        <span class="keyword">if</span> f &gt;= Meanfitvalue</span><br><span class="line">            pm = pm1 * (Maxfitvalue - f) / (Maxfitvalue - Meanfitvalue);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pm = pm2;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    newpop = mutation(pop, pm);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="运行">运行</h3>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210511185624354.png" /></p>
<p>遗传算法的运行具有随机性，有时需要多运行几次。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">f = @(x) <span class="number">11</span> * <span class="built_in">sin</span>(<span class="number">6</span> * x) + <span class="number">7</span> * <span class="built_in">cos</span>(<span class="number">5</span> * x);</span><br><span class="line">fplot(f, [-<span class="built_in">pi</span> <span class="built_in">pi</span>])</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">h = <span class="built_in">plot</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> M varnum n lb ub L q sn alpha T pm ftype</span><br><span class="line">ftype = <span class="number">5</span>;</span><br><span class="line">M = <span class="number">2</span>;</span><br><span class="line">varnum = <span class="number">1</span>;</span><br><span class="line">n = <span class="number">200</span>;</span><br><span class="line">lb = -<span class="built_in">pi</span>;</span><br><span class="line">ub = <span class="built_in">pi</span>;</span><br><span class="line">sn = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">eps</span> = <span class="number">1e-2</span>;</span><br><span class="line">pc = <span class="number">0.7</span>; <span class="comment">% 交叉概率</span></span><br><span class="line">pc1 = <span class="number">0.5</span>;</span><br><span class="line">pc2 = <span class="number">0.9</span>;</span><br><span class="line">pm1 = <span class="number">0.01</span>;</span><br><span class="line">pm2 = <span class="number">0.05</span>;</span><br><span class="line">alpha = <span class="number">0.5</span>;</span><br><span class="line">T = <span class="number">500</span>; <span class="comment">% 大变异运行阈值</span></span><br><span class="line">pm = <span class="number">0.005</span>; <span class="comment">% 变异概率</span></span><br><span class="line">Lpm = <span class="number">0.05</span>; <span class="comment">% 大变异概率</span></span><br><span class="line">maxgen = <span class="number">200</span>; <span class="comment">% 迭代次数</span></span><br><span class="line">q = <span class="number">0.5</span>; <span class="comment">% 排序选择参数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:varnum</span><br><span class="line">    L(<span class="built_in">i</span>) = <span class="built_in">ceil</span>(<span class="built_in">log2</span>((ub(<span class="built_in">i</span>) - lb(<span class="built_in">i</span>)) / <span class="built_in">eps</span> + <span class="number">1</span>)); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">LS = sum(L); <span class="comment">% 总编码长度</span></span><br><span class="line">spoint = cumsum([<span class="number">0</span> L]); <span class="comment">% 对于总编码区间长度分割</span></span><br><span class="line">pop = randi([<span class="number">0</span> <span class="number">1</span>], n, LS); <span class="comment">% 生成随机种群</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> iter = <span class="number">1</span>:maxgen</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">            startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">            endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(pop(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">    [bestfitvalue, bestindex] = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">    bestx = pop(bestindex, :);</span><br><span class="line">    </span><br><span class="line">    fval = objfun(<span class="built_in">real</span>);</span><br><span class="line">    h.XData = <span class="built_in">real</span>;</span><br><span class="line">    h.YData = fval;</span><br><span class="line">    pause(<span class="number">0.01</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%% 选择</span></span><br><span class="line">    [dad, mom] = selection(pop, fitvalue, <span class="number">3</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">%% 交叉</span></span><br><span class="line">    <span class="comment">% newpop = crossover(dad, mom, pc); </span></span><br><span class="line">    newpop = acrossover(dad, mom, pc1, pc2); <span class="comment">% 自适应交叉</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">%% 变异</span></span><br><span class="line">    <span class="comment">% newpop = Lmutation(newpop, Lpm); 大变异</span></span><br><span class="line">    newpop = amutation(newpop, pm1, pm2); <span class="comment">% 自适应变异</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">%% 精英保存</span></span><br><span class="line">    newpop = eselection(newpop, bestfitvalue, bestx);</span><br><span class="line">    </span><br><span class="line">    pop = newpop;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:varnum</span><br><span class="line">        startpoint = spoint(<span class="built_in">j</span>) + <span class="number">1</span>;</span><br><span class="line">        endpoint = spoint(<span class="built_in">j</span> + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">real</span>(<span class="built_in">i</span>, <span class="built_in">j</span>) = decode(pop(<span class="built_in">i</span>, startpoint:endpoint), lb(<span class="built_in">j</span>), ub(<span class="built_in">j</span>));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">fitvalue = fitnessfun(<span class="built_in">real</span>);</span><br><span class="line">[bestfitness, bestindex] = <span class="built_in">max</span>(fitvalue);</span><br><span class="line">bestindividual = <span class="built_in">real</span>(bestindex, :)</span><br><span class="line">fval = objfun(bestindividual)</span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(bestindividual, fval, <span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="matlab-工具箱-2">Matlab 工具箱</h2>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426210952593-927305408.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426211028991-1719003432.png" /></p>
<p><img src="https://hauk-blog.oss-cn-hangzhou.aliyuncs.com/blog1076860-20190426211101818-1132986484.png" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[sol, fitnessVal]</span> = <span class="title">fitness</span><span class="params">(sol, options)</span></span></span><br><span class="line">    x = sol(<span class="number">1</span>);</span><br><span class="line">    fitnessVal = x + <span class="number">10</span>*<span class="built_in">sin</span>(<span class="number">5</span>*x)+<span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">4</span>*x);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">f = @(x) x + <span class="number">10</span>*<span class="built_in">sin</span>(<span class="number">5</span>*x)+<span class="number">7</span>*<span class="built_in">cos</span>(<span class="number">4</span>*x);</span><br><span class="line"></span><br><span class="line">fplot(f, [<span class="number">0</span> <span class="number">9</span>])</span><br><span class="line">title(<span class="string">&#x27;y = x + 10*sin(5*x) + 7*cos(4*x)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">initPop = initializega(<span class="number">50</span>, [<span class="number">0</span> <span class="number">9</span>], <span class="string">&#x27;fitness&#x27;</span>);</span><br><span class="line"></span><br><span class="line">[x endPop bpop trace] = ga([<span class="number">0</span> <span class="number">9</span>],<span class="string">&#x27;fitness&#x27;</span>,[],initPop,[<span class="number">1e-6</span> <span class="number">1</span> <span class="number">1</span>],<span class="string">&#x27;maxGenTerm&#x27;</span>,<span class="number">25</span>,...</span><br><span class="line">                           <span class="string">&#x27;normGeomSelect&#x27;</span>,<span class="number">0.08</span>,<span class="string">&#x27;arithXover&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;nonUnifMutation&#x27;</span>,[<span class="number">2</span> <span class="number">25</span> <span class="number">3</span>]);</span><br><span class="line">x</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span> (endPop(:,<span class="number">1</span>),endPop(:,<span class="number">2</span>),<span class="string">&#x27;ro&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">%% 绘制迭代进化曲线</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(trace(:,<span class="number">1</span>),trace(:,<span class="number">3</span>),<span class="string">&#x27;b:&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(trace(:,<span class="number">1</span>),trace(:,<span class="number">2</span>),<span class="string">&#x27;r-&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;Generation&#x27;</span>); ylabel(<span class="string">&#x27;Fittness&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;Mean Fitness&#x27;</span>, <span class="string">&#x27;Best Fitness&#x27;</span>)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" rel="tag"># 数学建模</a>
              <a href="/blog/tags/%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98/" rel="tag"># 优化问题</a>
              <a href="/blog/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E7%AE%97%E6%B3%95/" rel="tag"># 启发式算法</a>
              <a href="/blog/tags/%E6%95%B0%E5%AD%A6%E8%A7%84%E5%88%92/" rel="tag"># 数学规划</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E5%9B%BE%E8%AE%BA/" rel="prev" title="数学建模-图论">
                  <i class="fa fa-chevron-left"></i> 数学建模-图论
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/2021/05/14/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1-%E7%9B%B8%E5%85%B3%E5%88%86%E6%9E%90/" rel="next" title="数学建模-相关分析">
                  数学建模-相关分析 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hauk</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



</body>
</html>
